(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    576522,      13663]
NotebookOptionsPosition[    571532,      13523]
NotebookOutlinePosition[    572114,      13545]
CellTagsIndexPosition[    572071,      13542]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Start", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6587004743630743`*^9, 3.6587004752870746`*^9}}],

Cell[BoxData[
 RowBox[{"Start", "[", "]"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{
  3.6560434584212937`*^9, 3.656043861334294*^9, 3.656044478985294*^9, 
   3.656045565169294*^9, 3.656046197114052*^9, 3.6560464489752355`*^9, {
   3.656047075377287*^9, 3.6560470759042873`*^9}, 3.656047362527287*^9, {
   3.6561055281681643`*^9, 3.6561055293020506`*^9}, {3.6561066235314827`*^9, 
   3.6561066240044827`*^9}, 3.656108326781481*^9, 3.656111395728322*^9, {
   3.6561143742262726`*^9, 3.6561143747002726`*^9}, 3.656114424511273*^9, 
   3.6561144575272727`*^9, {3.656114724190273*^9, 3.656114724669273*^9}, {
   3.656119511800668*^9, 3.656119512270668*^9}, {3.6561200278476677`*^9, 
   3.656120028336668*^9}, 3.6561214486926646`*^9, {3.6561215896296644`*^9, 
   3.6561215901156645`*^9}, {3.656121860189665*^9, 3.656121860670665*^9}, 
   3.6561222881956644`*^9, {3.6561223228686647`*^9, 3.6561223233496647`*^9}, {
   3.656122395571665*^9, 3.656122431736665*^9}, 3.6561225299246645`*^9, {
   3.656123154484665*^9, 3.6561231549816647`*^9}, 3.6561240091501265`*^9, 
   3.656293667905565*^9, {3.656293825601565*^9, 3.6562938260215645`*^9}, {
   3.6562997907443066`*^9, 3.656299791271307*^9}, {3.656299936379307*^9, 
   3.656299957779307*^9}, {3.6563000716233068`*^9, 3.656300095948307*^9}, {
   3.656300281589307*^9, 3.656300296858307*^9}, 3.656300336101307*^9, {
   3.656366562496133*^9, 3.6563665629221325`*^9}, 3.6563668016751328`*^9, {
   3.656370133701973*^9, 3.656370134233026*^9}, {3.65637038117445*^9, 
   3.6563703968508825`*^9}, {3.656370554840082*^9, 3.656370555406025*^9}, 
   3.656370889774086*^9, {3.6563713675320864`*^9, 3.656371368064086*^9}, {
   3.656371465357086*^9, 3.656371465786086*^9}, {3.656371557361086*^9, 
   3.6563715578880863`*^9}, 3.656371644942086*^9, {3.6563730132140865`*^9, 
   3.656373013743086*^9}, {3.6563733891240864`*^9, 3.656373389799086*^9}, {
   3.656373568145782*^9, 3.656373568604828*^9}, 3.656374323952081*^9, {
   3.6563804185850763`*^9, 3.656380419096076*^9}, {3.656380665594557*^9, 
   3.6563806735833554`*^9}, {3.6563807167306695`*^9, 3.656380724653462*^9}, 
   3.656380790966092*^9, {3.6563808427722726`*^9, 3.6563808433073263`*^9}, {
   3.6563809031840744`*^9, 3.6563809201430745`*^9}, 3.6563809586730747`*^9, {
   3.6563817819870744`*^9, 3.6563817825210743`*^9}, 3.6563824117100744`*^9, 
   3.656385921362073*^9, 3.656386242362073*^9, {3.6563916811211257`*^9, 
   3.656391681667108*^9}, 3.6563919866427517`*^9, {3.656392155808917*^9, 
   3.6563921563705177`*^9}, 3.656392570846917*^9, {3.656624395600853*^9, 
   3.6566243961012516`*^9}, {3.6566244286651278`*^9, 
   3.6566244308185406`*^9}, {3.656624515852378*^9, 3.6566245165035954`*^9}, 
   3.656624596818571*^9, 3.6566256774587264`*^9, {3.6566260275386696`*^9, 
   3.656626027980625*^9}, {3.656629201093937*^9, 3.6566292017560034`*^9}, {
   3.6566303282797213`*^9, 3.656630328707721*^9}, {3.6566307363107214`*^9, 
   3.6566307368837214`*^9}, {3.6566311985627213`*^9, 3.656631199084721*^9}, 
   3.6566313864307213`*^9, {3.6566317084807215`*^9, 3.656631708997721*^9}, 
   3.656632048297721*^9, {3.656634273590625*^9, 3.656634274006666*^9}, 
   3.656634364521717*^9, {3.6566346019407177`*^9, 3.656634602495718*^9}, 
   3.656634687634718*^9, {3.6566403933025994`*^9, 3.656640393848654*^9}, 
   3.656641105216711*^9, {3.6566427695720067`*^9, 3.6566427700790577`*^9}, {
   3.6566453928243074`*^9, 3.656645393314307*^9}, 3.656645503118307*^9, {
   3.656646479531307*^9, 3.656646479940307*^9}, {3.656651164518306*^9, 
   3.656651165103306*^9}, {3.6566513958213053`*^9, 3.6566514078763056`*^9}, {
   3.656651678938306*^9, 3.6566516970083055`*^9}, {3.6566520039133053`*^9, 
   3.656652004556306*^9}, {3.6567170831342397`*^9, 3.6567170837542396`*^9}, 
   3.6567172968972397`*^9, {3.656736573335614*^9, 3.65673658618985*^9}, 
   3.656736777412198*^9, 3.656737015039257*^9, {3.6568067873051567`*^9, 
   3.65680678783421*^9}, 3.6568178857601395`*^9, {3.6568180884391394`*^9, 
   3.6568181061351395`*^9}, 3.656891436240266*^9, 3.656894201596631*^9, 
   3.6569740063342514`*^9, {3.6569836305085263`*^9, 3.656983631203457*^9}, 
   3.656988979283881*^9, 3.6569892955978813`*^9, 3.6569893526708813`*^9, 
   3.656991424903824*^9, 3.6569942046868725`*^9, {3.657228877273163*^9, 
   3.6572288784742317`*^9}, {3.657250960194082*^9, 3.657250960913082*^9}, {
   3.657315107571686*^9, 3.6573151088459797`*^9}, 3.6573186586650977`*^9, 
   3.657323615006775*^9, 3.6573253398375235`*^9, {3.657325450528454*^9, 
   3.657325474439062*^9}, 3.6573259367279086`*^9, {3.6573296597846675`*^9, 
   3.6573296668863773`*^9}, 3.657330384545902*^9, {3.657330999670902*^9, 
   3.6573310003179016`*^9}, 3.657333571682268*^9, 3.6573342702888985`*^9, 
   3.6573343256728983`*^9, 3.6573345618948984`*^9, {3.6573348468718987`*^9, 
   3.657334874535898*^9}, {3.6573356134048986`*^9, 3.6573356319348984`*^9}, {
   3.6573356741428986`*^9, 3.6573356747188983`*^9}, 3.6573357167398987`*^9, {
   3.6573358741408987`*^9, 3.657335874891898*^9}, 3.6573363328308983`*^9, {
   3.6573365453998985`*^9, 3.6573365459418983`*^9}, 3.6573367889748983`*^9, 
   3.6573374748898983`*^9, {3.657337727421568*^9, 3.6573377279526744`*^9}, {
   3.657338025237009*^9, 3.657338025904076*^9}, {3.657338619875893*^9, 
   3.6573386265568933`*^9}, {3.657339907810893*^9, 3.657339929562893*^9}, 
   3.657339963276893*^9, 3.657339993466893*^9, {3.657340079791893*^9, 
   3.657340094815893*^9}, 3.6573406554658933`*^9, 3.657340719584893*^9, 
   3.657340862437893*^9, 3.657341003829893*^9, 3.6573415466818933`*^9, 
   3.657341855146736*^9, {3.657401709576003*^9, 3.6574017108810773`*^9}, 
   3.6574017760808067`*^9, 3.6574281372202415`*^9, 3.657489635762961*^9, 
   3.657497419047653*^9, 3.657498532987672*^9, 3.65750534821166*^9, 
   3.6575100731798725`*^9, 3.6575112862548723`*^9, 3.657574679509344*^9, 
   3.657584022012558*^9, {3.6575849322578716`*^9, 3.6575849336388717`*^9}, 
   3.6575849783908715`*^9, 3.6575850755758715`*^9, 3.6575890142448983`*^9, 
   3.65759228846086*^9, {3.657834602471362*^9, 3.6578346352351737`*^9}, {
   3.6578532138521967`*^9, 3.6578532146491966`*^9}, 3.6578547004939766`*^9, {
   3.6578547576981936`*^9, 3.6578547585961933`*^9}, 3.6578578507511864`*^9, {
   3.6578579269081864`*^9, 3.6578579278011866`*^9}, {3.657858153722186*^9, 
   3.6578581629761868`*^9}, 3.6578616156681814`*^9, 3.6579201112378545`*^9, 
   3.657920503887043*^9, {3.6579206281550426`*^9, 3.6579206288250427`*^9}, {
   3.657921886844302*^9, 3.657921893516302*^9}, 3.657922381061302*^9, 
   3.657922499105302*^9, 3.657922578234302*^9, 3.657922750512302*^9, 
   3.657924195284134*^9, 3.657924321718134*^9, 3.657924505494134*^9, {
   3.6579248582521343`*^9, 3.657924859169134*^9}, 3.6579263276741343`*^9, {
   3.6579301935073304`*^9, 3.6579301944333305`*^9}, 3.6579306828009834`*^9, {
   3.657934522277545*^9, 3.657934523213545*^9}, {3.6579362349085417`*^9, 
   3.6579362490095415`*^9}, {3.6579408235078506`*^9, 
   3.6579408244906387`*^9}, {3.6579413583352003`*^9, 3.6579413592711887`*^9}, 
   3.6580065235640297`*^9, {3.658024565501179*^9, 3.658024566452749*^9}, {
   3.658026401844767*^9, 3.6580264027651377`*^9}, 3.6580264592041287`*^9, {
   3.658026911225849*^9, 3.6580269118966274`*^9}, 3.658027562566187*^9, {
   3.6580282919698105`*^9, 3.65802829324897*^9}, {3.6580290333254585`*^9, 
   3.6580290346202173`*^9}, 3.6580304028879642`*^9, {3.65803125600224*^9, 
   3.658031308370097*^9}, {3.6580940443002834`*^9, 3.6580940729412837`*^9}, {
   3.6580941196382837`*^9, 3.6580941361732836`*^9}, 3.6580941870342836`*^9, 
   3.658094226254284*^9, 3.6580943730402837`*^9, 3.6580944226152835`*^9, 
   3.6580947130619526`*^9, 3.6580947832079663`*^9, 3.658094941084752*^9, 
   3.658095467312282*^9, 3.658115754844253*^9, {3.6581186474552526`*^9, 
   3.658118648423253*^9}, {3.658181631178345*^9, 3.658181632313345*^9}, 
   3.658448730877417*^9, 3.6584527905864105`*^9, 3.6584532307714105`*^9, 
   3.6584532784474106`*^9, 3.658454703789898*^9, 3.6584548505414085`*^9, 
   3.6584614686175594`*^9, 3.6585270097490087`*^9, 3.6585275125780087`*^9, {
   3.6585357715716105`*^9, 3.6585357725647097`*^9}, 3.6586115534381456`*^9, 
   3.65862088250842*^9, 3.6586218873314185`*^9, 3.65862865164741*^9, 
   3.65862912877341*^9, 3.658630771046405*^9, {3.6586344702124014`*^9, 
   3.6586344712244015`*^9}, 3.658638995816395*^9, {3.6587004133780746`*^9, 
   3.658700441664075*^9}, {3.658700476027075*^9, 3.6587004785260744`*^9}, 
   3.6587008082320747`*^9, 3.658700895127494*^9, 3.6587010376027403`*^9, 
   3.6587011509890776`*^9, 3.658701184626441*^9, {3.6587013693449106`*^9, 
   3.6587014159240713`*^9}, {3.6587060025938997`*^9, 3.6587060037099*^9}, {
   3.658714486157772*^9, 3.6587145029591875`*^9}, {3.658717828496916*^9, 
   3.6587178461869755`*^9}, 3.658717876887185*^9, {3.6587179083673797`*^9, 
   3.6587179305345535`*^9}, {3.6587191959452376`*^9, 
   3.6587192168332357`*^9}, {3.6587192773132725`*^9, 
   3.6587192923201838`*^9}, {3.6587220488075347`*^9, 3.658722071271103*^9}, 
   3.6587859240559764`*^9, 3.6588074756828785`*^9, {3.6588103428392086`*^9, 
   3.658810343900009*^9}, {3.658810740654809*^9, 3.658810741918409*^9}, 
   3.65881155030672*^9, 3.658811630284331*^9, {3.659044206447936*^9, 
   3.6590442073328075`*^9}, {3.659044457986394*^9, 3.6590444854723873`*^9}, {
   3.6590445161957893`*^9, 3.659044545770111*^9}, {3.659133127784753*^9, 
   3.6591331288698616`*^9}, {3.659135942720048*^9, 3.6591359442350483`*^9}, {
   3.6591384627500443`*^9, 3.659138463574044*^9}, 3.6591387649460444`*^9, 
   3.6591462293793435`*^9, 3.6596742677172623`*^9, 3.6597343723489904`*^9, 
   3.6597373471057777`*^9, 3.659907388904068*^9, 3.6599074672094336`*^9, {
   3.6599085544140897`*^9, 3.6599085555049806`*^9}, 3.659917259573724*^9, 
   3.6599280919733906`*^9, 3.6599347985192547`*^9, 3.659993825560443*^9, 
   3.6600148281799583`*^9, 3.660252759908476*^9, 3.660255243561527*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6560434269952936`*^9, 3.656043429723294*^9}, {
   3.656123550319665*^9, 3.6561235535016646`*^9}, 3.656123601907158*^9, {
   3.656123683931204*^9, 3.6561237088130445`*^9}, {3.6561240132373004`*^9, 
   3.656124014516492*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Main", " ", "Program"}], "*)"}]], "Input",
 CellChangeTimes->{{3.656641288369711*^9, 3.656641295622711*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Start", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "{", "\"\<Mathematica Beam Analysis Package(MBAP)\>\"", "}"}], ",", 
          RowBox[{"{", "\"\<Version:Alpha\>\"", "}"}], ",", 
          RowBox[{"{", "\"\<Written by: Ji Yiling\>\"", "}"}], ",", 
          RowBox[{
          "{", "\"\<Test Use Only,Do Not Share to Others\>\"", "}"}]}], "}"}],
         ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", "Gray"}], ",", 
        RowBox[{"ItemStyle", "\[Rule]", "Gray"}], ",", 
        RowBox[{"Spacings", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"10", ",", " ", "1"}], "}"}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<----Data Input Module---\>\"", ",", "SpanFromLeft", ",", 
          "SpanFromLeft"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Step1\>\"", ",", 
            RowBox[{"DataInput", "[", "]"}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Step2\>\"", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "nodcoord2", ",", "elenod2", ",", "aa2", ",", "dd2", ",", "ee2",
                ",", "ibeam", ",", "ksbeam"}], "}"}], "=", 
             RowBox[{"PreProcessor", "[", "pp", "]"}]}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Step3\>\"", ",", 
            RowBox[{"AddConstrain", "[", "nodcoord2", "]"}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<----General Analysis Module----\>\"", ",", "SpanFromLeft", ",", 
          "SpanFromLeft"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Linear Static\>\"", ",", 
            RowBox[{"SpaceTrussSolution", "[", 
             RowBox[{
             "nodcoord2", ",", "elenod2", ",", "ee2", ",", "aa2", ",", 
              "nodtag", ",", "nodval", ",", "nodspp", ",", "ibeam", ",", 
              "ebeam", ",", "bsp", ",", "ksbeam"}], "]"}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Linear Buckling\>\"", ",", 
            RowBox[{"SpaceTrussBuckling", "[", 
             RowBox[{
             "nodcoor2", ",", "aa2", ",", "elenod2", ",", "dd2", ",", "ee2", 
              ",", "ibeam", ",", "nodtag", ",", "nodspp", ",", "conmall", ",",
               "ksbeam"}], "]"}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Real Eigenvalue\>\"", ",", 
            RowBox[{"SpaceTrussMode", "[", 
             RowBox[{
             "nodcoord2", ",", "aa2", ",", "elenod2", ",", "dd2", ",", "ee2", 
              ",", "ibeam", ",", "nodtag", ",", "nodspp", ",", "conmall", ",",
               "ksbeam"}], "]"}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Complex Eigenvalue\>\"", ",", 
            RowBox[{"SpaceTrussModeC", "[", 
             RowBox[{
             "nodcoord2", ",", "aa2", ",", "elenod2", ",", "dd2", ",", "ee2", 
              ",", "ibeam", ",", "nodtag", ",", "nodspp", ",", "conmall", ",",
               "ksbeam"}], "]"}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Direct Frequency Response\>\"", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"std1", ",", "std2"}], "}"}], "=", 
             RowBox[{"SpaceTrussDFR", "[", 
              RowBox[{
              "nodcoord2", ",", "elenod2", ",", "ee2", ",", "aa2", ",", 
               "nodtag", ",", "nodval", ",", "nodsppd", ",", "ibeam", ",", 
               "ww", ",", "conmall", ",", "dd2", ",", "ksbeam"}], "]"}]}], 
            ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Linear Transient\>\"", ",", 
            RowBox[{"SpaceLinearTransient", "[", 
             RowBox[{
             "nodcoord2", ",", "elenod2", ",", "ee2", ",", "aa2", ",", 
              "nodtag", ",", "nodspp", ",", "ibeam", ",", "conmall", ",", 
              "dd2", ",", "ksbeam", ",", "dt", ",", "in", ",", "nodvald"}], 
             "]"}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<----Rotor Dynamic Module----\>\"", ",", "SpanFromLeft", ",", 
          "SpanFromLeft"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Undamped Rotor Plot\>\"", ",", 
            RowBox[{"RotorMode", "[", 
             RowBox[{
             "nodcoord2", ",", "aa2", ",", "elenod2", ",", "dd2", ",", "ee2", 
              ",", "ibeam", ",", "nodtag", ",", "nodsppd", ",", "conmall", 
              ",", "ros", ",", "bps", ",", "ksbeam"}], "]"}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Rotor DFR Plot\>\"", ",", 
            RowBox[{"RotorDFR", "[", 
             RowBox[{
             "nodcoord2", ",", "elenod2", ",", "ee2", ",", "aa2", ",", 
              "nodtag", ",", "nodval", ",", "nodsppd", ",", "ibeam", ",", 
              "ww", ",", "conmall", ",", "dd2", ",", "nodum", ",", "rdfrnode",
               ",", "ksbeam"}], "]"}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Rotor Disp. Plot3D\>\"", ",", 
            RowBox[{"RotorDFR2", "[", 
             RowBox[{
             "nodcoord2", ",", "elenod2", ",", "ee2", ",", "aa2", ",", 
              "nodtag", ",", "nodval", ",", "nodsppd", ",", "ibeam", ",", 
              "ww2", ",", "conmall", ",", "dd2", ",", "nodum", ",", 
              "ksbeam"}], "]"}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Rotor Stability\>\"", ",", 
           RowBox[{"RotorModeC", "[", 
            RowBox[{
            "nodcoord2", ",", "aa2", ",", "elenod2", ",", "dd2", ",", "ee2", 
             ",", "ibeam", ",", "nodtag", ",", "nodspp", ",", "conmall", ",", 
             "ksbeam"}], "]"}], ",", 
           RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], "}"}]}], 
       "}"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656043797695294*^9, 3.656043798996294*^9}, {
   3.656047342706287*^9, 3.656047353732287*^9}, {3.6561137378987403`*^9, 
   3.6561137446660633`*^9}, {3.6562937103285646`*^9, 
   3.6562937454455647`*^9}, {3.656293787395565*^9, 3.656293808454565*^9}, {
   3.656293843074565*^9, 3.656293857181565*^9}, {3.656302157047828*^9, 
   3.656302167118842*^9}, {3.656372684206086*^9, 3.656372686439086*^9}, {
   3.6563812053190746`*^9, 3.6563812189030743`*^9}, {3.6566241580537376`*^9, 
   3.656624239417498*^9}, {3.656624284144761*^9, 3.656624306156315*^9}, {
   3.656624352111103*^9, 3.6566243836222444`*^9}, {3.6566244187899923`*^9, 
   3.6566244196689367`*^9}, {3.6566244829628925`*^9, 3.656624494497035*^9}, {
   3.6566467070303073`*^9, 3.6566467152803073`*^9}, {3.6568179542441397`*^9, 
   3.6568179970351396`*^9}, {3.6568180373191395`*^9, 
   3.6568180691961393`*^9}, {3.6569106017214413`*^9, 3.656910618697441*^9}, {
   3.6569106729414415`*^9, 3.656910728841441*^9}, {3.6569888176948814`*^9, 
   3.656988821325881*^9}, {3.6573260708809085`*^9, 3.6573260781179085`*^9}, 
   3.6573261114959087`*^9, {3.6573295341053*^9, 3.65732953690586*^9}, {
   3.6573295750864944`*^9, 3.6573296033961554`*^9}, {3.6573296489775867`*^9, 
   3.6573296509657855`*^9}, {3.6573343123338985`*^9, 
   3.6573343182638984`*^9}, {3.6573356053548985`*^9, 
   3.6573356280738983`*^9}, {3.6573362497438984`*^9, 
   3.6573362523568983`*^9}, {3.657336311780898*^9, 3.6573363134848986`*^9}, {
   3.6573368024658985`*^9, 3.6573368055538983`*^9}, 3.657337412582898*^9, {
   3.657337569685027*^9, 3.657337571309352*^9}, {3.6575050716076603`*^9, 
   3.65750509446766*^9}, {3.65750519086166*^9, 3.65750526550366*^9}, {
   3.65750530941966*^9, 3.6575053125496597`*^9}, {3.6575840408798714`*^9, 
   3.6575840936908717`*^9}, {3.6575841299198713`*^9, 
   3.6575842157688713`*^9}, {3.6575842536248713`*^9, 3.6575842781328716`*^9}, 
   3.6575849749288716`*^9, {3.6575850538898716`*^9, 3.657585068845872*^9}, {
   3.6575923498438597`*^9, 3.6575923959448595`*^9}, {3.6578345676721354`*^9, 
   3.657834631016965*^9}, {3.6578401565207663`*^9, 3.6578401654646606`*^9}, {
   3.658025826114021*^9, 3.658025912207661*^9}, {3.6587003227670746`*^9, 
   3.6587003246690745`*^9}, {3.6587003656540747`*^9, 
   3.6587004370880747`*^9}, {3.6587004680420747`*^9, 3.658700469532075*^9}, {
   3.658700546440075*^9, 3.6587005543200746`*^9}, {3.6587005905310745`*^9, 
   3.6587006003190746`*^9}, {3.6587006316140747`*^9, 
   3.6587008044180746`*^9}, {3.6587008852395053`*^9, 
   3.6587008915411353`*^9}, {3.6587009394669275`*^9, 
   3.6587009438073616`*^9}, {3.6587010259255724`*^9, 3.658701033733353*^9}, {
   3.6587011248254614`*^9, 3.658701223867365*^9}, {3.658701363175294*^9, 
   3.658701411772071*^9}, 3.6587144982479277`*^9, {3.658785324728751*^9, 
   3.658785330620983*^9}, {3.658811074278061*^9, 3.6588110852103662`*^9}, {
   3.6588111158395357`*^9, 3.658811205097475*^9}, {3.65881125193887*^9, 
   3.658811253186726*^9}, {3.658811517470193*^9, 3.658811524271488*^9}, {
   3.6588115949207177`*^9, 3.658811625916527*^9}, {3.6591386260270443`*^9, 
   3.6591387516720448`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.657926319047134*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DataInput", "[", "]"}], ":=", 
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"pp", "=", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
        "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", 
         "aa", ",", "dd", ",", "ee", ",", "Iyy", ",", "Izz", ",", "Ksy", ",", 
         "Ksz", ",", "\[Nu]"}], "}"}], "}"}]}], ";", "\n", 
     RowBox[{"mn", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Recommended Units\>\"", ",", "SpanFromLeft"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Length\>\"", ",", "\"\<mm\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Mass\>\"", ",", "\"\<t\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Time\>\"", ",", "\"\<Sec\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Force\>\"", ",", "\"\<N->t.mm/s^2\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Stress&E\>\"", ",", "\"\<MPa->N/mm^2\>\""}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Stiffness\>\"", ",", "\"\<N/mm\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Damping\>\"", ",", "\"\<N.Sec/mm\>\""}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ss", "=", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Dynamic", "[", 
          RowBox[{"pp", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"pp", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "2"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"pp", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "3"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"pp", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "4"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"pp", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "5"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"pp", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "6"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"pp", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "7"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"pp", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "8"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"pp", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "9"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"pp", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "10"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"pp", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "11"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"pp", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "12"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"pp", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "13"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"pp", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "14"}], "]"}], "]"}], "]"}]}], "}"}], "}"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Element Data Input:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<aa->Area,dd->Material Density,ee->Ela.M\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<Iyy/Izz->Area Moment of Inertia,Ksy,Ksz->Shear Stiffness \
Factor\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<\[Nu]->Poisson\[CloseCurlyQuote]s ratio\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"ss", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"ss", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"ss", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"ss", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "4"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"ss", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "5"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"ss", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "6"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"ss", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "7"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"ss", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "8"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"ss", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "9"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"ss", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "10"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"ss", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "11"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"ss", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "12"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"ss", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "13"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"ss", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "14"}], "]"}], "]"}], ",", 
             RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", "\n", 
     RowBox[{"Print", "[", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Add New Point\>\"", ",", 
        RowBox[{
         RowBox[{"k", "=", 
          RowBox[{"k", "+", "1"}]}], ";", 
         RowBox[{"pp", "=", 
          RowBox[{"Insert", "[", 
           RowBox[{"pp", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"k", "-", "1"}], ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"k", "-", "1"}], ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"k", "-", "1"}], ",", "3"}], "]"}], "]"}], ",", 
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"k", "-", "1"}], ",", "4"}], "]"}], "]"}], ",", 
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"k", "-", "1"}], ",", "5"}], "]"}], "]"}], ",", 
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"k", "-", "1"}], ",", "6"}], "]"}], "]"}], ",", 
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"k", "-", "1"}], ",", "7"}], "]"}], "]"}], ",", 
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"k", "-", "1"}], ",", "8"}], "]"}], "]"}], ",", 
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"k", "-", "1"}], ",", "9"}], "]"}], "]"}], ",", 
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"k", "-", "1"}], ",", "10"}], "]"}], "]"}], ",", 
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"k", "-", "1"}], ",", "11"}], "]"}], "]"}], ",", 
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"k", "-", "1"}], ",", "12"}], "]"}], "]"}], ",", 
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"k", "-", "1"}], ",", "13"}], "]"}], "]"}], ",", 
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"k", "-", "1"}], ",", "14"}], "]"}], "]"}]}], "}"}], 
            ",", "k"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ss", "=", 
          RowBox[{"Insert", "[", 
           RowBox[{"ss", ",", 
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
               "0"}], "}"}], ",", "k"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ss", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Dynamic", "[", 
             RowBox[{"pp", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "1"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"pp", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "2"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"pp", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "3"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"pp", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "4"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"pp", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "5"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"pp", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "6"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"pp", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "7"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"pp", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "8"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"pp", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "9"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"pp", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "10"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"pp", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "11"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"pp", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "12"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"pp", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "13"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Dynamic", "[", 
             RowBox[{"pp", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "14"}], "]"}], "]"}], "]"}]}], "}"}]}], 
         ";"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Element Data:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tt1", "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<No.\>\"", ",", "\"\<x1\>\"", ",", "\"\<y1\>\"", ",", "\"\<z1\>\"",
         ",", "\"\<x2\>\"", ",", "\"\<y2\>\"", ",", "\"\<z2\>\"", ",", 
        "\"\<Area\>\"", ",", "\"\<Density\>\"", ",", "\"\<Elastic.M\>\"", 
        ",", "\"\<Iyy\>\"", ",", "\"\<Izz\>\"", ",", "\"\<Ksy\>\"", ",", 
        "\"\<Ksz\>\"", ",", "\"\<\[Nu]\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"sss", "=", 
       RowBox[{"OpenerView", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Element Data\>\"", ",", "Gray"}], "]"}], ",", 
           RowBox[{"Dynamic", "[", 
            RowBox[{"Grid", "[", 
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "pp", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1"}], "}"}]}], "]"}], ",", "pp", ",", 
                  "2"}], "]"}], ",", "tt1"}], "]"}], ",", 
              RowBox[{"Dividers", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"False", ",", "All"}], "}"}]}]}], "]"}], "]"}]}], 
          "}"}], ",", "True"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"elec", "=", 
      RowBox[{"elecp", "=", 
       RowBox[{"elecl", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ntt", "=", 
      RowBox[{"{", 
       RowBox[{"Text", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.5"}], ",", 
           RowBox[{"-", "1.5"}]}], "}"}]}], "]"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mpp", "=", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Graphics3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ntt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "Large", "]"}], ",", "Red", ",", 
              RowBox[{"Point", "[", "elecp", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Blue", ",", 
              RowBox[{"Line", "[", "elecl", "]"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ",", 
          RowBox[{"FaceGrids", "\[Rule]", "All"}], ",", 
          RowBox[{"TicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", "Bold", "]"}]}], ",", 
          RowBox[{"PlotRangePadding", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NumberQ", "[", 
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "7"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"1.5", "*", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"pp", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "7"}], "]"}], "]"}], "]"}]}], ",", "10"}], 
            "]"}]}]}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Plot\>\"", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"elec", "=", 
            RowBox[{"pp", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{
                "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
                "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"elec", "=", 
            RowBox[{"Flatten", "[", "elec", "]"}]}], ";", 
           RowBox[{"elecp", "=", 
            RowBox[{"Partition", "[", 
             RowBox[{"elec", ",", "3"}], "]"}]}], ";", 
           RowBox[{"elecl", "=", 
            RowBox[{"Partition", "[", 
             RowBox[{"elecp", ",", "2"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "mpp", "]"}], ";", "\n", 
     RowBox[{"Print", "[", "\"\<Element Data Modified:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Input the Modified Element Number First:\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"InputField", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "mn", "]"}], ",", "Number", ",", 
        RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"pp", "[", 
                RowBox[{"[", 
                 RowBox[{"mn", ",", "1"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"pp", "[", 
                RowBox[{"[", 
                 RowBox[{"mn", ",", "2"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"pp", "[", 
                RowBox[{"[", 
                 RowBox[{"mn", ",", "3"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"pp", "[", 
                RowBox[{"[", 
                 RowBox[{"mn", ",", "4"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"pp", "[", 
                RowBox[{"[", 
                 RowBox[{"mn", ",", "5"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"pp", "[", 
                RowBox[{"[", 
                 RowBox[{"mn", ",", "6"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"pp", "[", 
                RowBox[{"[", 
                 RowBox[{"mn", ",", "7"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"pp", "[", 
                RowBox[{"[", 
                 RowBox[{"mn", ",", "8"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"pp", "[", 
                RowBox[{"[", 
                 RowBox[{"mn", ",", "9"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"pp", "[", 
                RowBox[{"[", 
                 RowBox[{"mn", ",", "10"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"pp", "[", 
                RowBox[{"[", 
                 RowBox[{"mn", ",", "11"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"pp", "[", 
                RowBox[{"[", 
                 RowBox[{"mn", ",", "12"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"pp", "[", 
                RowBox[{"[", 
                 RowBox[{"mn", ",", "13"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", 
              RowBox[{"pp", "[", 
               RowBox[{"[", 
                RowBox[{"mn", ",", "14"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Element Data Delete:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Input the Deleted Element Number First:\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"InputField", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "dln", "]"}], ",", "Number", ",", 
        RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<ClickToDelete\>\"", ",", 
        RowBox[{
         RowBox[{"pp", "=", 
          RowBox[{"Drop", "[", 
           RowBox[{"pp", ",", 
            RowBox[{"{", "dln", "}"}]}], "]"}]}], ";", 
         RowBox[{"k", "=", 
          RowBox[{"k", "-", "1"}]}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<-------------------Next Step---------------------\>\"", ",", 
        RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
        RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6561144099312725`*^9, 3.6561144181322727`*^9}, {
   3.6561145240532727`*^9, 3.656114646291273*^9}, {3.6561147038982725`*^9, 
   3.6561147050562725`*^9}, {3.656369671860793*^9, 3.656369773246931*^9}, {
   3.656369815098116*^9, 3.6563699390585103`*^9}, {3.6563699742950335`*^9, 
   3.6563699837579803`*^9}, {3.6563700717117743`*^9, 3.656370090009604*^9}, {
   3.6563703351070576`*^9, 3.6563703543401337`*^9}, {3.656370492324334*^9, 
   3.6563705223993263`*^9}, {3.656370730858086*^9, 3.656370734917086*^9}, {
   3.656370884302086*^9, 3.656370884817086*^9}, {3.656371008437086*^9, 
   3.6563710115990863`*^9}, 3.6563711114450865`*^9, {3.656371512828086*^9, 
   3.6563715417350864`*^9}, {3.656371594956086*^9, 3.6563716216620865`*^9}, {
   3.656371760128086*^9, 3.656371792324086*^9}, {3.6563718486690865`*^9, 
   3.656371848800086*^9}, {3.6563731063560863`*^9, 3.656373110154086*^9}, {
   3.656373239609086*^9, 3.6563732424330864`*^9}, {3.656373322498086*^9, 
   3.6563733301170864`*^9}, {3.656373547663734*^9, 3.6563735514601135`*^9}, {
   3.6563742771476755`*^9, 3.656374317690081*^9}, {3.6563743638050814`*^9, 
   3.6563743710500813`*^9}, {3.6563744363335276`*^9, 3.6563744396961913`*^9}, 
   3.656374512920868*^9, {3.6563747890720825`*^9, 3.6563748065100827`*^9}, {
   3.656379375142076*^9, 3.656379395121076*^9}, {3.656379645318076*^9, 
   3.656379685130076*^9}, {3.656379851381076*^9, 3.6563799383680763`*^9}, {
   3.656380405300076*^9, 3.656380405429076*^9}, {3.6563806597189693`*^9, 
   3.6563806600410013`*^9}, 3.656380702061203*^9, {3.6563807594139376`*^9, 
   3.65638076624062*^9}, {3.6563808946790743`*^9, 3.6563808963280745`*^9}, {
   3.6563809388360744`*^9, 3.6563809490850744`*^9}, {3.656381759247074*^9, 
   3.656381763773074*^9}, {3.656381936471074*^9, 3.6563819444530745`*^9}, {
   3.6563823989660745`*^9, 3.6563824040840745`*^9}, {3.6563827373255234`*^9, 
   3.656382790850876*^9}, {3.656382848059596*^9, 3.6563828535161414`*^9}, {
   3.6563829244670725`*^9, 3.6563829311950727`*^9}, {3.6566259545187263`*^9, 
   3.656625963284726*^9}, 3.656626354263728*^9, {3.6566301265657215`*^9, 
   3.6566301327597213`*^9}, {3.656630244136721*^9, 3.656630244530721*^9}, {
   3.6566303213907213`*^9, 3.6566303217857213`*^9}, {3.656630644597721*^9, 
   3.6566307180557213`*^9}, {3.656631038870721*^9, 3.6566310609047213`*^9}, {
   3.656631188281721*^9, 3.6566311897987213`*^9}, {3.6566474808793073`*^9, 
   3.656647496223307*^9}, {3.6566475582613072`*^9, 3.6566476130693073`*^9}, {
   3.657339122102893*^9, 3.6573391314768934`*^9}, {3.6573394495808935`*^9, 
   3.657339456451893*^9}, {3.6573397071348934`*^9, 3.6573397313448935`*^9}, {
   3.657339790232893*^9, 3.6573398347008934`*^9}, {3.657339892626893*^9, 
   3.6573399034258933`*^9}, {3.6573399472148933`*^9, 
   3.6573399574248934`*^9}, {3.657340004984893*^9, 3.657340071326893*^9}, {
   3.657340105920893*^9, 3.657340106315893*^9}, {3.657858148932186*^9, 
   3.6578581492461863`*^9}, {3.657921822012302*^9, 3.6579218791323023`*^9}, {
   3.6580253911043563`*^9, 3.6580254228337393`*^9}, {3.6580254535803537`*^9, 
   3.6580255034363556`*^9}, {3.658025538301238*^9, 3.658025583354602*^9}, {
   3.658025614319609*^9, 3.6580256616328926`*^9}, {3.658025704718712*^9, 
   3.6580257090553727`*^9}, {3.6580301833562007`*^9, 3.658030290789957*^9}, {
   3.658030353078761*^9, 3.658030393419068*^9}, {3.658030560960581*^9, 
   3.658030716708788*^9}, {3.658031377335929*^9, 3.658031378396702*^9}, {
   3.6580320955058093`*^9, 3.6580321065502553`*^9}, {3.6580321493552833`*^9, 
   3.658032189445998*^9}, {3.6580940097592835`*^9, 3.658094041374284*^9}, {
   3.6580940915202837`*^9, 3.6580941058212833`*^9}, {3.658094175426284*^9, 
   3.6580941817132835`*^9}, {3.6580943327532835`*^9, 3.658094368228284*^9}, {
   3.6580949609152822`*^9, 3.6580949616912823`*^9}, {3.6587177258818836`*^9, 
   3.658717815985956*^9}, {3.658717867152972*^9, 3.658717902689089*^9}, {
   3.659043928827914*^9, 3.6590440370791054`*^9}, {3.659044067637882*^9, 
   3.6590441079678574`*^9}, {3.659044144921954*^9, 3.6590441533486814`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PreProcessor", "[", "raw_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rawcoord", ",", "nodcoord", ",", "elenod", ",", "rawaa", ",", "rawdd", 
      ",", "rawee", ",", "rawibeam", ",", "aa", ",", "dd", ",", "ee", ",", 
      "ibeam", ",", "i", ",", "nood", ",", "nft", ",", "rawksbeam", ",", 
      "ksbeam", ",", "rawnu"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rawcoord", "=", 
      RowBox[{"raw", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
          "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rawcoord", "=", 
      RowBox[{"Flatten", "[", "rawcoord", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rawcoord", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"rawcoord", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nodcoord", "=", 
      RowBox[{"Union", "[", "rawcoord", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "rawcoord", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rawcoord", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"Position", "[", 
         RowBox[{"nodcoord", ",", 
          RowBox[{"rawcoord", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rawcoord", "=", 
      RowBox[{"Flatten", "[", "rawcoord", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"elenod", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"rawcoord", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rawaa", "=", 
      RowBox[{"raw", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "7"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"aa", "=", 
      RowBox[{"Flatten", "[", "rawaa", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rawdd", "=", 
      RowBox[{"raw", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "8"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dd", "=", 
      RowBox[{"Flatten", "[", "rawdd", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rawee", "=", 
      RowBox[{"raw", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "9"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ee", "=", 
      RowBox[{"Flatten", "[", "rawee", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rawibeam", "=", 
      RowBox[{"raw", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"10", ",", "11"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ibeam", "=", "rawibeam"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rawksbeam", "=", 
      RowBox[{"raw", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"12", ",", "13"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ksbeam", "=", "rawksbeam"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rawnu", "=", 
      RowBox[{"raw", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "14"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nua", "=", 
      RowBox[{"Flatten", "[", "rawnu", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nood", "=", 
      RowBox[{"Length", "[", "nodcoord", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ntt", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "nood"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"ntt", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"ntt", ",", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"i", ",", 
              RowBox[{"FontColor", "\[Rule]", "Black"}], ",", 
              RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}], ",", 
            RowBox[{"nodcoord", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1.5"}], ",", 
              RowBox[{"-", "1.5"}]}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"CreatePalette", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Click To Plot Node Number \>\"", ",", 
           RowBox[{"FontWeight", "\[Rule]", "Bold"}], ",", 
           RowBox[{"FontSize", "\[Rule]", "25"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Finish\>\"", "]"}], ";", 
          RowBox[{"NotebookClose", "[", " ", 
           RowBox[{"ButtonNotebook", "[", "]"}], "]"}]}], ",", 
         RowBox[{"FrameMargins", "\[Rule]", "Automatic"}]}], "]"}], ",", 
       RowBox[{"WindowMargins", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"WindowTitle", "\[Rule]", "\"\<Step2 Check\>\""}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
       "nodcoord", ",", "elenod", ",", "aa", ",", "dd", ",", "ee", ",", 
        "ibeam", ",", "ksbeam"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656044175942294*^9, 3.656044190746294*^9}, {
   3.656044310468294*^9, 3.656044317045294*^9}, {3.6560443511132936`*^9, 
   3.6560443615352936`*^9}, 3.6560455528042936`*^9, 3.656045626124294*^9, {
   3.6560461720965505`*^9, 3.656046173229664*^9}, {3.656379696296076*^9, 
   3.656379790924076*^9}, {3.6563799885990763`*^9, 3.656380013024076*^9}, {
   3.656381460424074*^9, 3.6563814694180746`*^9}, {3.6563816355930743`*^9, 
   3.6563816401790743`*^9}, {3.656381685134074*^9, 3.6563816887380743`*^9}, {
   3.6563817346560745`*^9, 3.6563817386530743`*^9}, {3.6563823798160744`*^9, 
   3.6563823867060747`*^9}, {3.6563826005740747`*^9, 
   3.6563826067750745`*^9}, {3.656382672304022*^9, 3.6563826745742493`*^9}, {
   3.656383097619073*^9, 3.6563831292690725`*^9}, 3.6563832661270723`*^9, {
   3.658025741112345*^9, 3.6580258118560777`*^9}, {3.6590443717544346`*^9, 
   3.659044410209646*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddConstrain", "[", "nodcoord_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nodnum", "=", 
      RowBox[{"Length", "[", "nodcoord", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nodtag", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", "nodnum", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nodval", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", "nodnum", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nodum", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", "nodnum", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nodsp", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nodspp", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nodsppd", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"alldof", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xyz", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nnn", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ksp", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dsp", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"kspd", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dspd", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "10"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ebeam", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bsp", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5"}], ",", 
          RowBox[{"-", "5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", 
          RowBox[{"-", "5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<Apply DOF To All(0->Free,1->Constrained,Default=0):\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"alldof", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"alldof", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"alldof", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"alldof", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"alldof", "[", 
                RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"alldof", "[", 
                RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Click to Apply\>\"", ",", 
        RowBox[{"nodtag", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"alldof", ",", 
           RowBox[{"{", "nodnum", "}"}]}], "]"}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Input Node Number:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "nnn", "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Select Node\>\"", ",", 
        RowBox[{"xyz", "=", 
         RowBox[{"nodcoord", "[", 
          RowBox[{"[", "nnn", "]"}], "]"}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Selected Node Coordinate is:\>\"", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", "xyz", "]"}], ",", 
        RowBox[{"FontWeight", "\[Rule]", "Bold"}], ",", 
        RowBox[{"FontSize", "\[Rule]", "20"}], ",", 
        RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<Apply DOF To Selected Node(0->Free,1->Constrained,Default=0):\>\"",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"nodtag", "[", 
                RowBox[{"[", 
                 RowBox[{"nnn", ",", "1"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"nodtag", "[", 
                RowBox[{"[", 
                 RowBox[{"nnn", ",", "2"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"nodtag", "[", 
                RowBox[{"[", 
                 RowBox[{"nnn", ",", "3"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"nodtag", "[", 
                RowBox[{"[", 
                 RowBox[{"nnn", ",", "4"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"nodtag", "[", 
                RowBox[{"[", 
                 RowBox[{"nnn", ",", "5"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"nodtag", "[", 
                RowBox[{"[", 
                 RowBox[{"nnn", ",", "6"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Apply Force To Selected Node(Default=0):\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"nodval", "[", 
                RowBox[{"[", 
                 RowBox[{"nnn", ",", "1"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"nodval", "[", 
                RowBox[{"[", 
                 RowBox[{"nnn", ",", "2"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"nodval", "[", 
                RowBox[{"[", 
                 RowBox[{"nnn", ",", "3"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"nodval", "[", 
                RowBox[{"[", 
                 RowBox[{"nnn", ",", "4"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"nodval", "[", 
                RowBox[{"[", 
                 RowBox[{"nnn", ",", "5"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"nodval", "[", 
                RowBox[{"[", 
                 RowBox[{"nnn", ",", "6"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<Apply Unbalance Mass to Selected Node(RotorDynamic Only):\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Mass(m)\>\"", ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"nodum", "[", 
                RowBox[{"[", 
                 RowBox[{"nnn", ",", "1"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Distance(r)\>\"", ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"nodum", "[", 
                RowBox[{"[", 
                 RowBox[{"nnn", ",", "2"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Phase(rad)\>\"", ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"nodum", "[", 
                RowBox[{"[", 
                 RowBox[{"nnn", ",", "3"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<Stress Recovery Data:\>\"", "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", "\"\<Natural Coordinate(from -1 to 1)\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "ebeam", "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Small"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Stress Recovery Local Coordinate(Y&Z)\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "bsp", "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Large"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Add Elastic Spring To Selected Node:\>\"", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<Input the Spring Coordinate Related to the Selected Node:\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", 
              RowBox[{"nodsp", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", 
              RowBox[{"nodsp", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
             RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", 
              RowBox[{"nodsp", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
             RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], 
         "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Input Spring Constant K:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "ksp", "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Input Spring Damping Cofficient B:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "dsp", "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Add Spring\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"nodspp", "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"nodspp", ",", 
           RowBox[{"{", 
            RowBox[{"xyz", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"xyz", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", 
                RowBox[{"nodsp", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"xyz", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", 
                RowBox[{"nodsp", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"xyz", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "+", 
                RowBox[{"nodsp", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", "ksp", ",", 
             "dsp", ",", "nnn"}], "}"}]}], "]"}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Spring Modified:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nn2", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "nn2", "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Spring Position:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Dynamic", "[", 
         RowBox[{"nodspp", "[", 
          RowBox[{"[", 
           RowBox[{"nn2", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"nodspp", "[", 
          RowBox[{"[", 
           RowBox[{"nn2", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<K:\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", 
             RowBox[{"nodspp", "[", 
              RowBox[{"[", 
               RowBox[{"nn2", ",", "3"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<B:\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", 
             RowBox[{"nodspp", "[", 
              RowBox[{"[", 
               RowBox[{"nn2", ",", "4"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Add Dynamic Elastic Spring To Selected Node:\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<Input the Spring Coordinate Related to the Selected Node:\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", 
              RowBox[{"nodsp", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", 
              RowBox[{"nodsp", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
             RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", 
              RowBox[{"nodsp", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
             RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], 
         "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<Input Dynamic Spring Constant K(eg.{{cpm1,k1},{cpm2,k2}}):\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "kspd", "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Large"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<Input Dynamic Spring Damping Cofficient \
B(eg.{{cpm1,b1},{cpm2,b2}}):\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "dspd", "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Large"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Add Spring\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"nodsppd", "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"nodsppd", ",", 
           RowBox[{"{", 
            RowBox[{"xyz", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"xyz", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", 
                RowBox[{"nodsp", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"xyz", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", 
                RowBox[{"nodsp", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"xyz", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "+", 
                RowBox[{"nodsp", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", "kspd", ",", 
             "dspd", ",", "nnn"}], "}"}]}], "]"}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Dynamic Spring Modified:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nn3", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "nn3", "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Spring Position:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Dynamic", "[", 
         RowBox[{"nodsppd", "[", 
          RowBox[{"[", 
           RowBox[{"nn3", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"nodsppd", "[", 
          RowBox[{"[", 
           RowBox[{"nn3", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<K:\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", 
             RowBox[{"nodsppd", "[", 
              RowBox[{"[", 
               RowBox[{"nn3", ",", "3"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Large"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<B:\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", 
             RowBox[{"nodsppd", "[", 
              RowBox[{"[", 
               RowBox[{"nn3", ",", "4"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Large"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Add Concentrated Mass:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"conm", "=", 
      RowBox[{"{", 
       RowBox[{
       "m", ",", "i11", ",", "i22", ",", "i33", ",", "i21", ",", "i31", ",", 
        "i32"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nodcon", "=", 
      RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"conmall", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", 
             RowBox[{"nodcon", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"conm", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"conm", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"conm", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"conm", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"conm", "[", 
                RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"conm", "[", 
                RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"conm", "[", 
                RowBox[{"[", "7", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Add Con.Mass\>\"", ",", 
        RowBox[{"conmall", "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"conmall", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"nodcon", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "conm"}], "}"}]}], 
          "]"}]}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Dynamic", "[", 
       RowBox[{"conmall", "//", "MatrixForm"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"conmdel", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Con.Mass Delete:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "conmdel", "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ArrayQ", "[", 
        RowBox[{"Dynamic", "[", "conmall", "]"}], "]"}], ",", "Null", ",", 
       RowBox[{"Print", "[", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Delete\>\"", ",", 
          RowBox[{"conmall", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"conmall", ",", 
             RowBox[{"{", "conmdel", "}"}]}], "]"}]}]}], "]"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ww", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<DFR Input\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Start Frequency\>\"", ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"ww", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<End Frequency\>\"", ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"ww", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Increasement\>\"", ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{"ww", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Rotor DFR Plot Node Number\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rdfrnode", "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "rdfrnode", "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Small"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<Rpm for 3D Rotor Disp.Plot(Input After RDFR Analysis)\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ww2", "=", 
      RowBox[{"{", "1", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "ww2", "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Small"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Rotor Operation Speed Range(cpm)\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ros", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "ros", "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Small"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Bearing Stiffness Range(Rotor Dynamic Only)\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"bps", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "bps", "]"}], ",", 
            RowBox[{"FieldSize", "\[Rule]", "Small"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Transient Analysis Parameter:\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"dt", "=", "0"}], ";", 
     RowBox[{"in", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Time increment\>\"", ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", "dt", "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Number of time steps\>\"", ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", "in", "]"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<-------------------------------------------------------\>\"", ",", 
        RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
        RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<Final Result is:\>\"", ",", 
        RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
        RowBox[{"FontWeight", "\[Rule]", "Bold"}], ",", 
        RowBox[{"FontSlant", "\[Rule]", "Italic"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656111894516322*^9, 3.656111897549322*^9}, {
   3.6561138926392727`*^9, 3.6561139398982725`*^9}, {3.656113980327273*^9, 
   3.6561139951082726`*^9}, {3.656114042963273*^9, 3.656114051635273*^9}, {
   3.6561221550616646`*^9, 3.6561222419576645`*^9}, {3.656122366854665*^9, 
   3.656122417979665*^9}, {3.6561225479786644`*^9, 3.6561225574086647`*^9}, {
   3.6562960561947107`*^9, 3.6562961860857105`*^9}, {3.65629624466471*^9, 
   3.65629625679471*^9}, {3.6562966473997107`*^9, 3.6562966474517107`*^9}, {
   3.6562966891777105`*^9, 3.6562968908697104`*^9}, {3.6562973778127103`*^9, 
   3.65629740059671*^9}, {3.6562975537917104`*^9, 3.6562976232307105`*^9}, {
   3.6562976715287104`*^9, 3.6562976747487106`*^9}, {3.656298933057307*^9, 
   3.656298956819307*^9}, {3.6562989870393066`*^9, 3.656298988224307*^9}, {
   3.6562993338243065`*^9, 3.656299335464307*^9}, {3.656299927464307*^9, 
   3.656299930463307*^9}, {3.656300059309307*^9, 3.656300067129307*^9}, {
   3.656300226483307*^9, 3.6563002287953067`*^9}, {3.6563003688573065`*^9, 
   3.656300372495307*^9}, {3.6563025630651617`*^9, 3.656302576539509*^9}, {
   3.6563026666245165`*^9, 3.6563026749663506`*^9}, 3.656302740713925*^9, {
   3.656302773120165*^9, 3.6563028025301056`*^9}, {3.6563031471343*^9, 
   3.6563032663983*^9}, {3.6563032978963003`*^9, 3.6563033478782997`*^9}, {
   3.6563036274933*^9, 3.6563036855993*^9}, 3.6563716980720863`*^9, {
   3.6563849082280726`*^9, 3.6563849276360726`*^9}, {3.656384969343073*^9, 
   3.6563849703250723`*^9}, {3.6563850406230726`*^9, 
   3.6563850538490725`*^9}, {3.6563851274400725`*^9, 
   3.6563851445130725`*^9}, {3.6563852725680723`*^9, 3.656385285581073*^9}, {
   3.6566431940041823`*^9, 3.656643236059182*^9}, {3.6566433047891827`*^9, 
   3.6566433085681825`*^9}, {3.656643366941182*^9, 3.6566433976341825`*^9}, {
   3.6566434280571823`*^9, 3.656643443941182*^9}, {3.656643505552182*^9, 
   3.6566435145251827`*^9}, {3.656643591191182*^9, 3.6566435961161823`*^9}, {
   3.6566439397001824`*^9, 3.6566440157061825`*^9}, {3.6566440666301823`*^9, 
   3.6566441178151827`*^9}, {3.6566441480091825`*^9, 3.656644184783182*^9}, {
   3.6566444197001824`*^9, 3.656644423955182*^9}, {3.656645301125307*^9, 
   3.656645301657307*^9}, {3.6566454949783072`*^9, 3.6566454981143074`*^9}, {
   3.6566506636333055`*^9, 3.6566507940473056`*^9}, {3.6566508276973057`*^9, 
   3.6566508827743053`*^9}, {3.6566510277513056`*^9, 
   3.6566510314683056`*^9}, {3.6566511203283052`*^9, 3.656651150096306*^9}, {
   3.6566512490733056`*^9, 3.656651300292306*^9}, {3.6566513307103057`*^9, 
   3.656651379813306*^9}, 3.6566516633573055`*^9, {3.6566517578433056`*^9, 
   3.6566517792153053`*^9}, {3.6566518328763056`*^9, 
   3.6566518903193054`*^9}, {3.6566520209933057`*^9, 3.656652023676306*^9}, {
   3.6569111415338936`*^9, 3.6569112119929824`*^9}, {3.656988587917881*^9, 
   3.6569885926428814`*^9}, {3.656988625476881*^9, 3.656988709820881*^9}, {
   3.656988741770881*^9, 3.656988791895881*^9}, {3.656988926579881*^9, 
   3.6569891082678814`*^9}, {3.656989440287881*^9, 3.656989487431881*^9}, {
   3.657229021359404*^9, 3.657229059385579*^9}, {3.6572299866598177`*^9, 
   3.65723001973698*^9}, {3.6572300585167227`*^9, 3.6572301011297073`*^9}, {
   3.6572301630816402`*^9, 3.6572301653122888`*^9}, {3.6572309103526354`*^9, 
   3.6572309115716352`*^9}, {3.657232228450055*^9, 3.6572323510050545`*^9}, 
   3.65731519504328*^9, {3.657330983084902*^9, 3.657330988113902*^9}, {
   3.6573316547179017`*^9, 3.657331699615902*^9}, {3.657331880846902*^9, 
   3.657331882367902*^9}, {3.657332276249902*^9, 3.657332391141902*^9}, {
   3.657332549856902*^9, 3.6573325663299017`*^9}, {3.657334784056898*^9, 
   3.6573348138388987`*^9}, {3.657334941219898*^9, 3.6573349880328984`*^9}, {
   3.6573358528668985`*^9, 3.657335853252898*^9}, {3.6573376854861827`*^9, 
   3.6573376981307116`*^9}, {3.6573379859820843`*^9, 3.657337988086295*^9}, {
   3.657338943316893*^9, 3.657338945546893*^9}, {3.65750480363666*^9, 
   3.65750481274466*^9}, {3.65750488999866*^9, 3.6575050439316597`*^9}, {
   3.6575843938848715`*^9, 3.6575844933898716`*^9}, {3.6575888105048666`*^9, 
   3.6575888111098666`*^9}, {3.6578402291500287`*^9, 3.657840294828596*^9}, 
   3.6578403714822607`*^9, {3.657840608773212*^9, 3.657840609866212*^9}, {
   3.657844429710322*^9, 3.6578444422825785`*^9}, {3.657848562956049*^9, 
   3.6578485638451376`*^9}, {3.6579223034823017`*^9, 3.657922372070302*^9}, {
   3.657922423321302*^9, 3.657922446911302*^9}, 3.657922481928302*^9, {
   3.6579242568261337`*^9, 3.6579243001561337`*^9}, {3.658094549662284*^9, 
   3.6580946627199187`*^9}, {3.6580946943840847`*^9, 
   3.6580947026819143`*^9}, {3.6587192589836254`*^9, 
   3.6587192701530104`*^9}, {3.659149525493664*^9, 3.6591496706204634`*^9}, {
   3.659149713879264*^9, 3.6591497281220636`*^9}, {3.6591497718956633`*^9, 
   3.6591497775740633`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RDFRInput", "[", "nodspp_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nnn", ",", "sppfa"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nnn", "=", 
      RowBox[{"Length", "[", "nodspp", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"spn", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sppf", "=", 
      RowBox[{"{", "\"\<Input\>\"", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sppfa", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"InputField", "[", 
       RowBox[{"Dynamic", "[", "spn", "]"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Dynamic", "[", 
       RowBox[{"nodspp", "[", 
        RowBox[{"[", 
         RowBox[{"spn", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"InputField", "[", 
       RowBox[{"Dynamic", "[", "sppf", "]"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Add Table to Spring\>\"", ",", 
        RowBox[{"sppfa", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"sppfa", ",", 
           RowBox[{"{", 
            RowBox[{"spn", ",", 
             RowBox[{"Interpolation", "[", "sppf", "]"}]}], "}"}]}], 
          "]"}]}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "sppfa", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6569088258444414`*^9, 3.656908884409441*^9}, {
  3.656908945170441*^9, 3.656908977814441*^9}, {3.656909017829441*^9, 
  3.656909123383441*^9}, {3.656909181217441*^9, 3.656909349862441*^9}, {
  3.656909633919441*^9, 3.656909642210441*^9}, {3.6569097104414415`*^9, 
  3.6569097407004414`*^9}, {3.6569097821014414`*^9, 3.656909824169441*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpaceBeamStiffness", "[", 
   RowBox[{
   "ncoor_", ",", "Em_", ",", "A_", ",", "Iyy_", ",", "Izz_", ",", "ksy_", 
    ",", "ksz_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Kebar", ",", "l", ",", "x0", ",", "y0", ",", "z0", ",", "xm", ",", "ym",
       ",", "zm", ",", "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", 
      "z2", ",", "tzx", ",", "tzy", ",", "tzz", ",", "tyx", ",", "tyy", ",", 
      "tyz", ",", "txx", ",", "txy", ",", "txz", ",", "Te", ",", "Ke", ",", 
      "ll", ",", "lll", ",", "zL", ",", "dx", ",", "dy", ",", "dz", ",", "EA",
       ",", "x21", ",", "y21", ",", "z21", ",", "Gm", ",", "Ip", ",", "dd", 
      ",", "phiy", ",", "phiz"}], "}"}], ",", 
    RowBox[{
     RowBox[{"EA", "=", 
      RowBox[{"A", " ", "Em"}]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}], "}"}], "=", "ncoor"}],
      ";", 
     RowBox[{"Gm", "=", 
      FractionBox["Em", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Nu]"}], ")"}]}]]}], ";", 
     RowBox[{"dd", "=", 
      RowBox[{"2", " ", 
       SqrtBox[
        FractionBox["A", "\[Pi]"]]}]}], ";", 
     RowBox[{"Ip", "=", 
      RowBox[{"Iyy", "+", "Izz"}]}], ";", 
     RowBox[{"ll", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x2", "-", "x1"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"y2", "-", "y1"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"z2", "-", "z1"}], ")"}], "2"]}]}], ";", 
     RowBox[{"l", "=", 
      SqrtBox["ll"]}], ";", 
     RowBox[{"lll", "=", 
      RowBox[{"l", " ", "ll"}]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x21", ",", "y21", ",", "z21"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x2", "-", "x1"}], ",", 
        RowBox[{"y2", "-", "y1"}], ",", 
        RowBox[{"z2", "-", "z1"}]}], "}"}]}], ";", 
     RowBox[{"phiy", "=", 
      FractionBox[
       RowBox[{"12", " ", "Em", " ", "Iyy"}], 
       RowBox[{"Gm", " ", "A", " ", "ksy", " ", "ll"}]]}], ";", 
     RowBox[{"phiz", "=", 
      FractionBox[
       RowBox[{"12", " ", "Em", " ", "Izz"}], 
       RowBox[{"Gm", " ", "A", " ", "ksz", " ", "ll"}]]}], ";", 
     RowBox[{"Kebar", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           FractionBox[
            RowBox[{"Gm", " ", "Ip"}], "l"], ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"Gm", " ", "Ip"}], "l"]}], ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"Gm", " ", "Ip"}], "l"]}], ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", 
           FractionBox[
            RowBox[{"Gm", " ", "Ip"}], "l"], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
        "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{
          SuperscriptBox["l", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"phiy", "+", "1"}], ")"}]}]], 
        RowBox[{"Em", " ", "Iyy", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "12", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "6"}], " ", "l"}], ",", "0", ",", "0", ",", "0", 
             ",", 
             RowBox[{"-", "12"}], ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "6"}], " ", "l"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "6"}], " ", "l"}], ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"phiy", "+", "4"}], ")"}], " ", 
              SuperscriptBox["l", "2"]}], ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"6", " ", "l"}], ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "-", "phiy"}], ")"}], " ", 
              SuperscriptBox["l", "2"]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "12"}], ",", "0", ",", 
             RowBox[{"6", " ", "l"}], ",", "0", ",", "0", ",", "0", ",", "12",
              ",", "0", ",", 
             RowBox[{"6", " ", "l"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "6"}], " ", "l"}], ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "-", "phiy"}], ")"}], " ", 
              SuperscriptBox["l", "2"]}], ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"6", " ", "l"}], ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"phiy", "+", "4"}], ")"}], " ", 
              SuperscriptBox["l", "2"]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
          "}"}]}]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{
          SuperscriptBox["l", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"phiz", "+", "1"}], ")"}]}]], 
        RowBox[{"Em", " ", "Izz", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "12", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"6", " ", "l"}], ",", "0", ",", 
             RowBox[{"-", "12"}], ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"6", " ", "l"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"6", " ", "l"}], ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"phiz", "+", "4"}], ")"}], " ", 
              SuperscriptBox["l", "2"]}], ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "6"}], " ", "l"}], ",", "0", ",", "0", ",", "0", 
             ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "-", "phiz"}], ")"}], " ", 
              SuperscriptBox["l", "2"]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "12"}], ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "6"}], " ", "l"}], ",", "0", ",", "12", ",", "0", 
             ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "6"}], " ", "l"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"6", " ", "l"}], ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "-", "phiz"}], ")"}], " ", 
              SuperscriptBox["l", "2"]}], ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "6"}], " ", "l"}], ",", "0", ",", "0", ",", "0", 
             ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"phiz", "+", "4"}], ")"}], " ", 
              SuperscriptBox["l", "2"]}]}], "}"}]}], "}"}]}]}], "+", 
       RowBox[{
        FractionBox["1", "l"], 
        RowBox[{"EA", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
          "}"}]}]}]}]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x0", ",", "y0", ",", "z0"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xm", ",", "ym", ",", "zm"}], "}"}], "=", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1", "+", "x2"}], ",", 
          RowBox[{"y1", "+", "y2"}], ",", 
          RowBox[{"z1", "+", "z2"}]}], "}"}]}]}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x1", "\[Equal]", "x2"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x0", ",", "y0", ",", "z0"}], "}"}], "+=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x0", ",", "y0", ",", "z0"}], "}"}], "+=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dx", ",", "dy", ",", "dz"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x0", "-", "xm"}], ",", 
        RowBox[{"y0", "-", "ym"}], ",", 
        RowBox[{"z0", "-", "zm"}]}], "}"}]}], ";", 
     RowBox[{"tzx", "=", 
      RowBox[{
       RowBox[{"dz", " ", "y21"}], "-", 
       RowBox[{"dy", " ", "z21"}]}]}], ";", 
     RowBox[{"tzy", "=", 
      RowBox[{
       RowBox[{"dx", " ", "z21"}], "-", 
       RowBox[{"dz", " ", "x21"}]}]}], ";", 
     RowBox[{"tzz", "=", 
      RowBox[{
       RowBox[{"dy", " ", "x21"}], "-", 
       RowBox[{"dx", " ", "y21"}]}]}], ";", 
     RowBox[{"zL", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["tzx", "2"], "+", 
        SuperscriptBox["tzy", "2"], "+", 
        SuperscriptBox["tzz", "2"]}]]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tzx", ",", "tzy", ",", "tzz"}], "}"}], "=", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{"tzx", ",", "tzy", ",", "tzz"}], "}"}], "zL"]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"txx", ",", "txy", ",", "txz"}], "}"}], "=", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{"x21", ",", "y21", ",", "z21"}], "}"}], "l"]}], ";", 
     RowBox[{"tyx", "=", 
      RowBox[{
       RowBox[{"txz", " ", "tzy"}], "-", 
       RowBox[{"txy", " ", "tzz"}]}]}], ";", 
     RowBox[{"tyy", "=", 
      RowBox[{
       RowBox[{"txx", " ", "tzz"}], "-", 
       RowBox[{"txz", " ", "tzx"}]}]}], ";", 
     RowBox[{"tyz", "=", 
      RowBox[{
       RowBox[{"txy", " ", "tzx"}], "-", 
       RowBox[{"txx", " ", "tzy"}]}]}], ";", 
     RowBox[{"Te", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "txx", ",", "txy", ",", "txz", ",", "0", ",", "0", ",", "0", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "tyx", ",", "tyy", ",", "tyz", ",", "0", ",", "0", ",", "0", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "tzx", ",", "tzy", ",", "tzz", ",", "0", ",", "0", ",", "0", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "txx", ",", "txy", ",", "txz", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "tyx", ",", "tyy", ",", "tyz", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "tzx", ",", "tzy", ",", "tzz", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "txx", 
          ",", "txy", ",", "txz", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "tyx", 
          ",", "tyy", ",", "tyz", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "tzx", 
          ",", "tzy", ",", "tzz", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "txx", ",", "txy", ",", "txz"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "tyx", ",", "tyy", ",", "tyz"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "tzx", ",", "tzy", ",", "tzz"}], "}"}]}], 
       "}"}]}], ";", 
     RowBox[{"Ke", "=", 
      RowBox[{
       RowBox[{"Transpose", "[", "Te", "]"}], ".", "Kebar", ".", "Te"}]}], 
     ";", 
     RowBox[{"Return", "[", "Ke", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6543186663870926`*^9, 3.6543186834370923`*^9}, {
   3.6543187219280925`*^9, 3.6543189711090927`*^9}, {3.6543190108910923`*^9, 
   3.6543190424670925`*^9}, {3.6543190789360924`*^9, 
   3.6543190791440926`*^9}, {3.6543191183780923`*^9, 
   3.6543191205380926`*^9}, {3.6543191564650927`*^9, 
   3.6543191830550923`*^9}, {3.6543790882553535`*^9, 
   3.6543790892743535`*^9}, {3.6543793043343534`*^9, 
   3.6543793242813535`*^9}, {3.6543793633943534`*^9, 
   3.6543793677293534`*^9}, {3.6543794262193537`*^9, 
   3.6543794292803535`*^9}, {3.6543803013283534`*^9, 3.6543803117353535`*^9}, 
   3.654380418300353*^9, {3.6543804897853537`*^9, 3.6543805004653535`*^9}, {
   3.6543805393913536`*^9, 3.6543805563283534`*^9}, {3.6543843160943465`*^9, 
   3.6543843286843467`*^9}, {3.654384375700347*^9, 3.654384443273347*^9}, {
   3.654384524483347*^9, 3.6543845305363464`*^9}, {3.6543845670353465`*^9, 
   3.6543847065153465`*^9}, {3.6543847514513464`*^9, 
   3.6543848418033466`*^9}, {3.6543851418073463`*^9, 
   3.6543851671753464`*^9}, {3.654385247334347*^9, 3.6543852502223463`*^9}, 
   3.654385360365347*^9, 3.654385428530347*^9, {3.6543854630873466`*^9, 
   3.6543854939393463`*^9}, {3.6543855484153466`*^9, 
   3.6543856561653466`*^9}, {3.6543857843923464`*^9, 3.654385889669347*^9}, {
   3.6543859311283464`*^9, 3.6543859892513466`*^9}, {3.654386023740347*^9, 
   3.6543860534483466`*^9}, {3.6543861040123463`*^9, 3.6543862846063466`*^9}, 
   3.6543863523743467`*^9, {3.654386776961789*^9, 3.654386777512844*^9}, {
   3.654387083135403*^9, 3.6543871052516146`*^9}, 3.6543871601351023`*^9, {
   3.654387209588047*^9, 3.6543873626463413`*^9}, {3.6543874049410543`*^9, 
   3.654387415735975*^9}, {3.6543874661959286`*^9, 3.6543874712614217`*^9}, 
   3.654387557830764*^9, {3.6543876236711793`*^9, 3.654387628427704*^9}, 
   3.654387667919754*^9, {3.654387738759343*^9, 3.654387747544343*^9}, {
   3.654387789421343*^9, 3.654387804673343*^9}, {3.6543879857033434`*^9, 
   3.6543879963003435`*^9}, {3.654388086806343*^9, 3.654388124383343*^9}, 
   3.6543883842313433`*^9, 3.6543886039223433`*^9, {3.6543886440793433`*^9, 
   3.654388668391343*^9}, 3.65439254719334*^9, 3.65439839644333*^9, 
   3.6544004396513295`*^9, 3.6544006822273293`*^9, 3.6544007800463295`*^9, {
   3.6544022540523295`*^9, 3.6544022899393296`*^9}, {3.6544023230393295`*^9, 
   3.65440233684433*^9}, {3.6544024947463293`*^9, 3.6544025570503297`*^9}, {
   3.6544026838093295`*^9, 3.6544027490443296`*^9}, {3.65440289506833*^9, 
   3.6544028954353294`*^9}, {3.6544029340383296`*^9, 3.6544029677223296`*^9}, 
   3.6544030060593295`*^9, {3.6544030465813293`*^9, 3.6544030469603295`*^9}, 
   3.6544039020660105`*^9, {3.654404069469033*^9, 3.654404070732746*^9}, 
   3.6544042491246824`*^9, {3.6544047707212863`*^9, 3.6544048414360867`*^9}, {
   3.6544049403400865`*^9, 3.6544049494972863`*^9}, 3.654405002412486*^9, {
   3.6544053088994865`*^9, 3.6544053510974865`*^9}, {3.654464121017293*^9, 
   3.654464134056241*^9}, 3.65446963409779*^9, 3.65446970443079*^9, 
   3.65447014457379*^9, 3.6544835114247694`*^9, 3.6544836030677695`*^9, {
   3.6545506080459666`*^9, 3.65455102959161*^9}, {3.65455109839073*^9, 
   3.654551119610607*^9}, 3.6545511517373943`*^9, 3.6545537724444885`*^9, {
   3.654554002092489*^9, 3.6545540132644887`*^9}, {3.6545542853481903`*^9, 
   3.654554296778333*^9}, 3.6545543357272277`*^9, {3.6545545724014874`*^9, 
   3.654554665556487*^9}, 3.6545558560484867`*^9, 3.654559416059315*^9, 
   3.654986428408722*^9, 3.6549864716427217`*^9, 3.654988771184716*^9, 
   3.654990926532715*^9, 3.6550041746316996`*^9, 3.6550043882696996`*^9, 
   3.6550044553976994`*^9, 3.6555167030618763`*^9, {3.6555167414088764`*^9, 
   3.6555168049358764`*^9}, {3.6555168352708764`*^9, 
   3.6555169019818764`*^9}, {3.6555169981588764`*^9, 3.655517016950876*^9}, {
   3.6555273927994227`*^9, 3.6555275425624228`*^9}, 3.655588929671963*^9, {
   3.6555889726138077`*^9, 3.6555889841876717`*^9}, 3.6555890479375153`*^9, 
   3.6555890930787067`*^9, 3.655590554725094*^9, 3.6555907986588507`*^9, {
   3.655592958791147*^9, 3.655593031965118*^9}, 3.6555953527851906`*^9, 
   3.655595631961499*^9, 3.6555978330587535`*^9, {3.655605105499504*^9, 
   3.6556051590681868`*^9}, 3.6556052543295813`*^9, {3.655606252428573*^9, 
   3.655606316963291*^9}, 3.6556064099981456`*^9, 3.6556752204601684`*^9, {
   3.6556755733351684`*^9, 3.6556755835001683`*^9}, 3.6560397992642975`*^9, 
   3.656041321149297*^9, 3.6561102750513244`*^9, 3.656110597336087*^9, 
   3.6566249063033943`*^9, 3.6566251553707266`*^9, 3.656986613391881*^9, 
   3.6569866945528812`*^9, {3.657229150468789*^9, 3.6572291753912144`*^9}, {
   3.658024153253193*^9, 3.658024244354273*^9}, {3.658024287642885*^9, 
   3.658024395201438*^9}, {3.6580244261664453`*^9, 3.6580244668031425`*^9}, 
   3.658024532835826*^9, {3.658025138236461*^9, 3.658025191430756*^9}, {
   3.658025258165417*^9, 3.6580252607549343`*^9}, {3.658025301703622*^9, 
   3.658025307085449*^9}, 3.6580259444674273`*^9, {3.658530001324603*^9, 
   3.6585300053030005`*^9}, 3.658533666791792*^9, {3.658533970105792*^9, 
   3.658533976338792*^9}, {3.658799769725954*^9, 3.658799785934954*^9}, 
   3.65880310025998*^9, 3.6588031316762624`*^9, {3.6590434711337357`*^9, 
   3.6590434729358387`*^9}, {3.6590435035475893`*^9, 3.659043543092851*^9}, {
   3.6597343685461783`*^9, 3.6597343699366474`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeamDifferentialStiffness", "[", 
   RowBox[{
   "ncoor_", ",", "eleaf_", ",", "Em_", ",", "A_", ",", "Iyy_", ",", "ksy_", 
    ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x1", ",", "x2", ",", "y1", ",", "y2", ",", "z1", ",", "z2", ",", "ll", 
      ",", "l", ",", "kdbar", ",", "x0", ",", "y0", ",", "z0", ",", "xm", ",",
       "ym", ",", "zm", ",", "tzx", ",", "tzy", ",", "tzz", ",", "tyx", ",", 
      "tyy", ",", "tyz", ",", "txx", ",", "txy", ",", "txz", ",", "dx", ",", 
      "dy", ",", "dz", ",", "x21", ",", "y21", ",", "z21", ",", "zL", ",", 
      "Te", ",", "Kd", ",", "L", ",", "phi", ",", "Gm"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}], "}"}], "=", "ncoor"}],
      ";", 
     RowBox[{"ll", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x2", "-", "x1"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"y2", "-", "y1"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"z2", "-", "z1"}], ")"}], "2"]}]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x21", ",", "y21", ",", "z21"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x2", "-", "x1"}], ",", 
        RowBox[{"y2", "-", "y1"}], ",", 
        RowBox[{"z2", "-", "z1"}]}], "}"}]}], ";", 
     RowBox[{"l", "=", 
      RowBox[{"L", "=", 
       SqrtBox["ll"]}]}], ";", 
     RowBox[{"Gm", "=", 
      FractionBox["Em", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"\[Nu]", "+", "1"}], ")"}]}]]}], ";", 
     RowBox[{"phi", "=", 
      FractionBox[
       RowBox[{"12", " ", "Em", " ", "Iyy"}], 
       RowBox[{"Gm", " ", "A", " ", "ksy", " ", "ll"}]]}], ";", 
     RowBox[{"kdbar", "=", 
      RowBox[{
       RowBox[{"eleaf", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            FractionBox[
             RowBox[{"5", "+", 
              FractionBox["1", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"phi", "+", "1"}], ")"}], "2"]]}], 
             RowBox[{"5", " ", "L"}]], ",", "0", ",", 
            RowBox[{"-", 
             FractionBox["1", 
              RowBox[{"10", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"phi", "+", "1"}], ")"}], "2"]}]]}], ",", "0", ",", 
            "0", ",", "0", ",", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"5", "+", 
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"phi", "+", "1"}], ")"}], "2"]]}], 
              RowBox[{"5", " ", "L"}]]}], ",", "0", ",", 
            RowBox[{"-", 
             FractionBox["1", 
              RowBox[{"10", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"phi", "+", "1"}], ")"}], "2"]}]]}], ",", "0"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", 
             FractionBox["1", 
              RowBox[{"10", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"phi", "+", "1"}], ")"}], "2"]}]]}], ",", "0", ",", 
            RowBox[{
             FractionBox["1", "60"], " ", "L", " ", 
             RowBox[{"(", 
              RowBox[{"5", "+", 
               FractionBox["3", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"phi", "+", "1"}], ")"}], "2"]]}], ")"}]}], ",", 
            "0", ",", "0", ",", "0", ",", 
            FractionBox["1", 
             RowBox[{"10", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"phi", "+", "1"}], ")"}], "2"]}]], ",", "0", ",", 
            RowBox[{
             FractionBox["1", "60"], " ", "L", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox["3", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"phi", "+", "1"}], ")"}], "2"]], "-", "5"}], 
              ")"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"5", "+", 
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"phi", "+", "1"}], ")"}], "2"]]}], 
              RowBox[{"5", " ", "L"}]]}], ",", "0", ",", 
            FractionBox["1", 
             RowBox[{"10", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"phi", "+", "1"}], ")"}], "2"]}]], ",", "0", ",", "0",
             ",", "0", ",", 
            FractionBox[
             RowBox[{"5", "+", 
              FractionBox["1", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"phi", "+", "1"}], ")"}], "2"]]}], 
             RowBox[{"5", " ", "L"}]], ",", "0", ",", 
            FractionBox["1", 
             RowBox[{"10", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"phi", "+", "1"}], ")"}], "2"]}]], ",", "0"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", 
             FractionBox["1", 
              RowBox[{"10", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"phi", "+", "1"}], ")"}], "2"]}]]}], ",", "0", ",", 
            RowBox[{
             FractionBox["1", "60"], " ", "L", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox["3", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"phi", "+", "1"}], ")"}], "2"]], "-", "5"}], 
              ")"}]}], ",", "0", ",", "0", ",", "0", ",", 
            FractionBox["1", 
             RowBox[{"10", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"phi", "+", "1"}], ")"}], "2"]}]], ",", "0", ",", 
            RowBox[{
             FractionBox["1", "60"], " ", "L", " ", 
             RowBox[{"(", 
              RowBox[{"5", "+", 
               FractionBox["3", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"phi", "+", "1"}], ")"}], "2"]]}], ")"}]}], ",", 
            "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
         "}"}]}], "+", 
       RowBox[{"eleaf", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            FractionBox[
             RowBox[{"5", "+", 
              FractionBox["1", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"phi", "+", "1"}], ")"}], "2"]]}], 
             RowBox[{"5", " ", "L"}]], ",", "0", ",", "0", ",", "0", ",", 
            FractionBox["1", 
             RowBox[{"10", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"phi", "+", "1"}], ")"}], "2"]}]], ",", "0", ",", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"5", "+", 
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"phi", "+", "1"}], ")"}], "2"]]}], 
              RowBox[{"5", " ", "L"}]]}], ",", "0", ",", "0", ",", "0", ",", 
            FractionBox["1", 
             RowBox[{"10", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"phi", "+", "1"}], ")"}], "2"]}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            FractionBox["1", 
             RowBox[{"10", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"phi", "+", "1"}], ")"}], "2"]}]], ",", "0", ",", "0",
             ",", "0", ",", 
            RowBox[{
             FractionBox["1", "60"], " ", "L", " ", 
             RowBox[{"(", 
              RowBox[{"5", "+", 
               FractionBox["3", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"phi", "+", "1"}], ")"}], "2"]]}], ")"}]}], ",", 
            "0", ",", 
            RowBox[{"-", 
             FractionBox["1", 
              RowBox[{"10", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"phi", "+", "1"}], ")"}], "2"]}]]}], ",", "0", ",", 
            "0", ",", "0", ",", 
            RowBox[{
             FractionBox["1", "60"], " ", "L", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox["3", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"phi", "+", "1"}], ")"}], "2"]], "-", "5"}], 
              ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"5", "+", 
               FractionBox["1", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"phi", "+", "1"}], ")"}], "2"]]}], 
              RowBox[{"5", " ", "L"}]]}], ",", "0", ",", "0", ",", "0", ",", 
            RowBox[{"-", 
             FractionBox["1", 
              RowBox[{"10", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"phi", "+", "1"}], ")"}], "2"]}]]}], ",", "0", ",", 
            FractionBox[
             RowBox[{"5", "+", 
              FractionBox["1", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"phi", "+", "1"}], ")"}], "2"]]}], 
             RowBox[{"5", " ", "L"}]], ",", "0", ",", "0", ",", "0", ",", 
            RowBox[{"-", 
             FractionBox["1", 
              RowBox[{"10", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"phi", "+", "1"}], ")"}], "2"]}]]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            FractionBox["1", 
             RowBox[{"10", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"phi", "+", "1"}], ")"}], "2"]}]], ",", "0", ",", "0",
             ",", "0", ",", 
            RowBox[{
             FractionBox["1", "60"], " ", "L", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox["3", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"phi", "+", "1"}], ")"}], "2"]], "-", "5"}], 
              ")"}]}], ",", "0", ",", 
            RowBox[{"-", 
             FractionBox["1", 
              RowBox[{"10", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"phi", "+", "1"}], ")"}], "2"]}]]}], ",", "0", ",", 
            "0", ",", "0", ",", 
            RowBox[{
             FractionBox["1", "60"], " ", "L", " ", 
             RowBox[{"(", 
              RowBox[{"5", "+", 
               FractionBox["3", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"phi", "+", "1"}], ")"}], "2"]]}], ")"}]}]}], 
           "}"}]}], "}"}]}]}]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x0", ",", "y0", ",", "z0"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xm", ",", "ym", ",", "zm"}], "}"}], "=", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1", "+", "x2"}], ",", 
          RowBox[{"y1", "+", "y2"}], ",", 
          RowBox[{"z1", "+", "z2"}]}], "}"}]}]}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x1", "\[Equal]", "x2"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x0", ",", "y0", ",", "z0"}], "}"}], "+=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x0", ",", "y0", ",", "z0"}], "}"}], "+=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dx", ",", "dy", ",", "dz"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x0", "-", "xm"}], ",", 
        RowBox[{"y0", "-", "ym"}], ",", 
        RowBox[{"z0", "-", "zm"}]}], "}"}]}], ";", 
     RowBox[{"tzx", "=", 
      RowBox[{
       RowBox[{"dz", " ", "y21"}], "-", 
       RowBox[{"dy", " ", "z21"}]}]}], ";", 
     RowBox[{"tzy", "=", 
      RowBox[{
       RowBox[{"dx", " ", "z21"}], "-", 
       RowBox[{"dz", " ", "x21"}]}]}], ";", 
     RowBox[{"tzz", "=", 
      RowBox[{
       RowBox[{"dy", " ", "x21"}], "-", 
       RowBox[{"dx", " ", "y21"}]}]}], ";", 
     RowBox[{"zL", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["tzx", "2"], "+", 
        SuperscriptBox["tzy", "2"], "+", 
        SuperscriptBox["tzz", "2"]}]]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tzx", ",", "tzy", ",", "tzz"}], "}"}], "=", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{"tzx", ",", "tzy", ",", "tzz"}], "}"}], "zL"]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"txx", ",", "txy", ",", "txz"}], "}"}], "=", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{"x21", ",", "y21", ",", "z21"}], "}"}], "l"]}], ";", 
     RowBox[{"tyx", "=", 
      RowBox[{
       RowBox[{"txz", " ", "tzy"}], "-", 
       RowBox[{"txy", " ", "tzz"}]}]}], ";", 
     RowBox[{"tyy", "=", 
      RowBox[{
       RowBox[{"txx", " ", "tzz"}], "-", 
       RowBox[{"txz", " ", "tzx"}]}]}], ";", 
     RowBox[{"tyz", "=", 
      RowBox[{
       RowBox[{"txy", " ", "tzx"}], "-", 
       RowBox[{"txx", " ", "tzy"}]}]}], ";", 
     RowBox[{"Te", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "txx", ",", "txy", ",", "txz", ",", "0", ",", "0", ",", "0", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "tyx", ",", "tyy", ",", "tyz", ",", "0", ",", "0", ",", "0", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "tzx", ",", "tzy", ",", "tzz", ",", "0", ",", "0", ",", "0", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "txx", ",", "txy", ",", "txz", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "tyx", ",", "tyy", ",", "tyz", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "tzx", ",", "tzy", ",", "tzz", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "txx", 
          ",", "txy", ",", "txz", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "tyx", 
          ",", "tyy", ",", "tyz", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "tzx", 
          ",", "tzy", ",", "tzz", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "txx", ",", "txy", ",", "txz"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "tyx", ",", "tyy", ",", "tyz"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "tzx", ",", "tzy", ",", "tzz"}], "}"}]}], 
       "}"}]}], ";", 
     RowBox[{"Kd", "=", 
      RowBox[{
       RowBox[{"Transpose", "[", "Te", "]"}], ".", "kdbar", ".", "Te"}]}], 
     ";", 
     RowBox[{"Return", "[", "Kd", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.658806919396758*^9, {3.6588069666014614`*^9, 3.658807278404986*^9}, {
   3.658807320124553*^9, 3.6588073266905117`*^9}, {3.658807373933211*^9, 
   3.65880746396833*^9}, 3.658808118890441*^9, 3.6588081650193453`*^9, 
   3.658809265066409*^9, {3.6588094417364087`*^9, 3.6588094870232086`*^9}, {
   3.658809955054409*^9, 3.658809976754009*^9}, 3.658810009685609*^9, 
   3.658810118043209*^9, 3.6588104606504087`*^9, 3.6588107568944087`*^9, 
   3.6588117703036475`*^9, {3.659043552934414*^9, 3.6590435597018013`*^9}, {
   3.659047424627502*^9, 3.659047434668502*^9}, {3.659048957849931*^9, 
   3.6590489625974054`*^9}, 3.6597445297354774`*^9, 3.6597447421724777`*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Test", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"L", ",", "Em", ",", "A", ",", "Izz", ",", "Iyy"}], "]"}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{"ncoor", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4", ",", "0"}], "}"}]}], "}"}]}], ";", 
    RowBox[{"Em", "=", "100"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"A", "=", "125"}], ";", 
    RowBox[{"Izz", "=", "250"}], ";", 
    RowBox[{"Iyy", "=", "250"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Ke", "=", 
     RowBox[{"SpaceBeamStiffness", "[", 
      RowBox[{
      "ncoor", ",", "Em", ",", "A", ",", "Iyy", ",", "Izz", ",", "1", ",", 
       "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Numerical Elem Stiff Matrix: \>\"", "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"SetPrecision", "[", 
       RowBox[{"Ke", ",", "4"}], "]"}], "//", "MatrixForm"}], "]"}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Eigenvalues of Ke=\>\"", ",", 
      RowBox[{"Chop", "[", 
       RowBox[{"Eigenvalues", "[", "Ke", "]"}], "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Eigenvectors of Ke=\>\"", ",", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"Eigenvectors", "[", "Ke", "]"}], "//", "MatrixForm"}], 
       "]"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6544006017733297`*^9, 3.6544006644273295`*^9}, {
   3.6544007080503297`*^9, 3.6544007400083294`*^9}, {3.65440079016733*^9, 
   3.65440080134933*^9}, {3.6544009062843294`*^9, 3.6544009584253297`*^9}, {
   3.6544009942553296`*^9, 3.6544009943863297`*^9}, {3.6544010788723297`*^9, 
   3.65440115673133*^9}, {3.6544011879263296`*^9, 3.6544011901143293`*^9}, 
   3.6544025821043296`*^9, {3.6544027133063297`*^9, 3.6544027198363295`*^9}, {
   3.6544027848133297`*^9, 3.6544028127893295`*^9}, {3.6544029879143295`*^9, 
   3.6544029880723295`*^9}, {3.65440308376433*^9, 3.6544030874053297`*^9}, {
   3.6544048944760866`*^9, 3.6544048955056863`*^9}, {3.6544051460822864`*^9, 
   3.6544051465814867`*^9}, {3.654405255251086*^9, 3.6544052761862864`*^9}, {
   3.654465074475795*^9, 3.654465077395795*^9}, {3.654465129707795*^9, 
   3.6544652233387947`*^9}, {3.654473248547788*^9, 3.654473250541788*^9}, {
   3.6545557373314867`*^9, 3.654555773829487*^9}, {3.658448753656417*^9, 
   3.658448862224417*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpaceBeamMass", "[", 
   RowBox[{
   "ncoor_", ",", "A_", ",", "des_", ",", "Iyy_", ",", "Izz_", ",", "Em_", 
    ",", "ksy_", ",", "ksz_", ",", "\[Nu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x1", ",", "x2", ",", "y1", ",", "y2", ",", "z1", ",", "z2", ",", "x0", 
      ",", "y0", ",", "z0", ",", "xm", ",", "ym", ",", "zm", ",", "D", ",", 
      "l", ",", "ll", ",", "dx", ",", "dy", ",", "dz", ",", "zL", ",", "txx", 
      ",", "txy", ",", "txz", ",", "tyx", ",", "tyy", ",", "tyz", ",", "tzx", 
      ",", "tzy", ",", "tzz", ",", "x21", ",", "y21", ",", "z21", ",", "Te", 
      ",", "Me", ",", "Mebar", ",", "me", ",", "ip", ",", "dd", ",", "L", ",",
       "iiR", ",", "phiy", ",", "phiz", ",", "Gm"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}], "}"}], "=", "ncoor"}],
      ";", 
     RowBox[{"D", "=", "des"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x21", ",", "y21", ",", "z21"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x2", "-", "x1"}], ",", 
        RowBox[{"y2", "-", "y1"}], ",", 
        RowBox[{"z2", "-", "z1"}]}], "}"}]}], ";", 
     RowBox[{"ll", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x2", "-", "x1"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"y2", "-", "y1"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"z2", "-", "z1"}], ")"}], "2"]}]}], ";", 
     RowBox[{"l", "=", 
      RowBox[{"L", "=", 
       SqrtBox["ll"]}]}], ";", 
     RowBox[{"me", "=", 
      RowBox[{"A", " ", "des", " ", "l"}]}], ";", 
     RowBox[{"Gm", "=", 
      FractionBox["Em", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Nu]"}], ")"}]}]]}], ";", 
     RowBox[{"dd", "=", 
      RowBox[{"2", " ", 
       SqrtBox[
        FractionBox["A", "\[Pi]"]]}]}], ";", 
     RowBox[{"phiy", "=", 
      FractionBox[
       RowBox[{"12", " ", "Em", " ", "Iyy"}], 
       RowBox[{"Gm", " ", "A", " ", "ksy", " ", "ll"}]]}], ";", 
     RowBox[{"phiz", "=", 
      FractionBox[
       RowBox[{"12", " ", "Em", " ", "Izz"}], 
       RowBox[{"Gm", " ", "A", " ", "ksz", " ", "ll"}]]}], ";", 
     RowBox[{"ip", "=", 
      RowBox[{"Iyy", "+", "Izz"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"iiR", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Iyy", "+", "Izz"}], ")"}], "/", "2"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Mebar", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"252", " ", "D", " ", "iiR"}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"78", "+", 
                   RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"21", "+", 
                    RowBox[{"10", " ", "phiz"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"210", " ", "L", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"5", " ", "phiz"}]}], ")"}]}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"44", "+", 
                   RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"11", "+", 
                    RowBox[{"5", " ", "phiz"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "252"}], " ", "D", " ", "iiR"}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"27", "+", 
                   RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"9", "+", 
                    RowBox[{"5", " ", "phiz"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"210", " ", "L", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"5", " ", "phiz"}]}], ")"}]}], "-", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"26", "+", 
                   RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"9", "+", 
                    RowBox[{"5", " ", "phiz"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}]}], "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"252", " ", "D", " ", "iiR"}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"78", "+", 
                   RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"21", "+", 
                    RowBox[{"10", " ", "phiy"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"210", " ", "L", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"5", " ", "phiy"}]}], ")"}]}], "-", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"44", "+", 
                   RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"11", "+", 
                    RowBox[{"5", " ", "phiy"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "252"}], " ", "D", " ", "iiR"}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"27", "+", 
                   RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"9", "+", 
                    RowBox[{"5", " ", "phiy"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"210", " ", "L", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"5", " ", "phiy"}]}], ")"}]}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"26", "+", 
                   RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"9", "+", 
                    RowBox[{"5", " ", "phiy"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"5", " ", "phiy"}]}], ")"}]}], "-", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"44", "+", 
                   RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"11", "+", 
                    RowBox[{"5", " ", "phiy"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"L", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"L", " ", "me", " ", 
                   RowBox[{"(", 
                    RowBox[{"8", "+", 
                    RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "phiy"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"28", " ", "D", " ", "iiR", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "+", 
                    RowBox[{"5", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", "phiy"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"5", " ", "phiy"}]}], ")"}]}], "-", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"26", "+", 
                   RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"9", "+", 
                    RowBox[{"5", " ", "phiy"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"L", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"28", " ", "D", " ", "iiR", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"5", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "phiy"}], ")"}], " ", "phiy"}]}],
                     ")"}]}], "+", 
                    RowBox[{"L", " ", "me", " ", 
                    RowBox[{"(", 
                    RowBox[{"6", "+", 
                    RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "phiy"}], ")"}]}]}], ")"}]}]}], ")"}]}],
                  ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"840", " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], 
               ")"}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"5", " ", "phiz"}]}], ")"}]}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"44", "+", 
                   RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"11", "+", 
                    RowBox[{"5", " ", "phiz"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"L", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"L", " ", "me", " ", 
                   RowBox[{"(", 
                    RowBox[{"8", "+", 
                    RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "phiz"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"28", " ", "D", " ", "iiR", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "+", 
                    RowBox[{"5", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", "phiz"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"5", " ", "phiz"}]}], ")"}]}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"26", "+", 
                   RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"9", "+", 
                    RowBox[{"5", " ", "phiz"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"L", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"28", " ", "D", " ", "iiR", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"5", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "phiz"}], ")"}], " ", "phiz"}]}],
                     ")"}]}], "+", 
                    RowBox[{"L", " ", "me", " ", 
                    RowBox[{"(", 
                    RowBox[{"6", "+", 
                    RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "phiz"}], ")"}]}]}], ")"}]}]}], ")"}]}],
                  ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"840", " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}], 
               ")"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "252"}], " ", "D", " ", "iiR"}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"27", "+", 
                   RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"9", "+", 
                    RowBox[{"5", " ", "phiz"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"210", " ", "L", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"5", " ", "phiz"}]}], ")"}]}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"26", "+", 
                   RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"9", "+", 
                    RowBox[{"5", " ", "phiz"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"252", " ", "D", " ", "iiR"}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"78", "+", 
                   RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"21", "+", 
                    RowBox[{"10", " ", "phiz"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"210", " ", "L", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"5", " ", "phiz"}]}], ")"}]}], "-", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"44", "+", 
                   RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"11", "+", 
                    RowBox[{"5", " ", "phiz"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}]}], "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "252"}], " ", "D", " ", "iiR"}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"27", "+", 
                   RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"9", "+", 
                    RowBox[{"5", " ", "phiy"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"210", " ", "L", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"5", " ", "phiy"}]}], ")"}]}], "-", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"26", "+", 
                   RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"9", "+", 
                    RowBox[{"5", " ", "phiy"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"252", " ", "D", " ", "iiR"}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"78", "+", 
                   RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"21", "+", 
                    RowBox[{"10", " ", "phiy"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"210", " ", "L", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"5", " ", "phiy"}]}], ")"}]}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"44", "+", 
                   RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"11", "+", 
                    RowBox[{"5", " ", "phiy"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"5", " ", "phiy"}]}], ")"}]}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"26", "+", 
                   RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"9", "+", 
                    RowBox[{"5", " ", "phiy"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"L", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"28", " ", "D", " ", "iiR", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"5", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "phiy"}], ")"}], " ", "phiy"}]}],
                     ")"}]}], "+", 
                    RowBox[{"L", " ", "me", " ", 
                    RowBox[{"(", 
                    RowBox[{"6", "+", 
                    RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "phiy"}], ")"}]}]}], ")"}]}]}], ")"}]}],
                  ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"840", " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], 
               ")"}]}], ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"5", " ", "phiy"}]}], ")"}]}], "+", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"44", "+", 
                   RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"11", "+", 
                    RowBox[{"5", " ", "phiy"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"L", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"L", " ", "me", " ", 
                   RowBox[{"(", 
                    RowBox[{"8", "+", 
                    RowBox[{"7", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "phiy"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"28", " ", "D", " ", "iiR", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "+", 
                    RowBox[{"5", " ", "phiy", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", "phiy"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}], "2"]}], ")"}]}], ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"5", " ", "phiz"}]}], ")"}]}], "-", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"26", "+", 
                   RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"9", "+", 
                    RowBox[{"5", " ", "phiz"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"L", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"28", " ", "D", " ", "iiR", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"5", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "phiz"}], ")"}], " ", "phiz"}]}],
                     ")"}]}], "+", 
                    RowBox[{"L", " ", "me", " ", 
                    RowBox[{"(", 
                    RowBox[{"6", "+", 
                    RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "phiz"}], ")"}]}]}], ")"}]}]}], ")"}]}],
                  ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"840", " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}], 
               ")"}]}], ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"84", " ", "D", " ", "iiR", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"5", " ", "phiz"}]}], ")"}]}], "-", 
                RowBox[{"L", " ", "me", " ", 
                 RowBox[{"(", 
                  RowBox[{"44", "+", 
                   RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"11", "+", 
                    RowBox[{"5", " ", "phiz"}]}], ")"}]}]}], ")"}]}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}], ",", 
             "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"L", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"L", " ", "me", " ", 
                   RowBox[{"(", 
                    RowBox[{"8", "+", 
                    RowBox[{"7", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "phiz"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"28", " ", "D", " ", "iiR", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "+", 
                    RowBox[{"5", " ", "phiz", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", "phiz"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"840", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}], "2"]}], ")"}]}]}], 
            "}"}]}], "}"}], "+", 
         RowBox[{
          FractionBox["1", "6"], " ", "A", " ", "D", " ", "l", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", 
              FractionBox[
               RowBox[{"2", " ", "ip"}], "A"], ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", 
              FractionBox["ip", "A"], ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "2", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", 
              FractionBox["ip", "A"], ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", 
              FractionBox[
               RowBox[{"2", " ", "ip"}], "A"], ",", "0", ",", "0"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
              ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
           "}"}]}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Mebar", "=", 
      RowBox[{
       RowBox[{"A", " ", "D", " ", "l", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            FractionBox["13", "35"], ",", "0", ",", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "210"]}], " ", 
             RowBox[{"(", 
              RowBox[{"11", " ", "l"}], ")"}]}], ",", "0", ",", "0", ",", "0",
             ",", 
            FractionBox["9", "70"], ",", "0", ",", 
            FractionBox[
             RowBox[{"13", " ", "l"}], "420"], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "210"]}], " ", 
             RowBox[{"(", 
              RowBox[{"11", " ", "l"}], ")"}]}], ",", "0", ",", 
            FractionBox[
             SuperscriptBox["l", "2"], "105"], ",", "0", ",", "0", ",", "0", 
            ",", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "420"]}], " ", 
             RowBox[{"(", 
              RowBox[{"13", " ", "l"}], ")"}]}], ",", "0", ",", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox["l", "2"], "140"]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            FractionBox["9", "70"], ",", "0", ",", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "420"]}], " ", 
             RowBox[{"(", 
              RowBox[{"13", " ", "l"}], ")"}]}], ",", "0", ",", "0", ",", "0",
             ",", 
            FractionBox["13", "35"], ",", "0", ",", 
            FractionBox[
             RowBox[{"11", " ", "l"}], "210"], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            FractionBox[
             RowBox[{"13", " ", "l"}], "420"], ",", "0", ",", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox["l", "2"], "140"]}], ",", "0", ",", "0", ",", 
            "0", ",", 
            FractionBox[
             RowBox[{"11", " ", "l"}], "210"], ",", "0", ",", 
            FractionBox[
             SuperscriptBox["l", "2"], "105"], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
         "}"}]}], "+", 
       RowBox[{"A", " ", "D", " ", "l", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            FractionBox["13", "35"], ",", "0", ",", "0", ",", "0", ",", 
            FractionBox[
             RowBox[{"11", " ", "l"}], "210"], ",", "0", ",", 
            FractionBox["9", "70"], ",", "0", ",", "0", ",", "0", ",", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "420"]}], " ", 
             RowBox[{"(", 
              RowBox[{"13", " ", "l"}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            FractionBox[
             RowBox[{"11", " ", "l"}], "210"], ",", "0", ",", "0", ",", "0", 
            ",", 
            FractionBox[
             SuperscriptBox["l", "2"], "105"], ",", "0", ",", 
            FractionBox[
             RowBox[{"13", " ", "l"}], "420"], ",", "0", ",", "0", ",", "0", 
            ",", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox["l", "2"], "140"]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            FractionBox["9", "70"], ",", "0", ",", "0", ",", "0", ",", 
            FractionBox[
             RowBox[{"13", " ", "l"}], "420"], ",", "0", ",", 
            FractionBox["13", "35"], ",", "0", ",", "0", ",", "0", ",", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "210"]}], " ", 
             RowBox[{"(", 
              RowBox[{"11", " ", "l"}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "420"]}], " ", 
             RowBox[{"(", 
              RowBox[{"13", " ", "l"}], ")"}]}], ",", "0", ",", "0", ",", "0",
             ",", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox["l", "2"], "140"]}], ",", "0", ",", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "210"]}], " ", 
             RowBox[{"(", 
              RowBox[{"11", " ", "l"}], ")"}]}], ",", "0", ",", "0", ",", "0",
             ",", 
            FractionBox[
             SuperscriptBox["l", "2"], "105"]}], "}"}]}], "}"}]}], "+", 
       RowBox[{
        FractionBox["1", "6"], " ", "A", " ", "D", " ", "l", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", 
            FractionBox[
             RowBox[{"2", " ", "ip"}], "A"], ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", 
            FractionBox["ip", "A"], ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "2", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", 
            FractionBox["ip", "A"], ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", 
            FractionBox[
             RowBox[{"2", " ", "ip"}], "A"], ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
         "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x0", ",", "y0", ",", "z0"}], "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xm", ",", "ym", ",", "zm"}], "}"}], "=", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1", "+", "x2"}], ",", 
          RowBox[{"y1", "+", "y2"}], ",", 
          RowBox[{"z1", "+", "z2"}]}], "}"}]}]}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x1", "\[Equal]", "x2"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x0", ",", "y0", ",", "z0"}], "}"}], "+=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x0", ",", "y0", ",", "z0"}], "}"}], "+=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dx", ",", "dy", ",", "dz"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x0", "-", "xm"}], ",", 
        RowBox[{"y0", "-", "ym"}], ",", 
        RowBox[{"z0", "-", "zm"}]}], "}"}]}], ";", 
     RowBox[{"tzx", "=", 
      RowBox[{
       RowBox[{"dz", " ", "y21"}], "-", 
       RowBox[{"dy", " ", "z21"}]}]}], ";", 
     RowBox[{"tzy", "=", 
      RowBox[{
       RowBox[{"dx", " ", "z21"}], "-", 
       RowBox[{"dz", " ", "x21"}]}]}], ";", 
     RowBox[{"tzz", "=", 
      RowBox[{
       RowBox[{"dy", " ", "x21"}], "-", 
       RowBox[{"dx", " ", "y21"}]}]}], ";", 
     RowBox[{"zL", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["tzx", "2"], "+", 
        SuperscriptBox["tzy", "2"], "+", 
        SuperscriptBox["tzz", "2"]}]]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tzx", ",", "tzy", ",", "tzz"}], "}"}], "=", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{"tzx", ",", "tzy", ",", "tzz"}], "}"}], "zL"]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"txx", ",", "txy", ",", "txz"}], "}"}], "=", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{"x21", ",", "y21", ",", "z21"}], "}"}], "l"]}], ";", 
     RowBox[{"tyx", "=", 
      RowBox[{
       RowBox[{"txz", " ", "tzy"}], "-", 
       RowBox[{"txy", " ", "tzz"}]}]}], ";", 
     RowBox[{"tyy", "=", 
      RowBox[{
       RowBox[{"txx", " ", "tzz"}], "-", 
       RowBox[{"txz", " ", "tzx"}]}]}], ";", 
     RowBox[{"tyz", "=", 
      RowBox[{
       RowBox[{"txy", " ", "tzx"}], "-", 
       RowBox[{"txx", " ", "tzy"}]}]}], ";", 
     RowBox[{"Te", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "txx", ",", "txy", ",", "txz", ",", "0", ",", "0", ",", "0", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "tyx", ",", "tyy", ",", "tyz", ",", "0", ",", "0", ",", "0", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "tzx", ",", "tzy", ",", "tzz", ",", "0", ",", "0", ",", "0", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "txx", ",", "txy", ",", "txz", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "tyx", ",", "tyy", ",", "tyz", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "tzx", ",", "tzy", ",", "tzz", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "txx", 
          ",", "txy", ",", "txz", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "tyx", 
          ",", "tyy", ",", "tyz", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "tzx", 
          ",", "tzy", ",", "tzz", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "txx", ",", "txy", ",", "txz"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "tyx", ",", "tyy", ",", "tyz"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "tzx", ",", "tzy", ",", "tzz"}], "}"}]}], 
       "}"}]}], ";", 
     RowBox[{"Me", "=", 
      RowBox[{
       RowBox[{"Transpose", "[", "Te", "]"}], ".", "Mebar", ".", "Te"}]}], 
     ";", 
     RowBox[{"Return", "[", "Me", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6549864935637217`*^9, 3.6549865361367216`*^9}, {
   3.654986566283722*^9, 3.654986703271722*^9}, {3.6549867518527217`*^9, 
   3.6549868966267214`*^9}, {3.6549882470317163`*^9, 
   3.6549884994907165`*^9}, {3.6549885498877163`*^9, 
   3.6549885606117163`*^9}, {3.6549887439687166`*^9, 
   3.6549887633467164`*^9}, {3.6549888797267165`*^9, 
   3.6549891399657164`*^9}, {3.6549892208937163`*^9, 
   3.6549893183857164`*^9}, {3.6549893594837165`*^9, 
   3.6549895627687163`*^9}, {3.6549896055867167`*^9, 
   3.6549896185417166`*^9}, {3.654989701127716*^9, 3.654989721363716*^9}, {
   3.6549898106807165`*^9, 3.6549898728837166`*^9}, {3.6549903415637164`*^9, 
   3.654990488181964*^9}, {3.6549906666947145`*^9, 3.654990757684715*^9}, {
   3.6549908013307147`*^9, 3.654990815019715*^9}, {3.654990876406715*^9, 
   3.654990902528715*^9}, {3.6549909446217146`*^9, 3.654990970075715*^9}, {
   3.6549910098977146`*^9, 3.6549911565347147`*^9}, {3.654991623427715*^9, 
   3.654991633516715*^9}, 3.6549919739557147`*^9, 3.654992005936715*^9, {
   3.6549920903527145`*^9, 3.6549921166147146`*^9}, {3.6549921741357145`*^9, 
   3.654992174464715*^9}, 3.6550049426338763`*^9, {3.6550050491434355`*^9, 
   3.6550051781463346`*^9}, {3.655005210222542*^9, 3.6550052838909082`*^9}, 
   3.655005327696288*^9, 3.655005896349693*^9, 3.655006702112693*^9, {
   3.655010434490693*^9, 3.6550104451166925`*^9}, 3.655076099068508*^9, {
   3.6550763279665084`*^9, 3.655076329877508*^9}, 3.655076924323594*^9, {
   3.6550771216453247`*^9, 3.655077144260586*^9}, {3.6550773005992184`*^9, 
   3.6550776488025055`*^9}, {3.6550777405785055`*^9, 3.655077750174505*^9}, 
   3.6550777833875055`*^9, 3.655077868503505*^9, 3.6550780152855053`*^9, {
   3.6550780621965055`*^9, 3.6550780661965055`*^9}, {3.6550781460385056`*^9, 
   3.655078237633505*^9}, {3.6550783232505054`*^9, 3.6550784155195055`*^9}, 
   3.655078646850505*^9, 3.6550789342117767`*^9, 3.655093651749412*^9, {
   3.6550958835154123`*^9, 3.655096019243412*^9}, 3.655156352859514*^9, {
   3.6551564862845144`*^9, 3.6551564932565145`*^9}, 3.6551565690825143`*^9, 
   3.6555169419918766`*^9, 3.655527245475423*^9, 3.655527523100423*^9, {
   3.6555882966377344`*^9, 3.655588381831132*^9}, 3.6555889052295837`*^9, 
   3.655589062693413*^9, 3.655589187045291*^9, {3.655590283151569*^9, 
   3.6555903705243683`*^9}, 3.6555904145929556`*^9, 3.655590583100766*^9, 
   3.6555908877473135`*^9, 3.655593056018468*^9, 3.655595368853191*^9, 
   3.655595640042144*^9, 3.655597859827667*^9, 3.6556051776783905`*^9, 
   3.655606436751288*^9, {3.6556065453862057`*^9, 3.655606551657205*^9}, 
   3.6556066583733845`*^9, 3.6556067656667457`*^9, {3.655606878716322*^9, 
   3.6556068833805723`*^9}, 3.6556071606460857`*^9, 3.6556078013909492`*^9, 
   3.655608051910949*^9, {3.6556099260299463`*^9, 3.6556099795779457`*^9}, 
   3.655611530329946*^9, 3.6556756868061686`*^9, 3.65681589464655*^9, 
   3.656816030965757*^9, 3.6580069425597377`*^9, 3.6580084771604767`*^9, 
   3.658525220145006*^9, {3.658526173713009*^9, 3.6585262389600086`*^9}, {
   3.6585262772870083`*^9, 3.6585263274010086`*^9}, {3.6585263661320086`*^9, 
   3.6585263789650087`*^9}, {3.6585264168010087`*^9, 3.6585268664220085`*^9}, 
   3.6585286585010085`*^9, {3.6585287700930085`*^9, 3.6585287844420085`*^9}, {
   3.6585288180780087`*^9, 3.6585288242710085`*^9}, {3.658529719928466*^9, 
   3.658529726727146*^9}, {3.658529907936265*^9, 3.6585299427977505`*^9}, {
   3.658530051383608*^9, 3.6585300543489046`*^9}, 3.6585307053780036`*^9, 
   3.6585315144951167`*^9, 3.658540949917214*^9, {3.658541503474868*^9, 
   3.658541527691868*^9}, 3.6585416160038676`*^9, 3.6585419859450784`*^9, 
   3.658542634564329*^9, 3.658543025309329*^9, {3.6585430648433285`*^9, 
   3.658543071561329*^9}, {3.658544591397027*^9, 3.658544619578027*^9}, 
   3.6585446665790267`*^9, 3.658545031905027*^9, 3.6585451236650267`*^9, {
   3.6585452196270266`*^9, 3.658545236482027*^9}, 3.658545339721027*^9, 
   3.6585454389804525`*^9, {3.6585454871716332`*^9, 3.658545571637186*^9}, {
   3.658546173466028*^9, 3.658546226159028*^9}, {3.6585462652930284`*^9, 
   3.6585463888860283`*^9}, {3.6585464284590282`*^9, 3.658546507527028*^9}, 
   3.6585470977210283`*^9, 3.6585471340620284`*^9, 3.6585477831350284`*^9, 
   3.6585478188980284`*^9, 3.6585479664650283`*^9, 3.6585480472830286`*^9, {
   3.65861150732337*^9, 3.658611539027028*^9}, {3.6586202127314205`*^9, 
   3.6586202445424204`*^9}, {3.6590435700353923`*^9, 3.65904357839587*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"L", ",", "Em", ",", "A", ",", "Izz", ",", "Iyy"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ncoor", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"200", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"Em", "=", "10000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"A", "=", "125"}], ";", 
  RowBox[{"Izz", "=", "250"}], ";", 
  RowBox[{"Iyy", "=", "250"}], ";", 
  RowBox[{"des", "=", "500"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Me", "=", 
   RowBox[{"SpaceBeamMass", "[", 
    RowBox[{
    "ncoor", ",", "A", ",", "des", ",", "Iyy", ",", "Izz", ",", "Em", ",", 
     "1", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Numerical Elem Stiff Matrix: \>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"Me", ",", "10"}], "]"}], "//", "MatrixForm"}], "]"}], 
  ";"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Eigenvalue of Ke=\>\"", ",", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Chop", "[", 
      RowBox[{"Eigenvalues", "[", "Me", "]"}], "]"}], "//", "MatrixForm"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.654991668042715*^9, 3.654991742513715*^9}, {
   3.654991817939715*^9, 3.6549918279897146`*^9}, 3.6549921337417145`*^9, {
   3.654992195811715*^9, 3.6549921961457148`*^9}, {3.6550060384236927`*^9, 
   3.6550060400686927`*^9}, {3.6550779726065054`*^9, 3.655077972720505*^9}, {
   3.655593112876094*^9, 3.6555931162766323`*^9}, {3.6555981860025034`*^9, 
   3.6555982452653837`*^9}, 3.655607238627986*^9, {3.655610096535946*^9, 
   3.655610097615946*^9}, {3.658448867929417*^9, 3.6584488932404175`*^9}, {
   3.6585270040400085`*^9, 3.6585270196840086`*^9}, 3.658541884840969*^9, {
   3.658543689673329*^9, 3.658543719637329*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpaceTrassMasterStiffness", "[", 
   RowBox[{
   "nodcoor_", ",", "elenod_", ",", "Aa_", ",", "elemat_", ",", "elemi_", ",",
     "ksbeam_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"numele", "=", 
       RowBox[{"Length", "[", "elenod", "]"}]}], ",", 
      RowBox[{"numnod", "=", 
       RowBox[{"Length", "[", "nodcoor", "]"}]}], ",", "K", ",", "e", ",", 
      "ni", ",", "nj", ",", "eftab", ",", "Ke", ",", "ncoor", ",", "Em", ",", 
      "A", ",", "Iyy", ",", "Izz", ",", "ksy", ",", "ksz", ",", "\[Nu]"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"K", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"6", "*", "numnod"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", "*", "numnod"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"e", "=", "1"}], ",", 
       RowBox[{"e", "\[LessEqual]", "numele"}], ",", 
       RowBox[{"e", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ni", ",", "nj"}], "}"}], "=", 
         RowBox[{"elenod", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", 
        RowBox[{"eftab", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"6", "*", "ni"}], "-", "5"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "ni"}], "-", "4"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "ni"}], "-", "3"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "ni"}], "-", "2"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "ni"}], "-", "1"}], ",", 
           RowBox[{"6", "*", "ni"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "nj"}], "-", "5"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "nj"}], "-", "4"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "nj"}], "-", "3"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "nj"}], "-", "2"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "nj"}], "-", "1"}], ",", 
           RowBox[{"6", "*", "nj"}]}], "}"}]}], ";", 
        RowBox[{"ncoor", "=", 
         RowBox[{"nodcoor", "[", 
          RowBox[{"[", 
           RowBox[{"elenod", "[", 
            RowBox[{"[", "e", "]"}], "]"}], "]"}], "]"}]}], ";", 
        RowBox[{"Em", "=", 
         RowBox[{"elemat", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", 
        RowBox[{"A", "=", 
         RowBox[{"Aa", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Iyy", ",", "Izz"}], "}"}], "=", 
         RowBox[{"elemi", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ksy", ",", "ksz"}], "}"}], "=", 
         RowBox[{"ksbeam", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Nu]", "=", 
         RowBox[{"nua", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Ke", "=", 
         RowBox[{"SpaceBeamStiffness", "[", 
          RowBox[{
          "ncoor", ",", "Em", ",", "A", ",", "Iyy", ",", "Izz", ",", "ksy", 
           ",", "ksz", ",", "\[Nu]"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"K", "[", 
          RowBox[{"[", 
           RowBox[{"eftab", ",", "eftab"}], "]"}], "]"}], "+=", "Ke"}], 
        ";"}]}], "]"}], ";", 
     RowBox[{"Return", "[", "K", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6543984600603294`*^9, 3.6543986430593295`*^9}, {
   3.6543986833683295`*^9, 3.6543988151543293`*^9}, {3.6543988510593295`*^9, 
   3.65439894489133*^9}, {3.6543989842323294`*^9, 3.6543990464663296`*^9}, 
   3.65439910391733*^9, {3.6543993006303296`*^9, 3.65439951098333*^9}, {
   3.65439954581133*^9, 3.6543995742983294`*^9}, {3.65439976207333*^9, 
   3.6543998495933294`*^9}, {3.65439989806833*^9, 3.6543999309333296`*^9}, 
   3.6543999755383296`*^9, {3.6544002555793295`*^9, 3.6544002570883293`*^9}, {
   3.6544003309863296`*^9, 3.65440033449533*^9}, 3.6544032758203297`*^9, {
   3.654481920604808*^9, 3.654481931591005*^9}, {3.6545511874448233`*^9, 
   3.654551205676*^9}, {3.654551238831684*^9, 3.6545512562859383`*^9}, {
   3.6545513317093954`*^9, 3.654551342693297*^9}, {3.654992289587715*^9, 
   3.654992291061715*^9}, {3.656037178741304*^9, 3.6560371793693037`*^9}, {
   3.65802596934863*^9, 3.658026028018349*^9}, {3.6590435993180676`*^9, 
   3.6590436300468245`*^9}, {3.6590436859040194`*^9, 3.6590436867460675`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpaceTrassMasterDiffStiffness", "[", 
   RowBox[{
   "nodcoor_", ",", "elenod_", ",", "Aa_", ",", "elemat_", ",", "elemi_", ",",
     "ksbeam_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"numele", "=", 
       RowBox[{"Length", "[", "elenod", "]"}]}], ",", 
      RowBox[{"numnod", "=", 
       RowBox[{"Length", "[", "nodcoor", "]"}]}], ",", "Kd", ",", "e", ",", 
      "ni", ",", "nj", ",", "eftab", ",", "eaf", ",", "ncoor", ",", "Em", ",",
       "A", ",", "Kde", ",", "Iyy", ",", "Izz", ",", "ksy", ",", "ksz", ",", 
      "\[Nu]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Kd", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"6", "*", "numnod"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", "*", "numnod"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"e", "=", "1"}], ",", 
       RowBox[{"e", "\[LessEqual]", "numele"}], ",", 
       RowBox[{"e", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ni", ",", "nj"}], "}"}], "=", 
         RowBox[{"elenod", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", 
        RowBox[{"eftab", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"6", "*", "ni"}], "-", "5"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "ni"}], "-", "4"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "ni"}], "-", "3"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "ni"}], "-", "2"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "ni"}], "-", "1"}], ",", 
           RowBox[{"6", "*", "ni"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "nj"}], "-", "5"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "nj"}], "-", "4"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "nj"}], "-", "3"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "nj"}], "-", "2"}], ",", 
           RowBox[{
            RowBox[{"6", "*", "nj"}], "-", "1"}], ",", 
           RowBox[{"6", "*", "nj"}]}], "}"}]}], ";", 
        RowBox[{"ncoor", "=", 
         RowBox[{"nodcoor", "[", 
          RowBox[{"[", 
           RowBox[{"elenod", "[", 
            RowBox[{"[", "e", "]"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Em", "=", 
         RowBox[{"elemat", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", 
        RowBox[{"A", "=", 
         RowBox[{"Aa", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Iyy", ",", "Izz"}], "}"}], "=", 
         RowBox[{"elemi", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ksy", ",", "ksz"}], "}"}], "=", 
         RowBox[{"ksbeam", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eaf", "=", 
         RowBox[{"pafa", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Nu]", "=", 
         RowBox[{"nua", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Kde", "=", 
         RowBox[{"BeamDifferentialStiffness", "[", 
          RowBox[{
          "ncoor", ",", "eaf", ",", "Em", ",", "A", ",", "Iyy", ",", "ksy", 
           ",", "\[Nu]"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"Kd", "[", 
          RowBox[{"[", 
           RowBox[{"eftab", ",", "eftab"}], "]"}], "]"}], "+=", "Kde"}], 
        ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "Kd", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6587946433759613`*^9, 3.658794789788961*^9}, 
   3.6587948770079613`*^9, 3.658794930208961*^9, 3.658799272640954*^9, {
   3.658807530012802*^9, 3.6588075801779003`*^9}, {3.6588080027179856`*^9, 
   3.6588080231850543`*^9}, {3.658808185034017*^9, 3.658808199214326*^9}, 
   3.6588083955702677`*^9, {3.659043641733493*^9, 3.659043705914164*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpaceTrassMasterMass", "[", 
   RowBox[{
   "nodcoor_", ",", " ", "elenod_", ",", " ", "Aa_", ",", " ", "eledes_", ",",
     "elemi_", ",", "elemat_", ",", "ksbeam_"}], "]"}], " ", ":=", " ", "\n", 
  "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"numele", " ", "=", " ", 
       RowBox[{"Length", "[", "elenod", "]"}]}], ",", " ", 
      RowBox[{"numnod", " ", "=", " ", 
       RowBox[{"Length", "[", "nodcoor", "]"}]}], ",", " ", "M", ",", " ", 
      "e", ",", " ", "ni", ",", " ", "nj", ",", " ", "eftab", ",", " ", "\n", 
      "    ", "Ke", ",", " ", "ncoor", ",", " ", "Em", ",", " ", "A", ",", 
      " ", "Iyy", ",", " ", "Izz", ",", "q", ",", "ksy", ",", "ksz", ",", 
      "des", ",", "Me", ",", "\[Nu]"}], "}"}], ",", " ", 
    RowBox[{
     RowBox[{"M", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"{", 
         RowBox[{"6", "*", "numnod"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"6", "*", "numnod"}], "}"}]}], "]"}]}], ";", " ", "\n", 
     "    ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"e", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"e", " ", "<=", " ", "numele"}], ",", " ", 
       RowBox[{"e", "++"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ni", ",", " ", "nj"}], "}"}], " ", "=", " ", 
         RowBox[{"elenod", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", " ", "\n", "      ", 
        RowBox[{"eftab", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"6", "*", "ni"}], " ", "-", " ", "5"}], ",", " ", 
           RowBox[{
            RowBox[{"6", "*", "ni"}], " ", "-", " ", "4"}], ",", " ", 
           RowBox[{
            RowBox[{"6", "*", "ni"}], " ", "-", " ", "3"}], ",", " ", 
           RowBox[{
            RowBox[{"6", "*", "ni"}], " ", "-", " ", "2"}], ",", " ", 
           RowBox[{
            RowBox[{"6", "*", "ni"}], " ", "-", " ", "1"}], ",", " ", 
           RowBox[{"6", "*", "ni"}], ",", " ", 
           RowBox[{
            RowBox[{"6", "*", "nj"}], " ", "-", " ", "5"}], ",", " ", "\n", 
           "        ", 
           RowBox[{
            RowBox[{"6", "*", "nj"}], " ", "-", " ", "4"}], ",", " ", 
           RowBox[{
            RowBox[{"6", "*", "nj"}], " ", "-", " ", "3"}], ",", " ", 
           RowBox[{
            RowBox[{"6", "*", "nj"}], " ", "-", " ", "2"}], ",", " ", 
           RowBox[{
            RowBox[{"6", "*", "nj"}], " ", "-", " ", "1"}], ",", " ", 
           RowBox[{"6", "*", "nj"}]}], "}"}]}], ";", " ", "\n", "      ", 
        RowBox[{"ncoor", " ", "=", " ", 
         RowBox[{"nodcoor", "[", 
          RowBox[{"[", 
           RowBox[{"elenod", "[", 
            RowBox[{"[", "e", "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
        RowBox[{"A", " ", "=", " ", 
         RowBox[{"Aa", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", " ", 
        RowBox[{"des", " ", "=", " ", 
         RowBox[{"eledes", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Iyy", ",", "Izz"}], "}"}], "=", 
         RowBox[{"elemi", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", 
        RowBox[{"Em", "=", 
         RowBox[{"elemat", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ksy", ",", "ksz"}], "}"}], "=", 
         RowBox[{"ksbeam", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Nu]", "=", 
         RowBox[{"nua", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", "\n", "      ", 
        RowBox[{"Me", " ", "=", " ", 
         RowBox[{"SpaceBeamMass", "[", 
          RowBox[{
          "ncoor", ",", " ", "A", ",", " ", "des", ",", "Iyy", ",", "Izz", 
           ",", "Em", ",", "ksy", ",", "ksz", ",", "\[Nu]"}], "]"}]}], ";", 
        " ", 
        RowBox[{
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"eftab", ",", "eftab"}], "]"}], "]"}], " ", "+=", " ", 
         "Me"}], ";"}]}], " ", "]"}], ";", " ", "\n", "    ", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"q", "<=", 
        RowBox[{"6", "*", "numnod"}]}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"M", "[", 
           RowBox[{"[", 
            RowBox[{"q", ",", "q"}], "]"}], "]"}], "==", "0"}], ",", 
         RowBox[{
          RowBox[{"M", "[", 
           RowBox[{"[", 
            RowBox[{"q", ",", "q"}], "]"}], "]"}], "=", "1"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "M", "]"}], ";"}]}], " ", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.654992307523715*^9, 3.654992365283715*^9}, {
   3.654992418177163*^9, 3.6549924773290777`*^9}, 3.6549984801507063`*^9, {
   3.655006887634693*^9, 3.655006976167693*^9}, {3.6550070220366926`*^9, 
   3.6550070594886928`*^9}, {3.6550071429166927`*^9, 
   3.6550071535086927`*^9}, {3.655007207707693*^9, 3.6550072204256926`*^9}, {
   3.655007286641693*^9, 3.655007309612693*^9}, {3.6550073684586926`*^9, 
   3.6550073702276926`*^9}, {3.655007425013693*^9, 3.655007427914693*^9}, {
   3.655590476211094*^9, 3.655590511029401*^9}, {3.656037191114304*^9, 
   3.656037191690304*^9}, {3.6561064454464827`*^9, 3.656106446060483*^9}, {
   3.6585270863090086`*^9, 3.6585271924600086`*^9}, {3.6585281487880087`*^9, 
   3.6585281502820086`*^9}, {3.658543927822319*^9, 3.6585439283803744`*^9}, {
   3.6590436625786853`*^9, 3.6590436788596168`*^9}, {3.659043716366762*^9, 
   3.659043738590033*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"nodcoor", ",", " ", "elemat", ",", " ", "elemi"}], "]"}], ";"}], 
  " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nodcoor", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"100", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"200", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"300", ",", " ", "0", ",", " ", "0"}], "}"}]}], "}"}]}], ";"}],
   " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"elenod", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "2"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"2", ",", " ", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"elemat", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{"100", ",", " ", 
      RowBox[{"{", "3", "}"}]}], "]"}]}], ";", " ", 
   RowBox[{"elemi", " ", "=", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"100", ",", " ", "100"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"200", ",", " ", "200"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"300", ",", " ", "300"}], "}"}]}], "}"}], "*", "100"}]}], 
   ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Aa", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"100", ",", "100", ",", "100"}], "}"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eledes", "=", 
   RowBox[{"{", 
    RowBox[{"100", ",", "100", ",", "100"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ksbeam", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K", " ", "=", " ", 
    RowBox[{"SpaceTrassMasterMass", "[", 
     RowBox[{
     "nodcoor", ",", "elenod", ",", "Aa", ",", "eledes", ",", "elemi", ",", 
      "elemat", ",", "ksbeam"}], "]"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Master Stiffness of Example Truss in 3D:\\n\>\"", ",", " ", "\n", 
     "   ", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"N", "[", "K", "]"}], "]"}]}], "]"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<eigs of K:\>\"", ",", " ", 
     RowBox[{"Chop", "[", 
      RowBox[{"Eigenvalues", "[", 
       RowBox[{"N", "[", "K", "]"}], "]"}], "]"}]}], "]"}], ";"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.655006758042693*^9, 3.655006782381693*^9}, {
  3.6555956007776995`*^9, 3.655595618873351*^9}, {3.6555956607273464`*^9, 
  3.6555956618973236`*^9}, {3.656037238261304*^9, 3.656037243088304*^9}, {
  3.657855813809193*^9, 3.6578558617121935`*^9}, {3.65801075005517*^9, 
  3.65801078604877*^9}, {3.658542015497033*^9, 3.658542052377721*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Test", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"nodcoor", ",", " ", "elemat", ",", " ", "elemi"}], "]"}], ";"}],
    " ", "\n", 
   RowBox[{
    RowBox[{"nodcoor", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"10", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"50", ",", " ", "0", ",", " ", "0"}], "}"}]}], "}"}]}], ";"}],
    " ", "\n", 
   RowBox[{
    RowBox[{"elenod", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"2", ",", " ", "3"}], "}"}]}], "}"}]}], ";"}], " ", "\n", 
   RowBox[{
    RowBox[{"elemat", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"100.", ",", " ", 
       RowBox[{"{", "3", "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"elemi", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"10.", ",", " ", "15."}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"10.", ",", " ", "15."}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"10.", ",", " ", "15."}], "}"}]}], "}"}]}], ";"}], " ", "\n", 
   RowBox[{
    RowBox[{"Aa", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"20.", ",", "20.", ",", "20."}], "}"}]}], ";"}], " ", "\n", 
   RowBox[{
    RowBox[{"K", " ", "=", " ", 
     RowBox[{"SpaceTrassMasterStiffness", "[", 
      RowBox[{
      "nodcoor", ",", " ", "elenod", ",", " ", "Aa", ",", " ", "elemat", ",", 
       " ", "elemi", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"K", " ", "=", 
     RowBox[{"SetPrecision", "[", 
      RowBox[{"K", ",", "80"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"K", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "K", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<Master Stiffness of Example Truss in 3D:\\n\>\"", ",", " ", "\n", 
      "   ", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"N", "[", "K", "]"}], "]"}]}], "]"}], ";"}], " ", "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<eigs of K:\>\"", ",", " ", 
      RowBox[{"Chop", "[", 
       RowBox[{"Eigenvalues", "[", 
        RowBox[{"N", "[", "K", "]"}], "]"}], "]"}]}], "]"}], ";"}], 
   " "}]}]], "Input",
 CellChangeTimes->{{3.65439998019833*^9, 3.6544001419963293`*^9}, {
   3.654403871019225*^9, 3.6544038812069387`*^9}, {3.654404052666325*^9, 
   3.6544040560830317`*^9}, {3.6544052895398865`*^9, 
   3.6544052932370863`*^9}, {3.6544053294134865`*^9, 
   3.6544053344366865`*^9}, {3.654464081222128*^9, 3.654464092796542*^9}, {
   3.6550002234677067`*^9, 3.655000230810706*^9}, 3.6550007964588504`*^9, {
   3.6560372495973043`*^9, 3.656037253018304*^9}, {3.658448920510417*^9, 
   3.658449007614417*^9}, {3.6584524338974104`*^9, 3.65845245908541*^9}, 
   3.6584524896314106`*^9, {3.6584525380504103`*^9, 3.6584525795844107`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PrescDisplacementDOFTags", "[", "nodtag_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "n", ",", 
       RowBox[{"numnod", "=", 
        RowBox[{"Length", "[", "nodtag", "]"}]}], ",", 
       RowBox[{"pdof", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"k", "=", "0"}], ",", "m"}], "}"}], ",", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"n", "=", "1"}], ",", 
        RowBox[{"n", "\[LessEqual]", "numnod"}], ",", 
        RowBox[{"n", "++"}], ",", 
        RowBox[{
         RowBox[{"m", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"nodtag", "[", 
            RowBox[{"[", "n", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "m"}], ",", 
           RowBox[{"j", "++"}], ",", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nodtag", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "j"}], "]"}], "]"}], ">", "0"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"pdof", ",", 
                RowBox[{"k", "+", "j"}]}], "]"}]}], "]"}], ";"}]}], "]"}], 
         ";", 
         RowBox[{"k", "+=", "m"}], ";"}]}], "]"}], ";", 
      RowBox[{"Return", "[", "pdof", "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PrescDisplacementDOFValues", "[", 
    RowBox[{"nodtag_", ",", "nodval_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "n", ",", 
       RowBox[{"numnod", "=", 
        RowBox[{"Length", "[", "nodtag", "]"}]}], ",", 
       RowBox[{"pval", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"k", "=", "0"}], ",", "m"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"n", "=", "1"}], ",", 
        RowBox[{"n", "\[LessEqual]", "numnod"}], ",", 
        RowBox[{"n", "++"}], ",", 
        RowBox[{
         RowBox[{"m", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"nodtag", "[", 
            RowBox[{"[", "n", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "m"}], ",", 
           RowBox[{"j", "++"}], ",", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nodtag", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "j"}], "]"}], "]"}], ">", "0"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"pval", ",", 
                RowBox[{"nodval", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "j"}], "]"}], "]"}]}], "]"}]}], "]"}], 
            ";"}]}], "]"}], ";", 
         RowBox[{"k", "+=", "m"}], ";"}]}], "]"}], ";", 
      RowBox[{"Return", "[", "pval", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.654465909810795*^9, 3.654465909811795*^9}, 
   3.6544787258437777`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Test", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PrescDisplacementDOFTags", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
       "}"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"PrescDisplacementDOFValues", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "20", ",", "20"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.654478105352778*^9, 3.6544782745787783`*^9}, {
  3.654478847735778*^9, 3.654478847875778*^9}, {3.6545516585604887`*^9, 
  3.654551724421489*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ApplyDofToMaster", "[", 
    RowBox[{"nodtag_", ",", "K_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "K", "]"}]}], ",", "pdof", ",", "np", ",", 
       RowBox[{"Kmod", "=", "K"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"pdof", "=", 
       RowBox[{"PrescDisplacementDOFTags", "[", "nodtag", "]"}]}], ";", 
      RowBox[{"np", "=", 
       RowBox[{"Length", "[", "pdof", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", "np"}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{"i", "=", 
          RowBox[{"pdof", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "n"}], ",", 
           RowBox[{"j", "++"}], ",", 
           RowBox[{
            RowBox[{"Kmod", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"Kmod", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", "0"}]}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Kmod", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", "1"}]}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "Kmod", "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyLoad", "[", 
    RowBox[{"nodtag_", ",", "nodval_", ",", "K_", ",", "f_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "K", "]"}]}], ",", "pdof", ",", "pval", ",", 
       "np", ",", "d", ",", "c", ",", 
       RowBox[{"fmod", "=", "f"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"pdof", "=", 
       RowBox[{"PrescDisplacementDOFTags", "[", "nodtag", "]"}]}], ";", 
      RowBox[{"np", "=", 
       RowBox[{"Length", "[", "pdof", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pval", "=", 
       RowBox[{"PrescDisplacementDOFValues", "[", 
        RowBox[{"nodtag", ",", "nodval"}], "]"}]}], ";", 
      RowBox[{"c", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", "np"}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{"i", "=", 
          RowBox[{"pdof", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ";", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", "np"}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{"i", "=", 
          RowBox[{"pdof", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ";", 
         RowBox[{"d", "=", 
          RowBox[{"pval", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fmod", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "d"}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"d", "\[Equal]", "0"}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "n"}], ",", 
           RowBox[{"j", "++"}], ",", 
           RowBox[{
            RowBox[{"fmod", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "-=", 
            RowBox[{
             RowBox[{"K", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
             RowBox[{"c", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", "d"}]}]}], "]"}], ";"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "fmod", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.654465544755795*^9, 3.6544656220627947`*^9}, {
   3.654465941031795*^9, 3.654465970412795*^9}, 3.6544730937027884`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ApplySpringToMaster", "[", 
   RowBox[{"nodspp_", ",", "K_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "nodsp1", ",", "ppd", ",", "spn", ",", "i", ",", "ppdn", ",", "j", ",", 
      "kss", ",", "n", ",", "nsp", ",", "ksp", ",", "kf", ",", "bsp", ",", 
      "bf"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"kf", "=", "K"}], ";", "\[IndentingNewLine]", 
     RowBox[{"nsp", "=", 
      RowBox[{"Length", "[", "nodspp", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "nsp"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nodsp1", "=", 
         RowBox[{"nodspp", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"nodspp", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "5"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ksp", ",", "bsp"}], "}"}], "=", 
         RowBox[{"SpaceSpring", "[", "nodsp1", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kf", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"6", "*", "n"}], "-", "5"}], ",", 
              RowBox[{
               RowBox[{"6", "*", "n"}], "-", "4"}], ",", 
              RowBox[{
               RowBox[{"6", "*", "n"}], "-", "3"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"6", "*", "n"}], "-", "5"}], ",", 
              RowBox[{
               RowBox[{"6", "*", "n"}], "-", "4"}], ",", 
              RowBox[{
               RowBox[{"6", "*", "n"}], "-", "3"}]}], "}"}]}], "]"}], "]"}], "+=",
          "ksp"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "kf", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656112719235941*^9, 3.656113051846198*^9}, {
   3.656113105592572*^9, 3.6561131359746103`*^9}, {3.656113191099122*^9, 
   3.656113192945307*^9}, {3.6561132429563074`*^9, 3.6561132840134125`*^9}, {
   3.656113525786954*^9, 3.6561135307314587`*^9}, 3.656120644853791*^9, {
   3.6561207670410085`*^9, 3.6561207887951837`*^9}, 3.6562979454287105`*^9, {
   3.656297996184637*^9, 3.656298130347052*^9}, {3.656298224294446*^9, 
   3.656298240680084*^9}, {3.65629828073909*^9, 3.6562983024982653`*^9}, {
   3.65629843415443*^9, 3.6562984862526393`*^9}, {3.6562986635713067`*^9, 
   3.656298767378307*^9}, {3.6562991054613066`*^9, 3.656299106307307*^9}, {
   3.656299209481307*^9, 3.656299244543307*^9}, {3.656299311016307*^9, 
   3.6562993151313066`*^9}, {3.656299493853307*^9, 3.656299511885307*^9}, {
   3.6562995509003067`*^9, 3.656299576566307*^9}, {3.656301975365307*^9, 
   3.6563019936233068`*^9}, {3.6563676620051327`*^9, 3.6563676774451327`*^9}, 
   3.656385078961073*^9, {3.6563855891340723`*^9, 3.6563857255690727`*^9}, {
   3.6563857717620726`*^9, 3.6563857899470725`*^9}, 3.6563859306580725`*^9, {
   3.6563859671880727`*^9, 3.6563859697860727`*^9}, {3.6563899475100574`*^9, 
   3.656389949390057*^9}, {3.6566294908099055`*^9, 3.6566294910079255`*^9}, {
   3.6566295328481092`*^9, 3.656629563632187*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ApplySpringToMasterB", "[", 
   RowBox[{"nodspp_", ",", "B_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "nodsp1", ",", "ppd", ",", "spn", ",", "i", ",", "ppdn", ",", "j", ",", 
      "kss", ",", "n", ",", "nsp", ",", "ksp", ",", "kf", ",", "bsp", ",", 
      "bf"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bf", "=", "B"}], ";", "\[IndentingNewLine]", 
     RowBox[{"nsp", "=", 
      RowBox[{"Length", "[", "nodspp", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "nsp"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nodsp1", "=", 
         RowBox[{"nodspp", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"nodspp", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "5"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ksp", ",", "bsp"}], "}"}], "=", 
         RowBox[{"SpaceSpring", "[", "nodsp1", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bf", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"6", "*", "n"}], "-", "5"}], ",", 
              RowBox[{
               RowBox[{"6", "*", "n"}], "-", "4"}], ",", 
              RowBox[{
               RowBox[{"6", "*", "n"}], "-", "3"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"6", "*", "n"}], "-", "5"}], ",", 
              RowBox[{
               RowBox[{"6", "*", "n"}], "-", "4"}], ",", 
              RowBox[{
               RowBox[{"6", "*", "n"}], "-", "3"}]}], "}"}]}], "]"}], "]"}], "+=",
          "bsp"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "bf", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656385742119073*^9, 3.6563857660110726`*^9}, {
  3.6563858077940726`*^9, 3.6563858081050725`*^9}, {3.6566295686566896`*^9, 
  3.656629571383962*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ApplyConMasstoMasterM", "[", 
   RowBox[{"nodmm_", ",", "M_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mm", ",", "ll", ",", "n", ",", "i", ",", "mt", ",", "i11", ",", "i22", 
      ",", "i33", ",", "i21", ",", "i31", ",", "i32"}], "}"}], ",", 
    RowBox[{
     RowBox[{"mm", "=", "M"}], ";", 
     RowBox[{"ll", "=", 
      RowBox[{"Length", "[", "nodmm", "]"}]}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "ll"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"nodmm", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"mt", "=", 
         RowBox[{"nodmm", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{
         RowBox[{"mm", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "5"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "4"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "3"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "2"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "1"}], ",", 
             RowBox[{"6", " ", "n"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "5"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "4"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "3"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "2"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "1"}], ",", 
             RowBox[{"6", " ", "n"}]}], "}"}]}], "\[RightDoubleBracket]"}], "+=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "mt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
             "mt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{
             "mt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{
             "mt", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{"-", 
              RowBox[{
              "mt", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{"-", 
              RowBox[{
              "mt", "\[LeftDoubleBracket]", "6", 
               "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", 
              RowBox[{
              "mt", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{
             "mt", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{"-", 
              RowBox[{
              "mt", "\[LeftDoubleBracket]", "7", 
               "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", 
              RowBox[{
              "mt", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{"-", 
              RowBox[{
              "mt", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{
             "mt", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
            "}"}]}], "}"}]}], ";"}]}], "]"}], ";", 
     RowBox[{"Return", "[", "mm", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6566445159573526`*^9, 3.6566446459827533`*^9}, {
   3.6566447057817106`*^9, 3.6566448522361526`*^9}, {3.6566449116700954`*^9, 
   3.656644920867015*^9}, {3.6566449713580637`*^9, 3.6566451316680927`*^9}, {
   3.656645175295307*^9, 3.656645195868307*^9}, {3.656645228146307*^9, 
   3.656645238903307*^9}, {3.6566462636623073`*^9, 3.6566462637603073`*^9}, {
   3.656647283664307*^9, 3.6566472977983074`*^9}, {3.6566489654633055`*^9, 
   3.6566489788193054`*^9}, {3.6566490466163054`*^9, 3.6566490761773057`*^9}, 
   3.6566491221203055`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Test", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"K", ",", "f", ",", "v1", ",", "v2", ",", "v4"}], "]"}], ";", 
    RowBox[{"Km", "=", 
     RowBox[{"Array", "[", 
      RowBox[{"K", ",", 
       RowBox[{"{", 
        RowBox[{"18", ",", "18"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Master Stiffness: \>\"", ",", 
      RowBox[{"Km", "//", "MatrixForm"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"nodtag", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], "}"}]}], ";", 
    RowBox[{"nodval", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1", ",", "v2", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "v4"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Kmod", "=", 
     RowBox[{"ApplyDofToMaster", "[", 
      RowBox[{"nodtag", ",", "Km"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Modified Master Stiffness:\>\"", ",", 
      RowBox[{"Kmod", "//", "MatrixForm"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"fm", "=", 
     RowBox[{"Array", "[", 
      RowBox[{"f", ",", 
       RowBox[{"{", "18", "}"}]}], "]"}]}], ";", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Master Force Vector:\>\"", ",", "fm"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"fmod", "=", 
     RowBox[{"ApplyLoad", "[", 
      RowBox[{"nodtag", ",", "nodval", ",", "Km", ",", "fm"}], "]"}]}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Modified Force Vector:\>\"", ",", 
      RowBox[{"fmod", "//", "MatrixForm"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.654466265296795*^9, 3.654466356696795*^9}, {
  3.654474453204785*^9, 3.6544744930047846`*^9}, {3.6544745791737847`*^9, 
  3.6544745966487846`*^9}, {3.654479212403778*^9, 3.654479213285778*^9}, {
  3.6545517773364887`*^9, 3.6545518023754888`*^9}, {3.654555000704487*^9, 
  3.654555002874487*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{"Kmod", ",", "fmod"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.654466679913795*^9, 3.654466679914795*^9}, 
   3.654466800461795*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FlatNodePartVector", "[", "nv_", "]"}], ":=", 
   RowBox[{"Flatten", "[", "nv", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NodePartFlatVector", "[", 
    RowBox[{"nfc_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "k", ",", "m", ",", "n", ",", 
       RowBox[{"nv", "=", 
        RowBox[{"{", "}"}]}], ",", "numnod"}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "nfc", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"nv", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{"v", ",", "nfc"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "nfc", "]"}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{"numnod", "=", 
          RowBox[{"Length", "[", "nfc", "]"}]}], ";", 
         RowBox[{"m", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"nv", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "numnod", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"n", "=", "1"}], ",", 
           RowBox[{"n", "\[LessEqual]", "numnod"}], ",", 
           RowBox[{"n", "++"}], ",", 
           RowBox[{
            RowBox[{"k", "=", 
             RowBox[{"nfc", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"nv", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"v", "[", 
                RowBox[{"[", 
                 RowBox[{"m", "+", "i"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"m", "+=", "k"}]}]}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "nv", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.654466807016795*^9, 3.654466807017795*^9}, {
  3.6550009052676554`*^9, 3.655000905382667*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Test", " ", "Data"}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.654467329820795*^9, 3.654467337450147*^9}}],

Cell[BoxData[{
 RowBox[{"pp", "=", 
  RowBox[{"{", 
   RowBox[{
   "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8", 
    ",", "9"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"NodePartFlatVector", "[", 
  RowBox[{"3", ",", "pp"}], "]"}]}], "Input",
 CellChangeTimes->{{3.654467290844795*^9, 3.654467314763795*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpaceBeam2IntForce", "[", 
    RowBox[{
    "ncoor_", ",", "Em_", ",", "A_", ",", "ue_", ",", "ebeam_", ",", "bsp_", 
     ",", "Iyy_", ",", "Izz_", ",", "ksy_", ",", "ksz_", ",", "\[Nu]_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x1", ",", "x2", ",", "y1", ",", "y2", ",", "z1", ",", "z2", ",", "x21",
        ",", "y21", ",", "z21", ",", "EA", ",", "numer", ",", "LL", ",", "pe",
        ",", "x0", ",", "y0", ",", "z0", ",", "xm", ",", "ym", ",", "zm", ",",
        "dx", ",", "dy", ",", "dz", ",", "txx", ",", "txy", ",", "txz", ",", 
       "tyx", ",", "tyy", ",", "tyz", ",", "tzx", ",", "tzy", ",", "tzz", ",",
        "zL", ",", "L", ",", "Te", ",", "B", ",", "ubar", ",", "By", ",", 
       "Bz", ",", "bsy", ",", "bsz", ",", "yb", ",", "zb", ",", "i", ",", "j",
        ",", "beamsn", ",", "sccd", ",", "pep", ",", "Gm", ",", "phiy", ",", 
       "phiz"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}], "}"}], "=", 
       "ncoor"}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x21", ",", "y21", ",", "z21"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x2", "-", "x1"}], ",", 
         RowBox[{"y2", "-", "y1"}], ",", 
         RowBox[{"z2", "-", "z1"}]}], "}"}]}], ";", 
      RowBox[{"pe", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"EA", "=", 
       RowBox[{"A", " ", "Em"}]}], ";", 
      RowBox[{"LL", "=", 
       RowBox[{
        SuperscriptBox["x21", "2"], "+", 
        SuperscriptBox["y21", "2"], "+", 
        SuperscriptBox["z21", "2"]}]}], ";", 
      RowBox[{"L", "=", 
       SqrtBox["LL"]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x0", ",", "y0", ",", "z0"}], "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xm", ",", "ym", ",", "zm"}], "}"}], "=", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1", "+", "x2"}], ",", 
           RowBox[{"y1", "+", "y2"}], ",", 
           RowBox[{"z1", "+", "z2"}]}], "}"}]}]}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"x1", "\[Equal]", "x2"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x0", ",", "y0", ",", "z0"}], "}"}], "+=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x0", ",", "y0", ",", "z0"}], "}"}], "+=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "]"}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dx", ",", "dy", ",", "dz"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x0", "-", "xm"}], ",", 
         RowBox[{"y0", "-", "ym"}], ",", 
         RowBox[{"z0", "-", "zm"}]}], "}"}]}], ";", 
      RowBox[{"tzx", "=", 
       RowBox[{
        RowBox[{"dz", " ", "y21"}], "-", 
        RowBox[{"dy", " ", "z21"}]}]}], ";", 
      RowBox[{"tzy", "=", 
       RowBox[{
        RowBox[{"dx", " ", "z21"}], "-", 
        RowBox[{"dz", " ", "x21"}]}]}], ";", 
      RowBox[{"tzz", "=", 
       RowBox[{
        RowBox[{"dy", " ", "x21"}], "-", 
        RowBox[{"dx", " ", "y21"}]}]}], ";", 
      RowBox[{"zL", "=", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["tzx", "2"], "+", 
         SuperscriptBox["tzy", "2"], "+", 
         SuperscriptBox["tzz", "2"]}]]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tzx", ",", "tzy", ",", "tzz"}], "}"}], "=", 
       FractionBox[
        RowBox[{"{", 
         RowBox[{"tzx", ",", "tzy", ",", "tzz"}], "}"}], "zL"]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"txx", ",", "txy", ",", "txz"}], "}"}], "=", 
       FractionBox[
        RowBox[{"{", 
         RowBox[{"x21", ",", "y21", ",", "z21"}], "}"}], "L"]}], ";", 
      RowBox[{"tyx", "=", 
       RowBox[{
        RowBox[{"txz", " ", "tzy"}], "-", 
        RowBox[{"txy", " ", "tzz"}]}]}], ";", 
      RowBox[{"tyy", "=", 
       RowBox[{
        RowBox[{"txx", " ", "tzz"}], "-", 
        RowBox[{"txz", " ", "tzx"}]}]}], ";", 
      RowBox[{"tyz", "=", 
       RowBox[{
        RowBox[{"txy", " ", "tzx"}], "-", 
        RowBox[{"txx", " ", "tzy"}]}]}], ";", 
      RowBox[{"Te", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "txx", ",", "txy", ",", "txz", ",", "0", ",", "0", ",", "0", ",", 
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "tyx", ",", "tyy", ",", "tyz", ",", "0", ",", "0", ",", "0", ",", 
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "tzx", ",", "tzy", ",", "tzz", ",", "0", ",", "0", ",", "0", ",", 
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "txx", ",", "txy", ",", "txz", ",", 
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "tyx", ",", "tyy", ",", "tyz", ",", 
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "tzx", ",", "tzy", ",", "tzz", ",", 
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "txx", 
           ",", "txy", ",", "txz", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "tyx", 
           ",", "tyy", ",", "tyz", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "tzx", 
           ",", "tzy", ",", "tzz", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "txx", ",", "txy", ",", "txz"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "tyx", ",", "tyy", ",", "tyz"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "tzx", ",", "tzy", ",", "tzz"}], "}"}]}], 
        "}"}]}], ";", 
      RowBox[{"ubar", "=", 
       RowBox[{"Te", ".", "ue"}]}], ";", 
      RowBox[{"beamsn", "=", 
       RowBox[{"Length", "[", "ebeam", "]"}]}], ";", 
      RowBox[{"sccd", "=", 
       RowBox[{"Length", "[", "bsp", "]"}]}], ";", 
      RowBox[{"Gm", "=", 
       FractionBox["Em", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Nu]"}], ")"}]}]]}], ";", 
      RowBox[{"phiy", "=", 
       FractionBox[
        RowBox[{"12", " ", "Em", " ", "Iyy"}], 
        RowBox[{"Gm", " ", "A", " ", "ksy", " ", "LL"}]]}], ";", 
      RowBox[{"phiz", "=", 
       FractionBox[
        RowBox[{"12", " ", "Em", " ", "Izz"}], 
        RowBox[{"Gm", " ", "A", " ", "ksz", " ", "LL"}]]}], ";", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "beamsn"}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{"By", "=", 
          RowBox[{
           FractionBox["1", "LL"], "4", " ", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              FractionBox[
               RowBox[{"6", " ", 
                RowBox[{
                "ebeam", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], 
               RowBox[{"4", "+", 
                RowBox[{"4", " ", "phiz"}]}]], ",", "0", ",", "0", ",", "0", 
              ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"L", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "phiz", "-", 
                    RowBox[{
                    "ebeam", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "phiz"}], ")"}]}], ")"}]}], ")"}]}], 
               "+", 
               FractionBox[
                RowBox[{"L", " ", 
                 RowBox[{
                 "ebeam", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}]}]]}], ",", "0", ",", 
              RowBox[{
               FractionBox[
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", 
                  RowBox[{
                  "ebeam", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}]}], 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}]}]], "-", 
               FractionBox[
                RowBox[{"1", "+", 
                 RowBox[{
                 "ebeam", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}]}]]}], ",", "0", ",", "0", 
              ",", "0", ",", 
              RowBox[{
               FractionBox[
                RowBox[{"L", " ", 
                 RowBox[{
                 "ebeam", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiz"}], ")"}]}]], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"L", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "phiz", "+", 
                    RowBox[{
                    "ebeam", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"4", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "phiz"}], ")"}]}], ")"}]}]}]}], "}"}], 
            "}"}]}]}], ";", 
         RowBox[{"Bz", "=", 
          RowBox[{
           FractionBox["1", "LL"], "4", " ", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              FractionBox[
               RowBox[{"6", " ", 
                RowBox[{
                "ebeam", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], 
               RowBox[{"4", "+", 
                RowBox[{"4", " ", "phiy"}]}]], ",", "0", ",", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"L", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "phiy", "-", 
                    RowBox[{
                    "ebeam", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "phiy"}], ")"}]}], ")"}]}], ")"}]}], 
                 "+", 
                 FractionBox[
                  RowBox[{"L", " ", 
                   RowBox[{
                   "ebeam", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", "phiy"}], ")"}]}]]}], ")"}]}], ",", "0",
               ",", "0", ",", "0", ",", 
              RowBox[{
               FractionBox[
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", 
                  RowBox[{
                  "ebeam", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}]}], 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}]}]], "-", 
               FractionBox[
                RowBox[{"1", "+", 
                 RowBox[{
                 "ebeam", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "phiy"}], ")"}]}]]}], ",", "0", ",", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"L", " ", 
                   RowBox[{
                   "ebeam", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", "phiy"}], ")"}]}]], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"L", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "phiy", "+", 
                    RowBox[{
                    "ebeam", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "phiy"}], ")"}]}], ")"}]}]}], ")"}]}], 
              ",", "0"}], "}"}], "}"}]}]}], ";", 
         RowBox[{"pep", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"paf", "=", 
          RowBox[{
           FractionBox["1", "LL"], 
           RowBox[{"EA", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x21", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "ue", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}],
                  "-", 
                 RowBox[{
                 "ue", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ")"}]}], "+", 
              RowBox[{"y21", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "ue", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}],
                  "-", 
                 RowBox[{
                 "ue", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], ")"}]}], "+", 
              RowBox[{"z21", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "ue", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}],
                  "-", 
                 RowBox[{
                 "ue", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}], ")"}]}]}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "sccd"}], ",", 
           RowBox[{"j", "++"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"yb", ",", "zb"}], "}"}], "=", 
             RowBox[{
             "bsp", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
            ";", 
            RowBox[{"bsy", "=", 
             RowBox[{"Em", " ", "zb", " ", 
              RowBox[{"Bz", ".", "ubar"}]}]}], ";", 
            RowBox[{"bsz", "=", 
             RowBox[{"Em", " ", "yb", " ", 
              RowBox[{"By", ".", "ubar"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"pep", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"pep", ",", 
               RowBox[{"N", "[", 
                RowBox[{
                 RowBox[{
                  FractionBox["1", "LL"], "EA", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"x21", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "ue", "\[LeftDoubleBracket]", "7", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "ue", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], "+", 
                    RowBox[{"y21", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "ue", "\[LeftDoubleBracket]", "8", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "ue", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], "+", 
                    RowBox[{"z21", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "ue", "\[LeftDoubleBracket]", "9", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "ue", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"-", "A"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "bsy", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "bsz", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}], "]"}]}], 
              "]"}]}]}]}], "]"}], ";", 
         RowBox[{"pe", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"pe", ",", "pep"}], "]"}]}]}]}], "]"}], ";", 
      RowBox[{"Return", "[", 
       FractionBox["pe", "A"], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6544688725248423`*^9, 3.654468876964286*^9}, {
   3.6544691328027897`*^9, 3.65446919520579*^9}, {3.65446922803179*^9, 
   3.65446923065879*^9}, {3.6544692950857897`*^9, 3.65446936690279*^9}, {
   3.65446940056179*^9, 3.65446943383279*^9}, 3.65446947306879*^9, {
   3.6544695144537897`*^9, 3.65446952118579*^9}, {3.65447016307279*^9, 
   3.65447023558479*^9}, {3.65447026828579*^9, 3.6544704385786467`*^9}, {
   3.6544704728020687`*^9, 3.6544705811148987`*^9}, 3.6544706138721743`*^9, {
   3.654470678678654*^9, 3.654470760640788*^9}, {3.6544710671487885`*^9, 
   3.654471132451788*^9}, {3.654471360057788*^9, 3.654471462142788*^9}, {
   3.6544721889597883`*^9, 3.6544722685027885`*^9}, 3.6544724093817883`*^9, {
   3.6544725252957883`*^9, 3.6544725544907885`*^9}, {3.6544725872927885`*^9, 
   3.6544726599137883`*^9}, {3.654480374259778*^9, 3.654480376075778*^9}, {
   3.654480419543778*^9, 3.6544804199027777`*^9}, {3.6544804520537777`*^9, 
   3.654480513426778*^9}, {3.654480592942778*^9, 3.654480612635778*^9}, {
   3.654480684333778*^9, 3.654480695024778*^9}, 3.654487502171771*^9, {
   3.6544878829925814`*^9, 3.6544879100619946`*^9}, 3.654487959119804*^9, {
   3.654551844589489*^9, 3.654551873219489*^9}, {3.6545519134844885`*^9, 
   3.654551964660489*^9}, {3.6555212901690297`*^9, 3.6555212901700296`*^9}, {
   3.6555221614170294`*^9, 3.6555223632950296`*^9}, 3.655523683205248*^9, 
   3.6555243663626432`*^9, 3.655524610612423*^9, 3.655526524032423*^9, {
   3.655526570995423*^9, 3.6555266270034227`*^9}, {3.655526682716423*^9, 
   3.655526772121423*^9}, {3.656039575376297*^9, 3.656039585744297*^9}, {
   3.656039623874297*^9, 3.6560396963822975`*^9}, {3.656039904468297*^9, 
   3.656039950427297*^9}, {3.656040025001297*^9, 3.6560400448132973`*^9}, {
   3.656040098151297*^9, 3.656040167553297*^9}, {3.6560404261092973`*^9, 
   3.656040429343297*^9}, {3.6560405884552975`*^9, 3.6560405928772974`*^9}, {
   3.656040794048297*^9, 3.656040947406297*^9}, {3.656041107062297*^9, 
   3.656041125548297*^9}, {3.656973279319057*^9, 3.656973280323057*^9}, {
   3.656973619174539*^9, 3.65697364208183*^9}, {3.656974013748993*^9, 
   3.656974069773595*^9}, {3.656974346923052*^9, 3.6569743982780523`*^9}, {
   3.656974456960052*^9, 3.656974469474052*^9}, {3.656974515213052*^9, 
   3.656974542640052*^9}, {3.6569745734650517`*^9, 3.656974584398052*^9}, {
   3.656974641582052*^9, 3.6569746905280523`*^9}, {3.656974724393052*^9, 
   3.656974855988052*^9}, {3.6569749429360523`*^9, 3.656975040895052*^9}, {
   3.656975202996052*^9, 3.656975312678052*^9}, {3.656975369764052*^9, 
   3.6569754460350523`*^9}, {3.6569754900350523`*^9, 3.656975499838052*^9}, {
   3.656975537163052*^9, 3.656975537915052*^9}, {3.656975576290052*^9, 
   3.6569756081820517`*^9}, {3.656975665933052*^9, 3.656975683531052*^9}, {
   3.656975722560052*^9, 3.656975725222052*^9}, {3.656976684249052*^9, 
   3.656976689119052*^9}, 3.656976723314052*^9, 3.656977086342052*^9, {
   3.656977199118052*^9, 3.656977213605052*^9}, {3.6569773752951727`*^9, 
   3.65697738227087*^9}, {3.6569774452971725`*^9, 3.6569774729679394`*^9}, {
   3.6569776178524265`*^9, 3.6569777234139814`*^9}, {3.6569777572513647`*^9, 
   3.6569777981854577`*^9}, {3.6569778690075393`*^9, 3.6569778754871874`*^9}, 
   3.6569802537336483`*^9, {3.65698638836613*^9, 3.6569864196260033`*^9}, {
   3.656986734625881*^9, 3.656986744224881*^9}, {3.6569868476238813`*^9, 
   3.656986855256881*^9}, {3.6587048480309*^9, 3.6587048885109*^9}, {
   3.6587049517059*^9, 3.6587050340199003`*^9}, {3.6587050797159*^9, 
   3.6587050937229*^9}, {3.6587051462489*^9, 3.6587051463049*^9}, {
   3.6587051942118998`*^9, 3.6587052002299*^9}, {3.6587052473119*^9, 
   3.6587052835259*^9}, {3.6587054368889*^9, 3.6587055809358997`*^9}, {
   3.6587056238089*^9, 3.6587056732199*^9}, {3.6587057106998997`*^9, 
   3.6587058164969*^9}, 3.658713562969846*^9, {3.6587871435339727`*^9, 
   3.658787170918973*^9}, 3.658787258567973*^9, 3.658787315294973*^9, {
   3.6587873796489725`*^9, 3.658787394243973*^9}, {3.659043779396367*^9, 
   3.659043794764246*^9}, {3.659734414305787*^9, 3.6597344158910418`*^9}, {
   3.6597344513030453`*^9, 3.6597344556472616`*^9}, {3.659734873924071*^9, 
   3.659734886476815*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"By", "=", 
     RowBox[{
      FractionBox["1", "L"], 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          FractionBox["1", "L"], 
          RowBox[{"6", " ", 
           RowBox[{"ebeam", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], ",", "0", ",", "0", ",", "0", 
         ",", 
         RowBox[{
          RowBox[{"3", " ", 
           RowBox[{"ebeam", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "-", "1"}], ",", "0", ",", 
         RowBox[{"-", 
          RowBox[{
           FractionBox["1", "L"], 
           RowBox[{"6", " ", 
            RowBox[{"ebeam", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], ",", "0", ",", "0", ",", 
         "0", ",", 
         RowBox[{
          RowBox[{"3", " ", 
           RowBox[{"ebeam", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "+", "1"}]}], "}"}], "}"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Bz", "=", 
     RowBox[{
      FractionBox["1", "L"], 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{
          FractionBox["1", "L"], 
          RowBox[{"6", " ", 
           RowBox[{"ebeam", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], ",", "0", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", 
           RowBox[{"ebeam", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "+", "1"}], ",", "0", ",", "0", 
         ",", "0", ",", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], "L"], "6", " ", 
          RowBox[{"ebeam", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "0", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", 
           RowBox[{"ebeam", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "-", "1"}], ",", "0"}], "}"}], 
       "}"}]}]}], ";"}], "*)"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Test", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Test", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "5", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "8", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30", ",", "9", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"40", ",", "8", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"40", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "5", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"SpaceBeam2IntForce", "[", 
    RowBox[{
     RowBox[{"Test", "[", 
      RowBox[{"[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "8"}], "}"}], "]"}], "]"}], ",", "100", ",", "20", 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "5", ",", "3", ",", "0", ",", "0", ",", 
       RowBox[{"-", "5"}], ",", "4", ",", "2", ",", "0", ",", "0", ",", "0"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "0.8"}], ",", 
       RowBox[{"-", "0.2"}], ",", "0", ",", "0.5", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", 
         RowBox[{"-", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.654474299758785*^9, 3.6544743263017845`*^9}, {
   3.654479899464778*^9, 3.654479995984778*^9}, {3.654480046581778*^9, 
   3.654480051550778*^9}, {3.6544800870607777`*^9, 3.654480092125778*^9}, 
   3.6544801756457777`*^9, 3.654480249467778*^9, 3.654480284259778*^9, {
   3.654486795980771*^9, 3.654486797373771*^9}, {3.6544868479387712`*^9, 
   3.654486853640771*^9}, {3.6544876726187716`*^9, 3.6544877026257715`*^9}, {
   3.654487744831771*^9, 3.654487821594304*^9}, {3.654487859018788*^9, 
   3.654487860526089*^9}, {3.654487942518484*^9, 3.654487943857752*^9}, {
   3.6544881939307632`*^9, 3.6544881951258826`*^9}, {3.654551997506489*^9, 
   3.654552000901489*^9}, {3.654552099311489*^9, 3.654552100965489*^9}, 
   3.6555267978264227`*^9, {3.655526895428423*^9, 3.655526905336423*^9}, {
   3.656040624296297*^9, 3.656040636341297*^9}, {3.656976943552052*^9, 
   3.6569769778040524`*^9}, 3.6569862817547226`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpaceTrussIntForces", "[", 
    RowBox[{
    "nodcoor_", ",", "elenod_", ",", "elemat_", ",", "Aa_", ",", "noddis_", 
     ",", "ebeam_", ",", "bsp_", ",", "ksbeam_", ",", "elemi_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"numnod", "=", 
        RowBox[{"Length", "[", "nodcoor", "]"}]}], ",", 
       RowBox[{"numele", "=", 
        RowBox[{"Length", "[", "elenod", "]"}]}], ",", "e", ",", "ni", ",", 
       "nj", ",", "ncoor", ",", "Em", ",", "A", ",", "options", ",", "ue", 
       ",", "p", ",", "Iyy", ",", "Izz", ",", "ksy", ",", "ksz", ",", 
       "\[Nu]"}], "}"}], ",", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"pafa", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"e", "=", "1"}], ",", 
        RowBox[{"e", "\[LessEqual]", "numele"}], ",", 
        RowBox[{"e", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ni", ",", "nj"}], "}"}], "=", 
          RowBox[{"elenod", "[", 
           RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ncoor", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nodcoor", "[", 
             RowBox[{"[", "ni", "]"}], "]"}], ",", 
            RowBox[{"nodcoor", "[", 
             RowBox[{"[", "nj", "]"}], "]"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ue", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"noddis", "[", 
              RowBox[{"[", "ni", "]"}], "]"}], ",", 
             RowBox[{"noddis", "[", 
              RowBox[{"[", "nj", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Em", "=", 
          RowBox[{"elemat", "[", 
           RowBox[{"[", "e", "]"}], "]"}]}], ";", 
         RowBox[{"A", "=", 
          RowBox[{"Aa", "[", 
           RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Nu]", "=", 
          RowBox[{"nua", "[", 
           RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Iyy", ",", "Izz"}], "}"}], "=", 
          RowBox[{"elemi", "[", 
           RowBox[{"[", "e", "]"}], "]"}]}], ";", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ksy", ",", "ksz"}], "}"}], "=", 
          RowBox[{"ksbeam", "[", 
           RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"p", ",", 
            RowBox[{"SpaceBeam2IntForce", "[", 
             RowBox[{
             "ncoor", ",", "Em", ",", "A", ",", "ue", ",", "ebeam", ",", 
              "bsp", ",", "Iyy", ",", "Izz", ",", "ksy", ",", "ksz", ",", 
              "\[Nu]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pafa", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"pafa", ",", "paf"}], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "p", "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6544709053677883`*^9, 3.6544709144267883`*^9}, {
   3.654471507713788*^9, 3.654471524630788*^9}, {3.6544715927857885`*^9, 
   3.654471609290788*^9}, {3.6544716695237885`*^9, 3.6544716797827883`*^9}, {
   3.654472801588788*^9, 3.654472801855788*^9}, {3.654481409350778*^9, 
   3.6544814459137783`*^9}, {3.6544815268027782`*^9, 3.6544815353147783`*^9}, 
   3.655588428799153*^9, {3.656037317478304*^9, 3.6560373182513037`*^9}, {
   3.6569781426290483`*^9, 3.6569781603510485`*^9}, {3.6569782184240484`*^9, 
   3.6569782302260485`*^9}, {3.6569802373716483`*^9, 
   3.6569802468286486`*^9}, {3.6587058973019*^9, 3.6587059316029*^9}, {
   3.6587062276449003`*^9, 3.6587062436668997`*^9}, {3.6587063124849*^9, 
   3.6587063200779*^9}, {3.6587874249039726`*^9, 3.658787482654973*^9}, {
   3.658787598105973*^9, 3.658787598397973*^9}, {3.6587876691589727`*^9, 
   3.6587876738699727`*^9}, {3.659043812960287*^9, 3.6590438314733458`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Test", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"sqq", "=", 
   RowBox[{
    RowBox[{"SpaceTrussIntForces", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "4", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "20", ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}]}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{"100", ",", "3"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "5", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "0.5"}], ",", "0", ",", "0.5", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", 
          RowBox[{"-", "2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], "]"}], "//", 
    "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.6544809885317783`*^9, 3.654481123430778*^9}, {
  3.654481236740778*^9, 3.6544812672897778`*^9}, {3.654481543859778*^9, 
  3.654481545202778*^9}, {3.654552126236489*^9, 3.6545521342704887`*^9}, {
  3.6560410468132973`*^9, 3.6560410490472975`*^9}, {3.6569782404740486`*^9, 
  3.6569782725240483`*^9}, {3.656978308638048*^9, 3.6569783471910486`*^9}, {
  3.6569784027420483`*^9, 3.656978406468048*^9}, {3.656986136557722*^9, 
  3.6569861377047224`*^9}, {3.6569863188117228`*^9, 3.6569863238797226`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpaceTrussStresses", "[", 
    RowBox[{"Aa_", ",", "elefor_", ",", "elenod_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"numele", "=", 
        RowBox[{"Length", "[", "elenod", "]"}]}], ",", "e", ",", "elesig"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"elesig", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "numele", "}"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"e", "=", "1"}], ",", 
        RowBox[{"e", "\[LessEqual]", "numele"}], ",", 
        RowBox[{"e", "++"}], ",", 
        RowBox[{
         RowBox[{"elesig", "[", 
          RowBox[{"[", "e", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"elefor", "[", 
           RowBox[{"[", "e", "]"}], "]"}], "/", 
          RowBox[{"Aa", "[", 
           RowBox[{"[", "e", "]"}], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "elesig", "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.654471802307788*^9, 3.6544718023087883`*^9}, {
  3.6544718756707883`*^9, 3.6544718820307884`*^9}, {3.654471932324788*^9, 
  3.654471940774788*^9}, {3.654472770748788*^9, 3.654472770932788*^9}, {
  3.6560412579712973`*^9, 3.656041258538297*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Test", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SpaceTrussStresses", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"5", ",", "5", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"171", ",", "146"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "19"}], ",", 
        RowBox[{"-", "19"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"40", ",", "35"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6544817129752903`*^9, 3.65448181844538*^9}, {
  3.6560412382992973`*^9, 3.656041240237297*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpaceTrussSolution", "[", 
    RowBox[{
    "nodcoor_", ",", "elenod_", ",", "elemat_", ",", "Aa_", ",", "nodtag_", 
     ",", "nodval_", ",", "nodsp_", ",", "elemi_", ",", "ebeam_", ",", "bsp_",
      ",", "ksbeam_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "K", ",", "Kmod", ",", "f", ",", "fmod", ",", "u", ",", "noddis", ",", 
       "nodfor", ",", "elefor", ",", "elesig", ",", "He", ",", "nodcoorc", 
       ",", "noddisc", ",", "comb", ",", "Title", ",", "en", ",", "elesigl", 
       ",", "bsp2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"K", "=", 
       RowBox[{"SpaceTrassMasterStiffness", "[", 
        RowBox[{
        "nodcoor", ",", " ", "elenod", ",", " ", "Aa", ",", " ", "elemat", 
         ",", " ", "elemi", ",", "ksbeam"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"K", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{"K", ",", "60"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Kmod", "=", "K"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"VectorQ", "[", "nodsp", "]"}], ",", "Null", ",", 
        RowBox[{"Kmod", "=", 
         RowBox[{"ApplySpringToMaster", "[", 
          RowBox[{"nodsp", ",", "K"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kmod", "=", 
       RowBox[{"ApplyDofToMaster", "[", 
        RowBox[{"nodtag", ",", "Kmod"}], "]"}]}], ";", 
      RowBox[{"Kmod", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{"Kmod", ",", "60"}], "]"}]}], ";", 
      RowBox[{"f", "=", 
       RowBox[{"FlatNodePartVector", "[", "nodval", "]"}]}], ";", 
      RowBox[{"fmod", "=", 
       RowBox[{"ApplyLoad", "[", 
        RowBox[{"nodtag", ",", "nodval", ",", "K", ",", "f"}], "]"}]}], ";", 
      RowBox[{"fmod", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{"fmod", ",", "60"}], "]"}]}], ";", 
      RowBox[{"u", "=", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{"Kmod", ",", "fmod"}], "]"}]}], ";", 
      RowBox[{"u", "=", 
       RowBox[{"Chop", "[", "u", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"He", "=", "0.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{"K", ".", "u"}], ",", 
         FractionBox["1", 
          SuperscriptBox["10.", "8"]]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nodfor", "=", 
       RowBox[{"NodePartFlatVector", "[", 
        RowBox[{"6", ",", "f"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"noddis", "=", 
       RowBox[{"NodePartFlatVector", "[", 
        RowBox[{"6", ",", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"elesig", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"SpaceTrussIntForces", "[", 
         RowBox[{
         "nodcoor", ",", "elenod", ",", "elemat", ",", "Aa", ",", "noddis", 
          ",", "ebeam", ",", "bsp", ",", "ksbeam", ",", "elemi"}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"elesig2", "=", 
         RowBox[{"SpaceTrussStresses", "[", 
          RowBox[{"Aa", ",", "elefor", ",", "elenod"}], "]"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"comb", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"nodcoor", ",", "noddis", ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Title", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Text", "[", "\"\<Node Coordinate\>\"", "]"}], ",", 
         "SpanFromLeft", ",", "SpanFromLeft", ",", 
         RowBox[{"Text", "[", "\"\<Node Displacement\>\"", "]"}], ",", 
         "SpanFromLeft", ",", "SpanFromLeft", ",", "SpanFromLeft", ",", 
         "SpanFromLeft", ",", "SpanFromLeft"}], "}"}]}], ";", 
      RowBox[{"comb", "=", 
       RowBox[{"Prepend", "[", 
        RowBox[{"comb", ",", "Title"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Node Displacement Result:\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"ScientificForm", "[", 
         RowBox[{
          RowBox[{"Grid", "[", 
           RowBox[{"comb", ",", 
            RowBox[{"Frame", "\[Rule]", "All"}], ",", 
            RowBox[{"ItemSize", "\[Rule]", "All"}], ",", 
            RowBox[{"ItemStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"FontSize", "\[Rule]", "8"}], "]"}]}]}], "]"}], ",", 
          "5"}], "]"}], "//", "MatrixForm"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"elesig", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "elesig", "]"}], ",", 
         RowBox[{"Length", "[", "bsp", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"en", "=", 
       RowBox[{"Length", "[", "elenod", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"elesigl", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{"ebeam", "&"}], ",", "en"}], "]"}], "]"}], ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ala", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ff", "[", "x_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x", "\[Equal]", "1"}], ",", "xx", ",", "SpanFromAbove"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"xx", "=", "1"}], ",", 
        RowBox[{"xx", "\[LessEqual]", "en"}], ",", 
        RowBox[{"xx", "++"}], ",", 
        RowBox[{"ala", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"ala", ",", 
           RowBox[{"Array", "[", 
            RowBox[{"ff", ",", 
             RowBox[{"Length", "[", "ebeam", "]"}]}], "]"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ala", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "ala", "]"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"elesig", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"elesigl", ",", "elesig", ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"elesig", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ala", ",", "elesig", ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bsp2", "=", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{"bsp", ",", "\"\<Natural Coord\>\""}], "]"}], ",", 
         "\"\<Element No. \>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"elesig", "=", 
       RowBox[{"Prepend", "[", 
        RowBox[{"elesig", ",", "bsp2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Element Stress Result:\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Grid", "[", 
        RowBox[{"elesig", ",", 
         RowBox[{"Frame", "\[Rule]", "All"}], ",", 
         RowBox[{"ItemSize", "\[Rule]", "All"}], ",", 
         RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6544729214607882`*^9, 3.6544731116887884`*^9}, {
   3.654473151043788*^9, 3.654473175319788*^9}, {3.6544738836843596`*^9, 
   3.6544738906020517`*^9}, {3.654473957142705*^9, 3.6544739639963903`*^9}, 
   3.654474208095785*^9, {3.654482161271355*^9, 3.6544821700322313`*^9}, 
   3.6544826864198647`*^9, {3.6544837868428774`*^9, 3.6544838117483864`*^9}, {
   3.654552200181489*^9, 3.6545522013234887`*^9}, {3.6545581881033154`*^9, 
   3.6545582261013155`*^9}, 3.6545583856573153`*^9, {3.654559181694315*^9, 
   3.654559187974315*^9}, 3.6560380447296114`*^9, {3.656108224234481*^9, 
   3.6561082591104813`*^9}, {3.656113599002631*^9, 3.6561136508254485`*^9}, {
   3.656121557453665*^9, 3.6561215578896646`*^9}, {3.6561234866156645`*^9, 
   3.6561235011186647`*^9}, {3.656127961602402*^9, 3.656128076136134*^9}, {
   3.6563651560754414`*^9, 3.6563652155194964`*^9}, {3.6563652568003683`*^9, 
   3.6563652580952387`*^9}, {3.6563655260241327`*^9, 3.656365532980133*^9}, 
   3.656365593443133*^9, {3.656366155676133*^9, 3.6563661787021327`*^9}, {
   3.656366346211133*^9, 3.656366443378133*^9}, {3.6563664762101326`*^9, 
   3.656366490188133*^9}, {3.6563665315771327`*^9, 3.656366550209133*^9}, {
   3.656366699509133*^9, 3.6563667042221327`*^9}, {3.6563667866581326`*^9, 
   3.6563667942101326`*^9}, {3.6563906261800575`*^9, 
   3.6563906623280573`*^9}, {3.6563919597486963`*^9, 
   3.6563919680321903`*^9}, {3.656627504642728*^9, 3.656627512867728*^9}, {
   3.65662992989681*^9, 3.6566299731607213`*^9}, {3.6566316837967215`*^9, 
   3.6566316912727213`*^9}, 3.6566320332987213`*^9, {3.6566321874687214`*^9, 
   3.656632187653721*^9}, {3.656632333387721*^9, 3.656632362985721*^9}, {
   3.656632532104721*^9, 3.656632547184721*^9}, {3.6566327032927213`*^9, 
   3.656632758795721*^9}, {3.656633019705721*^9, 3.6566330538367214`*^9}, {
   3.656633209627186*^9, 3.656633211077331*^9}, {3.65663359124072*^9, 
   3.65663361726672*^9}, {3.6566337298347197`*^9, 3.65663375282572*^9}, {
   3.6566338565207195`*^9, 3.65663387120572*^9}, {3.656634245747841*^9, 
   3.6566342535136175`*^9}, {3.656634564549718*^9, 3.656634579482718*^9}, {
   3.6569794429026484`*^9, 3.6569795481726484`*^9}, {3.6569795822506485`*^9, 
   3.656979586999648*^9}, {3.6569796298646483`*^9, 3.6569798141386485`*^9}, {
   3.6569798469616485`*^9, 3.6569799197156487`*^9}, {3.656979975886648*^9, 
   3.6569800077406483`*^9}, {3.6569800451636486`*^9, 
   3.6569800615906487`*^9}, {3.6569801971266484`*^9, 
   3.6569802014156485`*^9}, {3.6569802805026484`*^9, 
   3.6569802954026484`*^9}, {3.656980544657648*^9, 3.6569805496286483`*^9}, {
   3.6569806739326487`*^9, 3.6569806769886484`*^9}, {3.6569838353376417`*^9, 
   3.6569838469906416`*^9}, {3.6569839112206416`*^9, 
   3.6569839137206416`*^9}, {3.656983962097642*^9, 3.6569839688056417`*^9}, {
   3.656984003783642*^9, 3.6569840251946416`*^9}, {3.6569840563076415`*^9, 
   3.656984075448642*^9}, {3.6569841175916414`*^9, 3.6569841304356413`*^9}, {
   3.6569847924991274`*^9, 3.6569848797148485`*^9}, {3.6569849571067224`*^9, 
   3.6569849607657223`*^9}, {3.656985039411722*^9, 3.6569851075807223`*^9}, {
   3.6569851401637225`*^9, 3.6569852038347225`*^9}, {3.6569852992407227`*^9, 
   3.6569853160607224`*^9}, {3.656985519550722*^9, 3.6569855341647224`*^9}, {
   3.6569855682877226`*^9, 3.656985584491722*^9}, {3.6569857943687224`*^9, 
   3.656985840314722*^9}, {3.6569860062897224`*^9, 3.6569860092597227`*^9}, {
   3.656988045166881*^9, 3.6569880500908813`*^9}, {3.656988414671881*^9, 
   3.6569884299568815`*^9}, {3.656988499912881*^9, 3.656988510344881*^9}, {
   3.658026101772785*^9, 3.658026117824671*^9}, {3.6585331944977922`*^9, 
   3.658533239718792*^9}, {3.658534647303792*^9, 3.658534681659792*^9}, {
   3.6587062596959*^9, 3.6587062611169*^9}, {3.6587063435739*^9, 
   3.6587063446008997`*^9}, {3.6587220200572877`*^9, 3.658722046061988*^9}, 
   3.6587859208189764`*^9, 3.6587861554649763`*^9, {3.659149390023264*^9, 
   3.6591493918952637`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Test", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"nodcoor", ",", " ", "elemat", ",", " ", "elemi"}], "]"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nodcoor", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"200", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"300", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"elenod", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numele", "=", 
     RowBox[{"Length", "[", "elenod", "]"}]}], ";", 
    RowBox[{"elemat", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"210000", ",", 
       RowBox[{"{", "numele", "}"}]}], "]"}]}], ";", 
    RowBox[{"numnod", "=", 
     RowBox[{"Length", "[", "nodcoor", "]"}]}], ";", 
    RowBox[{"Aa", "=", 
     RowBox[{"{", 
      RowBox[{"6280.3", ",", "6280.3", ",", "6280.3"}], "}"}]}], ";", 
    RowBox[{"nodtag", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", "numnod", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nodval", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", "numnod", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"elemi", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"7854000", ",", "7854000"}], "}"}], ",", "numele"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nodval", "[", 
      RowBox[{"[", "4", "]"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"100", ",", "0", ",", 
       RowBox[{"-", "100"}], ",", "0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nodtag", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ebeam", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "0.5"}], ",", "0", ",", "0.5", ",", "1"}], "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bsp", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", 
         RowBox[{"-", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nodsp", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "10"}], "}"}], ",", "100", ",", "0", 
         ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"300", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"300", ",", "0", ",", "10"}], "}"}], ",", "100", ",", "0", 
         ",", "4"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"SpaceTrussSolution", "[", 
    RowBox[{
    "nodcoor", ",", "elenod", ",", "elemat", ",", "Aa", ",", "nodtag", ",", 
     "nodval", ",", "nodsp", ",", "elemi", ",", "ebeam", ",", "bsp"}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"K", "=", 
      RowBox[{"SpaceTrassMasterStiffness", "[", 
       RowBox[{
       "nodcoor", ",", " ", "elenod", ",", " ", "Aa", ",", " ", "elemat", ",",
         " ", "elemi"}], "]"}]}], ";", 
     RowBox[{"Kmod", "=", 
      RowBox[{"ApplyDofToMaster", "[", 
       RowBox[{"nodtag", ",", "K"}], "]"}]}], ";", 
     RowBox[{"f", "=", 
      RowBox[{"FlatNodePartVector", "[", "nodval", "]"}]}], ";", 
     RowBox[{"fmod", "=", 
      RowBox[{"ApplyLoad", "[", 
       RowBox[{"nodtag", ",", "nodval", ",", "K", ",", "f"}], "]"}]}], ";", 
     RowBox[{"u", "=", 
      RowBox[{"LinearSolve", "[", 
       RowBox[{"Kmod", ",", "fmod"}], "]"}]}], ";", 
     RowBox[{"u", "=", 
      RowBox[{"Chop", "[", "u", "]"}]}], ";", 
     RowBox[{"f", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"K", ".", "u"}], ",", 
        FractionBox["1", 
         SuperscriptBox["10.", "8"]]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nodfor", "=", 
      RowBox[{"NodePartFlatVector", "[", 
       RowBox[{"6", ",", "f"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"noddis", "=", 
      RowBox[{"NodePartFlatVector", "[", 
       RowBox[{"6", ",", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"elefor", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{"SpaceTrussIntForces", "[", 
        RowBox[{
        "nodcoor", ",", "elenod", ",", "elemat", ",", "Aa", ",", "noddis", 
         ",", "He"}], "]"}], "]"}]}], ";", 
     RowBox[{"elesig", "=", 
      RowBox[{"SpaceTrussStresses", "[", 
       RowBox[{"Aa", ",", "elefor", ",", "elenod"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Node Displacement Result:\>\"", ",", 
       RowBox[{"noddis", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654473692900283*^9, 3.654473751945187*^9}, {
   3.6544738209760895`*^9, 3.6544738477477665`*^9}, {3.6544740857427845`*^9, 
   3.654474240487785*^9}, {3.654482691453368*^9, 3.6544828375959806`*^9}, {
   3.6544828679907694`*^9, 3.6544829235417695`*^9}, {3.6544830407767696`*^9, 
   3.65448306964777*^9}, 3.6544831125147696`*^9, 3.6544831531637697`*^9, {
   3.6544832302227697`*^9, 3.6544832357337694`*^9}, {3.6544834142627697`*^9, 
   3.6544834418027697`*^9}, {3.6544836584197693`*^9, 
   3.6544836855397696`*^9}, {3.6544837453230295`*^9, 
   3.6544837498605757`*^9}, {3.654483824198141*^9, 3.6544838744631147`*^9}, {
   3.654484119643771*^9, 3.654484155689771*^9}, {3.654484336742771*^9, 
   3.6544843449647713`*^9}, {3.654484377515771*^9, 3.6544844641027713`*^9}, {
   3.654484519492771*^9, 3.654484534195771*^9}, {3.654484594034771*^9, 
   3.654484608416771*^9}, {3.654484675055771*^9, 3.654484829394771*^9}, {
   3.6544848620267715`*^9, 3.6544849037997713`*^9}, {3.6544849367147713`*^9, 
   3.6544849517857714`*^9}, {3.6544850870957713`*^9, 
   3.6544850910687714`*^9}, {3.6544851630637712`*^9, 3.654485163409771*^9}, {
   3.654485669350771*^9, 3.6544856873527713`*^9}, {3.6544857292217712`*^9, 
   3.654485827199771*^9}, {3.654485863949771*^9, 3.6544858852387714`*^9}, {
   3.6544859216947713`*^9, 3.6544860056917715`*^9}, {3.654486045456771*^9, 
   3.654486189176771*^9}, {3.654486264919771*^9, 3.6544862741747713`*^9}, {
   3.654486617447771*^9, 3.654486624315771*^9}, {3.654486932050771*^9, 
   3.6544869322997713`*^9}, {3.654487005380771*^9, 3.6544870357507715`*^9}, {
   3.654552220513489*^9, 3.654552233596489*^9}, {3.654552307769489*^9, 
   3.6545523100484886`*^9}, {3.654552607252489*^9, 3.654552683894489*^9}, {
   3.6545532844494886`*^9, 3.654553297650489*^9}, {3.654555056504487*^9, 
   3.654555071270487*^9}, 3.654555229894487*^9, {3.654557545430249*^9, 
   3.654557593102315*^9}, {3.6545577587223153`*^9, 3.654557774406315*^9}, {
   3.654558296517315*^9, 3.654558363699315*^9}, {3.654558402908315*^9, 
   3.6545584031483154`*^9}, {3.654558641496315*^9, 3.6545586532283154`*^9}, {
   3.654558827968315*^9, 3.654558836467315*^9}, {3.6545589234573154`*^9, 
   3.654558923614315*^9}, 3.654896907736184*^9, 3.6550016031677*^9, {
   3.6550017617626996`*^9, 3.6550017656196995`*^9}, {3.6550020723526993`*^9, 
   3.6550021904316998`*^9}, {3.6550023287286997`*^9, 
   3.6550023302416997`*^9}, {3.6550023625687*^9, 3.6550023871686993`*^9}, {
   3.6550025235906997`*^9, 3.6550025536386995`*^9}, {3.6550029439356995`*^9, 
   3.6550029482966995`*^9}, {3.6550035352226996`*^9, 3.6550035368707*^9}, {
   3.6556817048771615`*^9, 3.6556817177031617`*^9}, {3.656037388809304*^9, 
   3.6560373952953043`*^9}, {3.6560380706442027`*^9, 3.656038128635001*^9}, {
   3.656120273536668*^9, 3.656120319600668*^9}, {3.6561203703216677`*^9, 
   3.6561204078020883`*^9}, {3.656120451404448*^9, 3.656120451582466*^9}, {
   3.656120499148222*^9, 3.656120586205927*^9}, {3.656121127611665*^9, 
   3.6561211301546645`*^9}, {3.6569801693146486`*^9, 
   3.6569801860526485`*^9}, {3.6569803200036483`*^9, 3.6569804004846487`*^9}, 
   3.656983810500642*^9, {3.6569875873808813`*^9, 3.656987592289881*^9}, {
   3.6569876830158815`*^9, 3.656987683563881*^9}, {3.656987760442881*^9, 
   3.656987764115881*^9}, {3.6580067490294514`*^9, 3.658006751006056*^9}, {
   3.658006794708314*^9, 3.658006797062843*^9}, {3.6580123787884116`*^9, 
   3.6580124507200117`*^9}, {3.6580126962294116`*^9, 3.658012698179412*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Dynamic", " ", "Test"}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.654992585407884*^9, 3.6549926137397175`*^9}, {
  3.6556816539061613`*^9, 3.655681658872162*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpaceTrussMode", "[", 
    RowBox[{
    "nodcoor_", ",", "Aa_", ",", "elenod_", ",", "eledes_", ",", "elemat_", 
     ",", "elemi_", ",", "nodtag_", ",", "nodsp_", ",", "nodconm_", ",", 
     "ksbeam_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mm", ",", "kk", ",", "al", ",", "kmod", ",", "ww", ",", "ei1", ",", 
       "ei2", ",", "\[Lambda]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mm", "=", 
       RowBox[{"SpaceTrassMasterMass", "[", 
        RowBox[{
        "nodcoor", ",", "elenod", ",", "Aa", ",", "eledes", ",", "elemi", ",",
          "elemat", ",", "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mm", "=", 
       RowBox[{"ApplyConMasstoMasterM", "[", 
        RowBox[{"nodconm", ",", "mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kk", "=", 
       RowBox[{"SpaceTrassMasterStiffness", "[", 
        RowBox[{
        "nodcoor", ",", "elenod", ",", "Aa", ",", "elemat", ",", "elemi", ",",
          "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"al", "=", 
       RowBox[{
        RowBox[{"Inverse", "[", "mm", "]"}], ".", "kk"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "6"}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", "24"}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{
             RowBox[{"al", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "0"}]}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "6"}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", "24"}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{
             RowBox[{"al", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", "0"}]}], "]"}]}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"al", "//", "MatrixForm"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ww", "=", 
         RowBox[{"Re", "[", 
          RowBox[{"Chop", "[", 
           RowBox[{"Eigenvalues", "[", "al", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ww", "=", 
         RowBox[{"Sort", "[", "ww", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Free Eigenvalue:\>\"", ",", 
          RowBox[{
           RowBox[{"SlideView", "[", 
            RowBox[{"ww", ",", 
             RowBox[{"AppearanceElements", "\[Rule]", 
              RowBox[{"{", " ", 
               RowBox[{
               "\"\<FirstSlide\>\"", ",", " ", "\"\<PreviousSlide\>\"", ",", 
                " ", "\"\<NextSlide\>\"", ",", " ", "\"\<LastSlide\>\"", ",", 
                " ", "\"\<SlideNumber\>\"", ",", " ", "\"\<SlideTotal\>\""}], 
               "}"}]}]}], "]"}], "//", "ScientificForm"}]}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"VectorQ", "[", "nodsp", "]"}], ",", "Null", ",", 
        RowBox[{"kk", "=", 
         RowBox[{"ApplySpringToMaster", "[", 
          RowBox[{"nodsp", ",", "kk"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kk", "=", 
       RowBox[{"ApplyDofToMaster", "[", 
        RowBox[{"nodtag", ",", "kk"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mm", "=", 
       RowBox[{"ApplyDofToMaster", "[", 
        RowBox[{"nodtag", ",", "mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"al", "=", 
       RowBox[{
        RowBox[{"Inverse", "[", "mm", "]"}], ".", "kk"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ei2", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"Chop", "[", 
         RowBox[{"Eigenvalues", "[", "al", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rpmode", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"Chop", "[", 
         RowBox[{"Eigensystem", "[", "al", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ei2", "=", 
       RowBox[{"Re", "[", 
        RowBox[{"Chop", "[", 
         RowBox[{"Eigenvalues", "[", "al", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ei2", "=", 
       RowBox[{"Sort", "[", "ei2", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"saa", "=", 
       RowBox[{"Eigenvalues", "[", "al", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Constrained Eigenvalue:\>\"", ",", 
        RowBox[{
         RowBox[{"SlideView", "[", 
          RowBox[{"ei2", ",", 
           RowBox[{"AppearanceElements", "\[Rule]", 
            RowBox[{"{", " ", 
             RowBox[{
             "\"\<FirstSlide\>\"", ",", " ", "\"\<PreviousSlide\>\"", ",", 
              " ", "\"\<NextSlide\>\"", ",", " ", "\"\<LastSlide\>\"", ",", 
              " ", "\"\<SlideNumber\>\"", ",", " ", "\"\<SlideTotal\>\""}], 
             "}"}]}]}], "]"}], "//", "ScientificForm"}]}], "]"}], ";", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"ei2", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"Re", "[", "#", "]"}], "]"}], ">", "1"}], "&"}], ",", 
          "20"}], "]"}], "//", "MatrixForm"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6549926265770006`*^9, 3.6549926363049736`*^9}, {
   3.654997392079706*^9, 3.6549974494507065`*^9}, {3.6549974883787065`*^9, 
   3.6549976813407063`*^9}, {3.6549977606937065`*^9, 3.6549978704457064`*^9}, 
   3.654997982166706*^9, {3.6549980521047063`*^9, 3.6549980876067066`*^9}, {
   3.654998198817706*^9, 3.6549982152527065`*^9}, {3.6549982477367067`*^9, 
   3.6549982537527065`*^9}, {3.656037501432304*^9, 3.6560376100950103`*^9}, {
   3.6561136667188587`*^9, 3.656113698248706*^9}, {3.656123370432665*^9, 
   3.6561233714926643`*^9}, {3.6561234171576643`*^9, 3.656123424109665*^9}, {
   3.656123463064665*^9, 3.6561234682776647`*^9}, {3.6561249156077023`*^9, 
   3.656124925575783*^9}, {3.6561258992048025`*^9, 3.6561259154286985`*^9}, {
   3.6561259690767546`*^9, 3.6561259715103393`*^9}, {3.656368151928133*^9, 
   3.656368179058133*^9}, {3.656390740261057*^9, 3.6563907441440573`*^9}, {
   3.6566381484197145`*^9, 3.6566381913177147`*^9}, {3.6566383491895804`*^9, 
   3.6566383574514065`*^9}, {3.6566389667207127`*^9, 3.656638972662713*^9}, {
   3.6566390033807125`*^9, 3.6566390109327126`*^9}, {3.656639374573713*^9, 
   3.6566393810197124`*^9}, {3.656646432407307*^9, 3.6566465136353073`*^9}, {
   3.656646545697307*^9, 3.6566465766333075`*^9}, {3.657341522423893*^9, 
   3.6573415331368933`*^9}, {3.6573415833778934`*^9, 3.657341584459893*^9}, 
   3.657341837957299*^9, {3.657401888921261*^9, 3.6574018936195297`*^9}, {
   3.6574021528083544`*^9, 3.6574021531263723`*^9}, {3.657402187551341*^9, 
   3.657402245153636*^9}, 3.6574022810176873`*^9, {3.657402928680549*^9, 
   3.657402938708516*^9}, {3.6574057316579475`*^9, 3.65740573363475*^9}, {
   3.6574058223088818`*^9, 3.657405885059606*^9}, {3.6574059713189793`*^9, 
   3.657405983057805*^9}, {3.657942940757818*^9, 3.657942954875366*^9}, {
   3.6579429928446813`*^9, 3.6579429975869904`*^9}, {3.6579431757511635`*^9, 
   3.6579431803842745`*^9}, {3.657945578171077*^9, 3.6579456022568593`*^9}, {
   3.6579456462165537`*^9, 3.657945653064822*^9}, {3.65800993146099*^9, 
   3.65800994992699*^9}, {3.658011557946142*^9, 3.658011572344758*^9}, {
   3.658011670966694*^9, 3.65801168138736*^9}, {3.6580129678960114`*^9, 
   3.6580129901572113`*^9}, {3.6580261464497533`*^9, 
   3.6580261636716013`*^9}, {3.6584608098589787`*^9, 
   3.6584608200410147`*^9}, {3.6585272957810087`*^9, 3.658527301234009*^9}, {
   3.658539227250871*^9, 3.658539228158871*^9}, {3.65854047103233*^9, 
   3.658540551498376*^9}, {3.6585405932105465`*^9, 3.658540601122338*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpaceTrussBuckling", "[", 
   RowBox[{
   "nodcoor_", ",", "Aa_", ",", "elenod_", ",", "eledes_", ",", "elemat_", 
    ",", "elemi_", ",", "nodtag_", ",", "nodsp_", ",", "nodconm_", ",", 
    "ksbeam_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"kk", ",", "kd", ",", "eib"}], "}"}], ",", 
    RowBox[{
     RowBox[{"kk", "=", 
      RowBox[{"SpaceTrassMasterStiffness", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "elemat", ",", "elemi", ",", 
        "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"kd", "=", 
      RowBox[{"SpaceTrassMasterDiffStiffness", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "elemat", ",", "elemi", ",", 
        "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"VectorQ", "[", "nodsp", "]"}], ",", "Null", ",", 
       RowBox[{"kk", "=", 
        RowBox[{"ApplySpringToMaster", "[", 
         RowBox[{"nodsp", ",", "kk"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kk", "=", 
      RowBox[{"ApplyDofToMaster", "[", 
       RowBox[{"nodtag", ",", "kk"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"kd", "=", 
      RowBox[{"ApplyDofToMaster", "[", 
       RowBox[{"nodtag", ",", "kd"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eib", "=", 
      RowBox[{"Eigenvalues", "[", 
       RowBox[{"{", 
        RowBox[{"kk", ",", 
         RowBox[{"-", "kd"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eib", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{"Chop", "[", "eib", "]"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"#1", ">", "1"}], "&"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<1st Buckling Load Cofficient:\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"eib", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6587987866511683`*^9, 3.6587989169859543`*^9}, {
   3.658798959800954*^9, 3.6587990854859543`*^9}, {3.658799463272954*^9, 
   3.6587994854979544`*^9}, {3.6588014709979544`*^9, 3.658801473073954*^9}, {
   3.6588017799009542`*^9, 3.658801785796954*^9}, 3.658802512414954*^9, 
   3.6588026006639543`*^9, {3.6588083008632746`*^9, 3.6588083085228252`*^9}, {
   3.658808780670809*^9, 3.658808792355209*^9}, {3.658811299762951*^9, 
   3.658811300199701*^9}, {3.6588113491468525`*^9, 3.6588114037093563`*^9}, {
   3.658811465649808*^9, 3.6588114701888847`*^9}, 3.658811698406474*^9, {
   3.6588118126723747`*^9, 3.658811813171565*^9}, {3.6590489959477406`*^9, 
   3.6590490022693725`*^9}, {3.659050271250497*^9, 3.6590502841574965`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RotorMode", "[", 
   RowBox[{
   "nodcoor_", ",", "Aa_", ",", "elenod_", ",", "eledes_", ",", "elemat_", 
    ",", "elemi_", ",", "nodtag_", ",", "nodsppd_", ",", "nodconm_", ",", 
    "ops_", ",", "kkp_", ",", "ksbeam_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mm", ",", "kk", ",", "al", ",", "kmod", ",", "ww", ",", "ei1", ",", 
      "ei2", ",", "\[Lambda]", ",", "kkd", ",", "nodsp1", ",", "i", ",", 
      "kkda", ",", "cs1", ",", "cs2", ",", "cs3", ",", "cs4", ",", "nnn", ",",
       "spt", ",", "spt2", ",", "spt3", ",", "spty", ",", "msp1", ",", "msp2",
       ",", "rpmode", ",", "dn", ",", "mmm", ",", "mma1", ",", "mma2", ",", 
      "cm1", ",", "cm2", ",", "kks", ",", "kke", ",", "rr", ",", "rpp"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"mm", "=", 
      RowBox[{"SpaceTrassMasterMass", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "eledes", ",", "elemi", ",", 
        "elemat", ",", "ksbeam"}], "]"}]}], ";", 
     RowBox[{"mm", "=", 
      RowBox[{"ApplyConMasstoMasterM", "[", 
       RowBox[{"nodconm", ",", "mm"}], "]"}]}], ";", 
     RowBox[{"kk", "=", 
      RowBox[{"SpaceTrassMasterStiffness", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "elemat", ",", "elemi", ",", 
        "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Rotor Undamped Speed Map&Mode Shape\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "15"}], ",", 
            RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Rotor Geometry:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rr", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", "Aa", ")"}], "/", "Pi"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rpp", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"rpp", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"rpp", ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nodcoor", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"rr", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nodcoor", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"rr", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Length", "[", "nodcoor", "]"}], "-", "1"}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rpp", "=", 
      RowBox[{"Prepend", "[", 
       RowBox[{"rpp", ",", "White"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rpp", "=", 
      RowBox[{"Prepend", "[", 
       RowBox[{"rpp", ",", 
        RowBox[{"EdgeForm", "[", "Thin", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Graphics", "[", 
       RowBox[{"rpp", ",", 
        RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"kks", "=", "1000"}], ";", "\[IndentingNewLine]", 
     RowBox[{"kke", "=", "10000000"}], ";", "\[IndentingNewLine]", 
     RowBox[{"mm", "=", 
      RowBox[{"ApplyDofToMaster", "[", 
       RowBox[{"nodtag", ",", "mm"}], "]"}]}], ";", 
     RowBox[{"ei2", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"kkda", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rpmode", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nodsp1", "=", "nodsppd"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VectorQ", "[", "nodsp1", "]"}], ",", "Null", ",", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "\[LessEqual]", 
             RowBox[{"Length", "[", "nodsp1", "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", 
            RowBox[{
             RowBox[{"Quiet", "[", 
              RowBox[{
               RowBox[{"nodsp1", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
               RowBox[{"kkp", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", 
             RowBox[{"Quiet", "[", 
              RowBox[{
               RowBox[{"nodsp1", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "4"}], "\[RightDoubleBracket]"}], "=", 
               "10"}], "]"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VectorQ", "[", "nodsp1", "]"}], ",", "Null", ",", 
          RowBox[{"kkd", "=", 
           RowBox[{"ApplySpringToMaster", "[", 
            RowBox[{"nodsp1", ",", "kk"}], "]"}]}]}], "]"}], ";", 
        RowBox[{"kkd", "=", 
         RowBox[{"ApplyDofToMaster", "[", 
          RowBox[{"nodtag", ",", "kkd"}], "]"}]}], ";", 
        RowBox[{"al", "=", 
         RowBox[{
          RowBox[{"Inverse", "[", "mm", "]"}], ".", "kkd"}]}], ";", 
        RowBox[{"rpmode", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"rpmode", ",", 
           RowBox[{"Eigensystem", "[", "al", "]"}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nodsp1", "=", "nodsppd"}], ";", 
        RowBox[{"kkda", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"kkda", ",", "kki"}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VectorQ", "[", "nodsp1", "]"}], ",", "Null", ",", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "\[LessEqual]", 
             RowBox[{"Length", "[", "nodsp1", "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", 
            RowBox[{
             RowBox[{"Quiet", "[", 
              RowBox[{
               RowBox[{"nodsp1", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
               "kki"}], "]"}], ";", 
             RowBox[{"Quiet", "[", 
              RowBox[{
               RowBox[{"nodsp1", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "4"}], "\[RightDoubleBracket]"}], "=", 
               "10"}], "]"}]}]}], "]"}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VectorQ", "[", "nodsp1", "]"}], ",", "Null", ",", 
          RowBox[{"kkd", "=", 
           RowBox[{"ApplySpringToMaster", "[", 
            RowBox[{"nodsp1", ",", "kk"}], "]"}]}]}], "]"}], ";", 
        RowBox[{"kkd", "=", 
         RowBox[{"ApplyDofToMaster", "[", 
          RowBox[{"nodtag", ",", "kkd"}], "]"}]}], ";", 
        RowBox[{"al", "=", 
         RowBox[{
          RowBox[{"Inverse", "[", "mm", "]"}], ".", "kkd"}]}], ";", 
        RowBox[{"ei2", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"ei2", ",", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"Chop", "[", 
               RowBox[{"Eigenvalues", "[", "al", "]"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"#1", "!=", "1"}], "&"}]}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"kki", ",", "kks", ",", "kke", ",", 
         FractionBox[
          RowBox[{"kke", "-", "kks"}], "40"]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ei2", "=", 
      RowBox[{
       FractionBox[
        SqrtBox["ei2"], 
        RowBox[{"2", " ", "\[Pi]"}]], "*", "60"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nnn", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"ei2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cs1", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"kkda", ",", "1"}], "]"}], ",", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"ei2", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "nnn"}], "]"}], "]"}], ",", "1"}], "]"}], ",",
         "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cs2", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"kkda", ",", "1"}], "]"}], ",", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"ei2", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"nnn", "-", "1"}]}], "]"}], "]"}], ",", "1"}], "]"}], 
        ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cs3", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"kkda", ",", "1"}], "]"}], ",", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"ei2", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"nnn", "-", "2"}]}], "]"}], "]"}], ",", "1"}], "]"}], 
        ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cs4", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"kkda", ",", "1"}], "]"}], ",", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"ei2", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"nnn", "-", "3"}]}], "]"}], "]"}], ",", "1"}], "]"}], 
        ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"spt", "=", 
      RowBox[{"nodsppd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"spt", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"spt", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"spty", "=", 
      RowBox[{"nodsppd", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"spty", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"spty", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"spt2", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"spt3", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"spt2", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"spt2", ",", 
          RowBox[{"Reverse", "[", 
           RowBox[{"spt", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "spt", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"spt3", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"spt3", ",", 
          RowBox[{"Reverse", "[", 
           RowBox[{"spty", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "spty", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"ListLogLogPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cs1", ",", "cs2", ",", "cs3", ",", "cs4", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"kks", ",", 
              RowBox[{"ops", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"kke", ",", 
              RowBox[{"ops", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"kks", ",", 
              RowBox[{"ops", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"kke", ",", 
              RowBox[{"ops", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ",", "spt2", 
          ",", "spt3"}], "}"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Dashed", ",", 
           "Dashed", ",", "Dashed", ",", "Dashed"}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Support Stiffness\>\"", ",", "\"\<Critical Speed (cpm)\>\""}], 
          "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", "\"\<Undamped Critical Speed Map\>\""}]}], 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"msp1", "=", 
      RowBox[{"rpmode", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"msp2", "=", 
      RowBox[{"rpmode", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dn", "=", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"msp1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "1."}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"msp1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"Delete", "[", 
       RowBox[{
        RowBox[{"msp1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "dn"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"msp1", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", 
      RowBox[{"Delete", "[", 
       RowBox[{
        RowBox[{"msp1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "dn"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"msp2", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"Delete", "[", 
       RowBox[{
        RowBox[{"msp2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "dn"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"msp2", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", 
      RowBox[{"Delete", "[", 
       RowBox[{
        RowBox[{"msp2", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "dn"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"msp1", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"msp1", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}], "/", 
         RowBox[{"Max", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"msp1", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"msp1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"msp2", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"msp2", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}], "/", 
         RowBox[{"Max", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"msp2", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"msp2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mma1", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mmm", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"mmm", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"mmm", ",", 
             RowBox[{
              RowBox[{"msp1", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"msp1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "j"}]}], 
                "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"6", "*", "i"}], "-", "3"}], "]"}], "]"}]}], "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "nodcoor", "]"}]}], "}"}]}], "]"}], ";", 
        RowBox[{"mma1", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"mma1", ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"nodcoor", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "}"}], ",", 
              RowBox[{"{", "mmm", "}"}]}], "]"}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "3"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mma2", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mmm", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"mmm", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"mmm", ",", 
             RowBox[{
              RowBox[{"msp2", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"msp2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "j"}]}], 
                "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"6", "*", "i"}], "-", "3"}], "]"}], "]"}]}], "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "nodcoor", "]"}]}], "}"}]}], "]"}], ";", 
        RowBox[{"mma2", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"mma2", ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"nodcoor", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "}"}], ",", 
              RowBox[{"{", "mmm", "}"}]}], "]"}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "3"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cm1", "=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"msp1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"-", "4"}]}], "]"}], "]"}], "]"}], "*", 
       RowBox[{"60", "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", "Pi"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cm2", "=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"Reverse", "[", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"msp2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"-", "4"}]}], "]"}], "]"}], "]"}], "*", 
       RowBox[{"60", "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", "Pi"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mma1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"mma1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"mma1", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"mma1", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
        RowBox[{"Mesh", "\[Rule]", "Full"}], ",", 
        RowBox[{"PlotMarkers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<1\>\"", ",", "\"\<2\>\"", ",", "\"\<3\>\"", ",", "\"\<4\>\""}],
           "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Thickness", "[", "0.003", "]"}]}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<Mode Shape Plot\>\"", ",", "SpanFromLeft"}], "}"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Bearing Stiffness:\>\"", ",", 
               RowBox[{"ScientificForm", "[", 
                RowBox[{"N", "[", 
                 RowBox[{"kkp", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Critical Speed(cpm)\>\"", ",", "SpanFromLeft"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Mode1:\>\"", ",", 
               RowBox[{"cm1", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Mode2:\>\"", ",", 
               RowBox[{"cm1", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Mode3:\>\"", ",", 
               RowBox[{"cm1", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Mode4:\>\"", ",", 
               RowBox[{"cm1", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
           RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Length\>\"", ",", "\"\<Relative Displacement\>\""}], 
          "}"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Blue", ",", 
           RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.2"}], ",", "1.2"}], "}"}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mma2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"mma2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"mma2", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"mma2", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
        RowBox[{"Mesh", "\[Rule]", "Full"}], ",", 
        RowBox[{"PlotMarkers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<1\>\"", ",", "\"\<2\>\"", ",", "\"\<3\>\"", ",", "\"\<4\>\""}],
           "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Thickness", "[", "0.003", "]"}]}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<Mode Shape Plot\>\"", ",", "SpanFromLeft"}], "}"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Bearing Stiffness:\>\"", ",", 
               RowBox[{"ScientificForm", "[", 
                RowBox[{"N", "[", 
                 RowBox[{"kkp", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Critical Speed(cpm)\>\"", ",", "SpanFromLeft"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Mode1:\>\"", ",", 
               RowBox[{"cm2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Mode2:\>\"", ",", 
               RowBox[{"cm2", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Mode3:\>\"", ",", 
               RowBox[{"cm2", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Mode4:\>\"", ",", 
               RowBox[{"cm2", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
           RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Length\>\"", ",", "\"\<Relative Displacement\>\""}], 
          "}"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Blue", ",", 
           RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.2"}], ",", "1.2"}], "}"}]}]}], "]"}], "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.657406874524601*^9, 3.6574070203042364`*^9}, 
   3.6574072281222363`*^9, {3.6574072768782363`*^9, 3.6574073042082367`*^9}, {
   3.6574073464652367`*^9, 3.6574074062042365`*^9}, {3.6574077046842365`*^9, 
   3.657407704907236*^9}, {3.6574078056621213`*^9, 3.65740799266682*^9}, {
   3.6574083498912334`*^9, 3.6574083599662333`*^9}, {3.6574085042352333`*^9, 
   3.657408509727233*^9}, {3.657408571940233*^9, 3.657408578583233*^9}, {
   3.6574087525772333`*^9, 3.6574087635442333`*^9}, {3.657408872072233*^9, 
   3.657408881911233*^9}, {3.657408926060233*^9, 3.657408940036233*^9}, {
   3.657409238988233*^9, 3.657409266527233*^9}, {3.657409832102233*^9, 
   3.6574098615442333`*^9}, {3.6574100261952333`*^9, 3.657410074338233*^9}, {
   3.657410194272233*^9, 3.6574102571302333`*^9}, {3.6574102963322334`*^9, 
   3.6574104880302334`*^9}, {3.657410526310233*^9, 3.657410536951233*^9}, {
   3.6574105690642333`*^9, 3.6574105826672335`*^9}, {3.6574107276482334`*^9, 
   3.657410763315233*^9}, {3.657410847932233*^9, 3.6574108955772333`*^9}, {
   3.657410967442233*^9, 3.657410973539233*^9}, {3.657411117815233*^9, 
   3.657411149147233*^9}, {3.657411255017233*^9, 3.657411338633233*^9}, {
   3.6574124480752335`*^9, 3.657412491270233*^9}, {3.6574169082542553`*^9, 
   3.657416908904255*^9}, {3.657417099411255*^9, 3.657417153301255*^9}, {
   3.657417756667255*^9, 3.657417759866255*^9}, {3.657417954786255*^9, 
   3.6574179774532547`*^9}, {3.6574180265852547`*^9, 
   3.6574180354902554`*^9}, {3.657418123749255*^9, 3.657418140943255*^9}, {
   3.657418420581255*^9, 3.6574184451152554`*^9}, {3.657419869924255*^9, 
   3.657419913518255*^9}, 3.657419948357255*^9, {3.657420378757255*^9, 
   3.657420440494255*^9}, {3.6574205086952553`*^9, 3.657420515003255*^9}, {
   3.657420548425255*^9, 3.657420552156255*^9}, {3.657420604554255*^9, 
   3.6574206639862547`*^9}, {3.657420695339553*^9, 3.657420705450575*^9}, {
   3.657420756960875*^9, 3.657420836917863*^9}, {3.6574211596473255`*^9, 
   3.6574211704914103`*^9}, {3.657421335291888*^9, 3.657421428266185*^9}, {
   3.657421527436101*^9, 3.657421534135771*^9}, {3.6574215663329897`*^9, 
   3.6574216091602483`*^9}, {3.657421658485248*^9, 3.6574216638082485`*^9}, {
   3.6574217249952483`*^9, 3.657421727786248*^9}, {3.6574217605862484`*^9, 
   3.6574217896972485`*^9}, {3.657421875905248*^9, 3.6574218857922482`*^9}, {
   3.6574219442392483`*^9, 3.6574219855612483`*^9}, {3.657422020514248*^9, 
   3.657422021852248*^9}, {3.6574259583202415`*^9, 3.6574260014852414`*^9}, {
   3.6574260331712413`*^9, 3.6574261171322412`*^9}, {3.6574262013472414`*^9, 
   3.6574262021292415`*^9}, {3.6574263511922417`*^9, 3.657426381700241*^9}, {
   3.6574264144862413`*^9, 3.6574264741782417`*^9}, {3.6574268323712416`*^9, 
   3.6574269199472413`*^9}, {3.657427577712241*^9, 3.6574276028032417`*^9}, {
   3.6574278226652412`*^9, 3.6574278291512413`*^9}, {3.657488928572335*^9, 
   3.6574889509873347`*^9}, 3.6574890800293927`*^9, 3.6574891240527945`*^9, 
   3.657489156218011*^9, {3.6574892819385815`*^9, 3.657489284628851*^9}, {
   3.6574893924996367`*^9, 3.657489487816168*^9}, {3.657489521982584*^9, 
   3.657489558895275*^9}, 3.657489710822466*^9, {3.6574972626003695`*^9, 
   3.6574972678014097`*^9}, {3.657497364691784*^9, 3.6574973962961035`*^9}, {
   3.6574975768792477`*^9, 3.657497582554815*^9}, {3.6574976256051197`*^9, 
   3.6574976478733463`*^9}, {3.657497772577815*^9, 3.6574977787114286`*^9}, {
   3.6574978100035577`*^9, 3.6574978131758747`*^9}, {3.6574980829418488`*^9, 
   3.657498160652619*^9}, {3.657498196698223*^9, 3.657498203109864*^9}, {
   3.657498370376672*^9, 3.657498375513672*^9}, {3.6574984137016716`*^9, 
   3.6574984266206717`*^9}, {3.6574984868646717`*^9, 
   3.6574985050886717`*^9}, {3.6575023417796717`*^9, 
   3.6575023980411606`*^9}, {3.6575025319393177`*^9, 3.65750253634664*^9}, 
   3.6575027110614576`*^9, {3.657502744793831*^9, 3.6575027452418756`*^9}, {
   3.6575027894602966`*^9, 3.6575027996743183`*^9}, {3.657503119796327*^9, 
   3.6575031662629733`*^9}, {3.657503265127859*^9, 3.6575032724965954`*^9}, {
   3.6575846954698715`*^9, 3.6575846972898717`*^9}, 3.6575847457288713`*^9, {
   3.657841601189212*^9, 3.6578416774012117`*^9}, {3.6578477889092035`*^9, 
   3.657847791026203*^9}, {3.6578573490681863`*^9, 3.6578573502961864`*^9}, {
   3.6578585218461866`*^9, 3.657858530439186*^9}, {3.6578590643501863`*^9, 
   3.6578591491811867`*^9}, {3.6578591977371864`*^9, 3.657859197885186*^9}, {
   3.657859255878186*^9, 3.6578592916871862`*^9}, {3.6578593322361865`*^9, 
   3.657859404255186*^9}, {3.6578594637101865`*^9, 3.6578594682571864`*^9}, {
   3.6578595234561863`*^9, 3.6578595261291866`*^9}, {3.657859578517186*^9, 
   3.6578595786831865`*^9}, {3.657860309411883*^9, 3.6578603189588375`*^9}, {
   3.657860380434984*^9, 3.657860383569298*^9}, {3.6578609556625013`*^9, 
   3.657860984499385*^9}, {3.657861214534181*^9, 3.6578612764581814`*^9}, {
   3.657861481700181*^9, 3.657861491651181*^9}, {3.657920077970496*^9, 
   3.657920091898529*^9}, {3.6579201386962724`*^9, 3.6579201388942327`*^9}, {
   3.657922883302302*^9, 3.657922897362302*^9}, {3.6579232009000535`*^9, 
   3.657923239198883*^9}, {3.657923699638918*^9, 3.6579237186568193`*^9}, {
   3.657924033428293*^9, 3.6579240458265333`*^9}, {3.6579240950644565`*^9, 
   3.6579241047814283`*^9}, {3.6579241715060997`*^9, 3.657924178327134*^9}, {
   3.657925180902134*^9, 3.657925181206134*^9}, {3.657926379893134*^9, 
   3.6579264494391336`*^9}, {3.657926572026134*^9, 3.6579266255611343`*^9}, 
   3.6579294692493305`*^9, {3.6579295300253305`*^9, 3.6579295328173304`*^9}, {
   3.6579295698583307`*^9, 3.6579296152753305`*^9}, {3.6579387207096357`*^9, 
   3.6579387275579042`*^9}, {3.6579392967214065`*^9, 
   3.6579392970490026`*^9}, {3.657939352225495*^9, 3.657939352537491*^9}, {
   3.6579393887758265`*^9, 3.657939398853297*^9}, {3.6579397867111244`*^9, 
   3.657939798098978*^9}, {3.6580249240367193`*^9, 3.658024931165691*^9}, {
   3.658026171611747*^9, 3.658026186462471*^9}, 3.658027603280882*^9, 
   3.658027674726592*^9, {3.6585273177360086`*^9, 3.6585273212260084`*^9}, {
   3.6586268744704113`*^9, 3.6586269878314114`*^9}, {3.6586271517344117`*^9, 
   3.6586271586484118`*^9}, {3.6586272189714117`*^9, 
   3.6586272198994117`*^9}, {3.658630790802405*^9, 3.658630802454405*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nodcoor", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"200", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"300", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Aa", "=", 
   RowBox[{"{", 
    RowBox[{"628.3", ",", "1200", ",", "628.3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elenod", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eledes", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}], ",", 
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}], ",", 
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elemat", "=", 
   RowBox[{"{", 
    RowBox[{"210000", ",", "210000", ",", "210000"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elemi", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"7854", ",", "7854"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"12000", ",", "12000"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7854", ",", "7854"}], "}"}]}], "}"}], "*", "100"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodconm", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"3", ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodtag", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "1"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kkp", "=", 
   RowBox[{"{", 
    RowBox[{"100", ",", "200000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{"{", 
    RowBox[{"8500", ",", "12000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodsp1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"100", ",", "0"}], "}"}]}], "}"}], ",", "0", ",", "1"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"300", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"300", ",", "0", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"100", ",", "0"}], "}"}]}], "}"}], ",", "0", ",", "4"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nodsppd", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"20", ",", "100000"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"6000", ",", "150000"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9000", ",", "190000"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"100", ",", "10"}], "}"}]}], "}"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "10", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"20", ",", "200000"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"6000", ",", "250000"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9000", ",", "290000"}], "}"}]}], "}"}], ",", "10", ",", 
        "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"300", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"300", ",", "0", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"20", ",", "100000"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"6000", ",", "150000"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9000", ",", "190000"}], "}"}]}], "}"}], ",", "10", ",", 
        "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"300", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"300", ",", "10", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"20", ",", "200000"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"6000", ",", "250000"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9000", ",", "290000"}], "}"}]}], "}"}], ",", "10", ",", 
        "4"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SpaceTrussMode", "[", 
    RowBox[{
    "nodcoor", ",", "Aa", ",", "elenod", ",", "eledes", ",", "elemat", ",", 
     "elemi", ",", "nodtag", ",", "nodsp", ",", "nodconm"}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RotorMode", "[", 
   RowBox[{
   "nodcoor", ",", "Aa", ",", "elenod", ",", "eledes", ",", "elemat", ",", 
    "elemi", ",", "nodtag", ",", "nodsp1", ",", "nodconm", ",", "ops", ",", 
    "kkp"}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6549978861987066`*^9, 3.6549980394937067`*^9}, {
   3.6549980957167063`*^9, 3.6549980974177065`*^9}, {3.6549982775337067`*^9, 
   3.6549984310707064`*^9}, {3.6549985004707065`*^9, 
   3.6549985271177063`*^9}, {3.6549985607127066`*^9, 
   3.6549986256587067`*^9}, {3.654998883421706*^9, 3.654999001487706*^9}, 
   3.6549992290617065`*^9, {3.6549993246897063`*^9, 3.6549993316627064`*^9}, {
   3.6549994835907063`*^9, 3.6549994846137066`*^9}, {3.6549995180457067`*^9, 
   3.654999556947706*^9}, {3.6549995943277063`*^9, 3.6549996104087067`*^9}, 
   3.6549996453757067`*^9, {3.654999778725706*^9, 3.654999780461706*^9}, {
   3.6549998183807063`*^9, 3.6549999015117064`*^9}, {3.6549999539327064`*^9, 
   3.6549999802007065`*^9}, {3.6550000790447063`*^9, 
   3.6550000935957065`*^9}, {3.655000123869706*^9, 3.6550001384767065`*^9}, {
   3.655000269527706*^9, 3.6550002814197063`*^9}, {3.6550003368407063`*^9, 
   3.6550003381827064`*^9}, {3.6550004654207067`*^9, 3.655000469133706*^9}, {
   3.6550005187857065`*^9, 3.6550005266447067`*^9}, {3.6550005567827063`*^9, 
   3.6550005965838833`*^9}, {3.655000657503065*^9, 3.6550006752966228`*^9}, 
   3.6550007267649145`*^9, {3.6550008306216817`*^9, 3.6550008445584683`*^9}, {
   3.655005910912693*^9, 3.6550059718546925`*^9}, {3.655007458415693*^9, 
   3.655007466619693*^9}, {3.655007613117693*^9, 3.655007615158693*^9}, {
   3.655007667428693*^9, 3.6550077158006926`*^9}, 3.655079008998255*^9, {
   3.655079057228077*^9, 3.6550791735355034`*^9}, {3.655079205702503*^9, 
   3.6550792739365034`*^9}, {3.6550793247865033`*^9, 
   3.6550793290685034`*^9}, {3.6550793836985035`*^9, 
   3.6550795635625033`*^9}, {3.6550796050805035`*^9, 
   3.6550796091775036`*^9}, {3.6550796895145035`*^9, 
   3.6550796942765036`*^9}, {3.6550961287914124`*^9, 3.655096128944412*^9}, {
   3.655096173381412*^9, 3.655096192882412*^9}, 3.655096229781412*^9, {
   3.655096265803412*^9, 3.655096406612412*^9}, {3.6550964726954117`*^9, 
   3.655096483686412*^9}, {3.655096604422412*^9, 3.655096638100386*^9}, {
   3.655155097680007*^9, 3.655155116999984*^9}, 3.6551551568860645`*^9, {
   3.6551551874333954`*^9, 3.655155195222499*^9}, {3.6551552770785503`*^9, 
   3.65515528051683*^9}, {3.655155837955512*^9, 3.6551558486475124`*^9}, {
   3.6551560591841617`*^9, 3.6551560674663334`*^9}, 3.6551562065985146`*^9, {
   3.655156814611514*^9, 3.655156820351514*^9}, {3.6551568830485144`*^9, 
   3.6551569118695145`*^9}, {3.655157681715514*^9, 3.655157718682514*^9}, {
   3.6551577571975145`*^9, 3.6551577863065143`*^9}, 3.655157822672514*^9, {
   3.655157946611514*^9, 3.65515807496064*^9}, {3.655158121704314*^9, 
   3.6551581486050034`*^9}, {3.655159192719511*^9, 3.6551591947895107`*^9}, {
   3.655160564080511*^9, 3.655160564669511*^9}, {3.6551609354305105`*^9, 
   3.6551609764345107`*^9}, {3.6551617270200853`*^9, 
   3.6551617285642395`*^9}, {3.6555276750164227`*^9, 
   3.6555276766254225`*^9}, {3.6555905259426184`*^9, 
   3.6555905276117754`*^9}, {3.6555933803909597`*^9, 
   3.6555933878474255`*^9}, {3.6555947781966186`*^9, 
   3.6555947783526115`*^9}, {3.6555951962993956`*^9, 3.655595218030892*^9}, {
   3.655595313145591*^9, 3.655595338557991*^9}, {3.6555962349384155`*^9, 
   3.655596288008254*^9}, {3.6555965085086*^9, 3.655596538444233*^9}, {
   3.655596625209208*^9, 3.6555966494821854`*^9}, {3.6555967997231407`*^9, 
   3.6555968141683702`*^9}, {3.6555968901228223`*^9, 
   3.6555969328657265`*^9}, {3.6555969830964384`*^9, 
   3.6555970425309143`*^9}, {3.6555975788476715`*^9, 
   3.6555975885818224`*^9}, {3.6556078378509493`*^9, 3.655607852465949*^9}, {
   3.655607948983949*^9, 3.6556079517259493`*^9}, {3.6556760490611687`*^9, 
   3.6556760584731684`*^9}, {3.6556762716051683`*^9, 
   3.6556762904551687`*^9}, {3.655676426443187*^9, 3.655676428317374*^9}, {
   3.6556775113876085`*^9, 3.655677516890058*^9}, {3.6556775881059356`*^9, 
   3.655677685380207*^9}, 3.6556782064961667`*^9, {3.6556788147091665`*^9, 
   3.655678817564167*^9}, {3.655679600444167*^9, 3.6556796009051666`*^9}, {
   3.655680013778167*^9, 3.655680059797167*^9}, {3.655680149362167*^9, 
   3.655680149590167*^9}, {3.6556802810881667`*^9, 3.655680316481167*^9}, {
   3.655680393067167*^9, 3.655680393324167*^9}, {3.6556806748316727`*^9, 
   3.655680676297966*^9}, {3.6556807563539743`*^9, 3.6556807803117647`*^9}, {
   3.6556809023641677`*^9, 3.655680910696001*^9}, {3.6556812399611616`*^9, 
   3.6556812579941616`*^9}, {3.6556814541561613`*^9, 3.6556814728301616`*^9}, 
   3.655681528700162*^9, {3.655681739259162*^9, 3.655681804273162*^9}, {
   3.6556818518481617`*^9, 3.6556819691001616`*^9}, {3.6556820058431616`*^9, 
   3.6556820602451615`*^9}, {3.655682095049162*^9, 3.6556821651351614`*^9}, {
   3.6556826525151615`*^9, 3.6556827692411613`*^9}, {3.65575987031738*^9, 
   3.655759915592665*^9}, {3.6557599586425095`*^9, 3.6557599907517643`*^9}, {
   3.6557600522174683`*^9, 3.65576007895312*^9}, {3.656037341724304*^9, 
   3.6560373459283037`*^9}, {3.6560376178225555`*^9, 3.656037674771943*^9}, {
   3.656106521999483*^9, 3.656106528786483*^9}, {3.656293158829565*^9, 
   3.6562931696445646`*^9}, {3.6562932201845646`*^9, 3.6562932260285645`*^9}, 
   3.656293279867565*^9, {3.6562933266445646`*^9, 3.6562933316915646`*^9}, {
   3.656293399772565*^9, 3.656293427535565*^9}, 3.656293480079565*^9, {
   3.6574019477106233`*^9, 3.6574019787083964`*^9}, {3.6574020090801334`*^9, 
   3.6574020225469036`*^9}, {3.657402081018248*^9, 3.6574020837964067`*^9}, {
   3.657402870356431*^9, 3.657402871268146*^9}, 3.657405903845727*^9, {
   3.6574084483532333`*^9, 3.6574084899922333`*^9}, {3.657408737927233*^9, 
   3.657408743515233*^9}, 3.6574089598112335`*^9, {3.6574090791362333`*^9, 
   3.657409082231233*^9}, {3.6574092050022335`*^9, 3.657409207322233*^9}, {
   3.657409761289233*^9, 3.657409766527233*^9}, {3.657409960691233*^9, 
   3.6574099810752335`*^9}, 3.657411191017233*^9, 3.6574125693772335`*^9, {
   3.657417410456255*^9, 3.657417419623255*^9}, {3.657417520649255*^9, 
   3.657417545378255*^9}, {3.657417578190255*^9, 3.657417584317255*^9}, {
   3.6574176233872547`*^9, 3.657417637238255*^9}, {3.657417713989255*^9, 
   3.657417725451255*^9}, {3.657417764671255*^9, 3.657417791402255*^9}, {
   3.657420614496255*^9, 3.657420618996255*^9}, 3.657420721998884*^9, {
   3.6574210732866907`*^9, 3.6574211288242435`*^9}, {3.657421199654326*^9, 
   3.657421257429103*^9}, {3.6574220764762483`*^9, 3.657422078526248*^9}, 
   3.6574262576092415`*^9, {3.657426580462241*^9, 3.657426585731241*^9}, {
   3.6574266225132413`*^9, 3.6574266591102414`*^9}, {3.6574266913132415`*^9, 
   3.6574266915082417`*^9}, {3.6574267856032414`*^9, 
   3.6574267938882413`*^9}, {3.6574274872612414`*^9, 
   3.6574274886192417`*^9}, {3.657427889455241*^9, 3.6574278896122417`*^9}, {
   3.6574279451592417`*^9, 3.6574279887172413`*^9}, {3.6574896529816823`*^9, 
   3.6574896806964536`*^9}, 3.6574940528182864`*^9, {3.657498652907672*^9, 
   3.6574986532086716`*^9}, 3.6575021162346716`*^9, {3.657502752527604*^9, 
   3.657502762202571*^9}, 3.6575028723545856`*^9, {3.6575032569260387`*^9, 
   3.6575032792352695`*^9}, 3.6578538875041966`*^9, 3.6578540317681966`*^9, {
   3.657854727499193*^9, 3.6578547279291935`*^9}, {3.657920099630661*^9, 
   3.6579201076076703`*^9}, {3.657922766579302*^9, 3.6579227824493017`*^9}, {
   3.657923960237975*^9, 3.65792399089304*^9}, {3.6579413739194007`*^9, 
   3.6579414892331223`*^9}, {3.657941527483832*^9, 3.657941551663522*^9}, {
   3.657941691515729*^9, 3.657941702092393*^9}, {3.657941745818633*^9, 
   3.657941745943431*^9}, 3.657941780028994*^9, {3.657941843005387*^9, 
   3.6579418432081842`*^9}, {3.6579422169159164`*^9, 
   3.6579422207218285`*^9}, {3.6579423792287045`*^9, 3.657942379384684*^9}, {
   3.6579426617923584`*^9, 3.657942662088743*^9}, {3.657943491041495*^9, 
   3.6579435126945724`*^9}, {3.6579436091194086`*^9, 3.657943631178091*^9}, {
   3.6579463071557136`*^9, 3.657946307264905*^9}, {3.657946875185983*^9, 
   3.6579469202688274`*^9}, {3.6580133324948115`*^9, 3.6580133470652113`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpaceTrussModeC", "[", 
   RowBox[{
   "nodcoor_", ",", "Aa_", ",", "elenod_", ",", "eledes_", ",", "elemat_", 
    ",", "elemi_", ",", "nodtag_", ",", "nodsp_", ",", "nodconm_", ",", 
    "ksbeam_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mm", ",", "kk", ",", "al", ",", "kmod", ",", "ww", ",", "ei1", ",", 
      "ei2", ",", "\[Lambda]", ",", "cla", ",", "nnn", ",", "bbb", ",", 
      "bb"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mm", "=", 
      RowBox[{"SpaceTrassMasterMass", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "eledes", ",", "elemi", ",", 
        "elemat", ",", "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mm", "=", 
      RowBox[{"ApplyConMasstoMasterM", "[", 
       RowBox[{"nodconm", ",", "mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"kk", "=", 
      RowBox[{"SpaceTrassMasterStiffness", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "elemat", ",", "elemi", ",", 
        "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nnn", "=", 
      RowBox[{"6", "*", 
       RowBox[{"Length", "[", "nodcoor", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bb", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", "nnn", ",", "nnn"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"VectorQ", "[", "nodsp", "]"}], ",", "Null", ",", 
       RowBox[{"kk", "=", 
        RowBox[{"ApplySpringToMaster", "[", 
         RowBox[{"nodsp", ",", "kk"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kk", "=", 
      RowBox[{"ApplyDofToMaster", "[", 
       RowBox[{"nodtag", ",", "kk"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mm", "=", 
      RowBox[{"ApplyDofToMaster", "[", 
       RowBox[{"nodtag", ",", "mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"VectorQ", "[", "nodsp", "]"}], ",", "Null", ",", 
       RowBox[{"bbb", "=", 
        RowBox[{"ApplySpringToMasterB", "[", 
         RowBox[{"nodsp", ",", "bb"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cla", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "mm", "}"}], ",", 
        RowBox[{"{", "bbb", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cla", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"cla", ",", 
        RowBox[{"{", "kk", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ei2", "=", 
      RowBox[{"PolynomialEigenvalues", "[", "cla", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ei2", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"ei2", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"Im", "[", "#1", "]"}], "]"}], "<", 
          RowBox[{"Abs", "[", 
           RowBox[{"Im", "[", "#2", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Constrained Complex Eigenvalue:\>\"", ",", 
       RowBox[{"SlideView", "[", 
        RowBox[{"ei2", ",", 
         RowBox[{"AppearanceElements", "\[Rule]", 
          RowBox[{"{", " ", 
           RowBox[{
           "\"\<FirstSlide\>\"", ",", " ", "\"\<PreviousSlide\>\"", ",", " ", 
            "\"\<NextSlide\>\"", ",", " ", "\"\<LastSlide\>\"", ",", " ", 
            "\"\<SlideNumber\>\"", ",", " ", "\"\<SlideTotal\>\""}], 
           "}"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"ei2", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Im", "[", "#", "]"}], "]"}], ">", "1"}], "&"}], ",", 
         "20"}], "]"}], "//", "MatrixForm"}], "]"}], ";"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656293653293565*^9, 3.6562936580975647`*^9}, {
   3.6563858939520726`*^9, 3.656385896034073*^9}, {3.656385994027073*^9, 
   3.6563860722610726`*^9}, {3.6563907666870575`*^9, 
   3.6563907691470575`*^9}, {3.6563923643653173`*^9, 
   3.6563923816033173`*^9}, {3.6563925360121174`*^9, 3.656392541518917*^9}, {
   3.656638204922714*^9, 3.6566382285957146`*^9}, 3.6566383659572573`*^9, {
   3.656639020914713*^9, 3.656639052804713*^9}, {3.6566466199423075`*^9, 
   3.6566466303503075`*^9}, {3.6568182883001394`*^9, 
   3.6568182971921396`*^9}, {3.657341464378893*^9, 3.657341502013893*^9}, 
   3.657341833237355*^9, {3.6580262188002343`*^9, 3.6580262285187225`*^9}, {
   3.6585273296100087`*^9, 3.658527334392009*^9}}],

Cell[BoxData[
 RowBox[{"(*", "QuadEigenSolver", "*)"}]], "Input",
 CellChangeTimes->{{3.6562935029135647`*^9, 3.656293536094565*^9}, 
   3.6562935694525647`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PolynomialEigenvalues", "[", 
    RowBox[{"matCof", ":", 
     RowBox[{"{", 
      RowBox[{"__", "?", "MatrixQ"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{
          RowBox[{"Length", "[", "matCof", "]"}], "-", "1"}]}], ",", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"First", "[", "matCof", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"Eigenvalues", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ArrayFlatten", "[", 
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"NestList", "[", 
             RowBox[{"RotateRight", ",", 
              RowBox[{"PadRight", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"IdentityMatrix", "[", "n", "]"}], "}"}], ",", "p"}],
                "]"}], ",", 
              RowBox[{"p", "-", "2"}]}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"Rest", "[", "matCof", "]"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Band", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
              RowBox[{"First", "[", "matCof", "]"}]}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"k_", ",", "k_"}], "}"}], "\[Rule]", "1"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"n", " ", "p"}], ",", 
             RowBox[{"n", " ", "p"}]}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
     "]"}], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"Precision", "[", "matCof", "]"}], "<", "Infinity"}], "&&", 
     RowBox[{"SameQ", "@@", 
      RowBox[{"(", 
       RowBox[{"Dimensions", "/@", "matCof"}], ")"}]}]}]}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolynomialEigenvectors", "[", 
    RowBox[{"matCof", ":", 
     RowBox[{"{", 
      RowBox[{"__", "?", "MatrixQ"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{
          RowBox[{"Length", "[", "matCof", "]"}], "-", "1"}]}], ",", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"First", "[", "matCof", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"#", ",", "n"}], "]"}], "&"}], ",", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ArrayFlatten", "[", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"NestList", "[", 
               RowBox[{"RotateRight", ",", 
                RowBox[{"PadRight", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"IdentityMatrix", "[", "n", "]"}], "}"}], ",", 
                  "p"}], "]"}], ",", 
                RowBox[{"p", "-", "2"}]}], "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"Rest", "[", "matCof", "]"}]}]}], "]"}], "]"}], ",", 
           RowBox[{"SparseArray", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Band", "[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
                RowBox[{"First", "[", "matCof", "]"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"k_", ",", "k_"}], "}"}], "\[Rule]", "1"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"n", " ", "p"}], ",", 
               RowBox[{"n", " ", "p"}]}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
       "]"}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"Precision", "[", "matCof", "]"}], "<", "Infinity"}], "&&", 
     RowBox[{"SameQ", "@@", 
      RowBox[{"(", 
       RowBox[{"Dimensions", "/@", "matCof"}], ")"}]}]}]}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PolynomialEigensystem", "[", 
   RowBox[{"matCof", ":", 
    RowBox[{"{", 
     RowBox[{"__", "?", "MatrixQ"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", "=", 
        RowBox[{
         RowBox[{"Length", "[", "matCof", "]"}], "-", "1"}]}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"First", "[", "matCof", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"MapAt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{"#", ",", "n"}], "]"}], "&"}], ",", "#"}], "]"}], "&"}], 
       ",", 
       RowBox[{"Eigensystem", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"NestList", "[", 
              RowBox[{"RotateRight", ",", 
               RowBox[{"PadRight", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"IdentityMatrix", "[", "n", "]"}], "}"}], ",", 
                 "p"}], "]"}], ",", 
               RowBox[{"p", "-", "2"}]}], "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"Rest", "[", "matCof", "]"}]}]}], "]"}], "]"}], ",", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Band", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
               RowBox[{"First", "[", "matCof", "]"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"k_", ",", "k_"}], "}"}], "\[Rule]", "1"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"n", " ", "p"}], ",", 
              RowBox[{"n", " ", "p"}]}], "}"}]}], "]"}]}], "}"}], "]"}], ",", 
       "2"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"Precision", "[", "matCof", "]"}], "<", "Infinity"}], "&&", 
    RowBox[{"SameQ", "@@", 
     RowBox[{"(", 
      RowBox[{"Dimensions", "/@", "matCof"}], ")"}]}]}]}]}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"(*", "QuadEigenSolver", "*)"}]], "Input",
 CellChangeTimes->{3.6562935719985647`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpaceSpring", "[", "ncoor_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x1", ",", "x2", ",", "y1", ",", "y2", ",", "z1", ",", "z2", ",", "x21", 
      ",", "y21", ",", "z21", ",", "EA", ",", "numer", ",", "L", ",", "LL", 
      ",", "LLL", ",", "Ke", ",", "kkk", ",", "bbb", ",", "Be"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ncoor", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"ncoor", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kkk", "=", 
      RowBox[{"ncoor", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bbb", "=", 
      RowBox[{"ncoor", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x21", ",", "y21", ",", "z21"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x2", "-", "x1"}], ",", 
        RowBox[{"y2", "-", "y1"}], ",", 
        RowBox[{"z2", "-", "z1"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"LL", "=", 
      RowBox[{
       RowBox[{"x21", "^", "2"}], "+", 
       RowBox[{"y21", "^", "2"}], "+", 
       RowBox[{"z21", "^", "2"}]}]}], ";", 
     RowBox[{"L", "=", 
      RowBox[{"Sqrt", "[", "LL", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "x21", ",", "y21", ",", "z21", ",", "EA", ",", "LL", ",", "L"}], "}"}],
       "=", 
      RowBox[{"N", "[", 
       RowBox[{"{", 
        RowBox[{
        "x21", ",", "y21", ",", "z21", ",", "EA", ",", "LL", ",", "L"}], 
        "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ke", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "kkk", ")"}], "/", "LL"}], "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x21", "*", "x21"}], ",", 
           RowBox[{"x21", "*", "y21"}], ",", 
           RowBox[{"x21", "*", "z21"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"y21", "*", "x21"}], ",", 
           RowBox[{"y21", "*", "y21"}], ",", 
           RowBox[{"y21", "*", "z21"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"z21", "*", "x21"}], ",", 
           RowBox[{"z21", "*", "y21"}], ",", 
           RowBox[{"z21", "*", "z21"}]}], "}"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Be", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "bbb", ")"}], "/", "LL"}], "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x21", "*", "x21"}], ",", 
           RowBox[{"x21", "*", "y21"}], ",", 
           RowBox[{"x21", "*", "z21"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"y21", "*", "x21"}], ",", 
           RowBox[{"y21", "*", "y21"}], ",", 
           RowBox[{"y21", "*", "z21"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"z21", "*", "x21"}], ",", 
           RowBox[{"z21", "*", "y21"}], ",", 
           RowBox[{"z21", "*", "z21"}]}], "}"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"Ke", ",", "Be"}], "}"}], "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.65629777629471*^9, 3.6562978050297103`*^9}, 
   3.65629788283971*^9, {3.6562982558245983`*^9, 3.656298263518368*^9}, {
   3.6563853898270726`*^9, 3.6563854050660725`*^9}, {3.656385438746073*^9, 
   3.6563854614860725`*^9}, {3.6563855343550725`*^9, 
   3.6563855374950724`*^9}, {3.6567165767127237`*^9, 3.6567165804991026`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RotorGyroscopic", "[", 
   RowBox[{
   "nodcoor_", ",", "elenod_", ",", "Aa_", ",", "eledes_", ",", "elemi_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"numele", "=", 
       RowBox[{"Length", "[", "elenod", "]"}]}], ",", 
      RowBox[{"numnod", "=", 
       RowBox[{"Length", "[", "nodcoor", "]"}]}], ",", "M", ",", "e", ",", 
      "ni", ",", "nj", ",", "eftab", ",", "Ke", ",", "ncoor", ",", "Em", ",", 
      "A", ",", "Iyy", ",", "Izz", ",", "q", ",", "des", ",", "x1", ",", "x2",
       ",", "y1", ",", "y2", ",", "z1", ",", "z2", ",", "ll", ",", "l", ",", 
      "dd", ",", "Ip", ",", "jp", ",", "eftab2", ",", "rgm"}], "}"}], ",", 
    RowBox[{
     RowBox[{"rgm", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"6", " ", "numnod"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", " ", "numnod"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"e", "=", "1"}], ",", 
       RowBox[{"e", "\[LessEqual]", "numele"}], ",", 
       RowBox[{"e", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ni", ",", "nj"}], "}"}], "=", 
         RowBox[{
         "elenod", "\[LeftDoubleBracket]", "e", "\[RightDoubleBracket]"}]}], 
        ";", 
        RowBox[{"eftab", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"6", " ", "ni"}], "-", "5"}], ",", 
           RowBox[{
            RowBox[{"6", " ", "ni"}], "-", "4"}], ",", 
           RowBox[{
            RowBox[{"6", " ", "ni"}], "-", "3"}], ",", 
           RowBox[{
            RowBox[{"6", " ", "ni"}], "-", "2"}], ",", 
           RowBox[{
            RowBox[{"6", " ", "ni"}], "-", "1"}], ",", 
           RowBox[{"6", " ", "ni"}]}], "}"}]}], ";", 
        RowBox[{"eftab2", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"6", " ", "nj"}], "-", "5"}], ",", 
           RowBox[{
            RowBox[{"6", " ", "nj"}], "-", "4"}], ",", 
           RowBox[{
            RowBox[{"6", " ", "nj"}], "-", "3"}], ",", 
           RowBox[{
            RowBox[{"6", " ", "nj"}], "-", "2"}], ",", 
           RowBox[{
            RowBox[{"6", " ", "nj"}], "-", "1"}], ",", 
           RowBox[{"6", " ", "nj"}]}], "}"}]}], ";", 
        RowBox[{"ncoor", "=", 
         RowBox[{"nodcoor", "\[LeftDoubleBracket]", 
          RowBox[{
          "elenod", "\[LeftDoubleBracket]", "e", "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"des", "=", 
         RowBox[{
         "eledes", "\[LeftDoubleBracket]", "e", "\[RightDoubleBracket]"}]}], 
        ";", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}], "}"}], "=", 
         "ncoor"}], ";", 
        RowBox[{"ll", "=", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x2", "-", "x1"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y2", "-", "y1"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z2", "-", "z1"}], ")"}], "2"]}]}], ";", 
        RowBox[{"l", "=", 
         SqrtBox["ll"]}], ";", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Iyy", ",", "Izz"}], "}"}], "=", 
         RowBox[{
         "elemi", "\[LeftDoubleBracket]", "e", "\[RightDoubleBracket]"}]}], 
        ";", 
        RowBox[{"Ip", "=", 
         RowBox[{"Iyy", "+", "Izz"}]}], ";", 
        RowBox[{"jp", "=", 
         RowBox[{"des", " ", "Ip", " ", "l"}]}], ";", 
        RowBox[{"gmn", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", "6", ",", "6"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"gmn", "\[LeftDoubleBracket]", 
          RowBox[{"5", ",", "6"}], "\[RightDoubleBracket]"}], "=", 
         FractionBox["jp", "2"]}], ";", 
        RowBox[{
         RowBox[{"gmn", "\[LeftDoubleBracket]", 
          RowBox[{"6", ",", "5"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"-", 
          FractionBox["jp", "2"]}]}], ";", 
        RowBox[{
         RowBox[{"rgm", "\[LeftDoubleBracket]", 
          RowBox[{"eftab", ",", "eftab"}], "\[RightDoubleBracket]"}], "+=", 
         "gmn"}], ";", 
        RowBox[{
         RowBox[{"rgm", "\[LeftDoubleBracket]", 
          RowBox[{"eftab2", ",", "eftab2"}], "\[RightDoubleBracket]"}], "+=", 
         "gmn"}], ";"}]}], "]"}], ";", 
     RowBox[{"Return", "[", "rgm", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656715364278243*^9, 3.6567154172462435`*^9}, 
   3.656715565789243*^9, {3.656715675034243*^9, 3.656715679941243*^9}, {
   3.656715718497243*^9, 3.6567158058122435`*^9}, {3.656715860600243*^9, 
   3.656716031454243*^9}, {3.656716167093243*^9, 3.656716258165243*^9}, {
   3.6567163035782433`*^9, 3.656716308351243*^9}, 3.656716382481243*^9, {
   3.6567164287392435`*^9, 3.656716455804634*^9}, {3.6567165231413674`*^9, 
   3.6567165616652193`*^9}, {3.6567165953255854`*^9, 
   3.6567166085319057`*^9}, {3.6567166984208937`*^9, 
   3.6567166989839497`*^9}, {3.656716999502999*^9, 3.6567170079568443`*^9}, {
   3.6568134842349157`*^9, 3.65681351250695*^9}, {3.65681467762495*^9, 
   3.65681467894895*^9}, {3.65681476111195*^9, 3.65681476229495*^9}, {
   3.656816043396242*^9, 3.6568160444044437`*^9}, {3.656816095191599*^9, 
   3.656816096611883*^9}, {3.6568161699895563`*^9, 3.6568162399915533`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ApplyConMasstoRGM", "[", 
   RowBox[{"nodmm_", ",", "rgm_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mm", ",", "ll", ",", "n", ",", "i", ",", "mt", ",", "i11", ",", "i22", 
      ",", "i33", ",", "i21", ",", "i31", ",", "i32"}], "}"}], ",", 
    RowBox[{
     RowBox[{"mm", "=", "rgm"}], ";", 
     RowBox[{"ll", "=", 
      RowBox[{"Length", "[", "nodmm", "]"}]}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "ll"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"nodmm", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"mt", "=", 
         RowBox[{"nodmm", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{
         RowBox[{"mm", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "5"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "4"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "3"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "2"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "1"}], ",", 
             RowBox[{"6", " ", "n"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "5"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "4"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "3"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "2"}], ",", 
             RowBox[{
              RowBox[{"6", " ", "n"}], "-", "1"}], ",", 
             RowBox[{"6", " ", "n"}]}], "}"}]}], "\[RightDoubleBracket]"}], "+=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{
             "mt", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", 
              RowBox[{
              "mt", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
             ",", "0"}], "}"}]}], "}"}]}], ";"}]}], "]"}], ";", 
     RowBox[{"Return", "[", "mm", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656716864429493*^9, 3.6567169534923983`*^9}, 
   3.6568134791014023`*^9, 3.65681351674995*^9}],

Cell[BoxData[
 RowBox[{"(*", "Test", "*)"}]], "Input",
 CellChangeTimes->{{3.6568225550934916`*^9, 3.6568225597139535`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nodcoor", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"200", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"300", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"elenod", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa", "=", 
     RowBox[{"{", 
      RowBox[{"628.3", ",", "628.3", ",", "628.3"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eledes", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"7.85", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "9"}]}]}], ",", 
       RowBox[{"7.85", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "9"}]}]}], ",", 
       RowBox[{"7.85", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "9"}]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"elemi", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"7854", ",", "7854"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7854", ",", "7854"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7854", ",", "7854"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"elemat", "=", 
     RowBox[{"{", 
      RowBox[{"210000", ",", "210000", ",", "210000"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nodtag", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nodspp", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"300", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"300", ",", "0", ",", "10"}], "}"}], ",", "100", ",", "10", 
        ",", "4"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"conmall", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"{", 
         RowBox[{
         "100", ",", "100", ",", "100", ",", "100", ",", "100", ",", "100", 
          ",", "100"}], "}"}]}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RotorModeC", "[", 
     RowBox[{
     "nodcoor", ",", "aa", ",", "elenod", ",", "eledes", ",", "elemat", ",", 
      "elemi", ",", "nodtag", ",", "nodspp", ",", "conmall", ",", "ksbeam"}], 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6567173075522394`*^9, 3.6567173111082397`*^9}, {
  3.6567173497262397`*^9, 3.6567174400102396`*^9}, {3.6567177001462393`*^9, 
  3.6567178233562393`*^9}, {3.6567363584171696`*^9, 3.656736465634595*^9}, {
  3.6567364986905713`*^9, 3.6567365031209145`*^9}, {3.6567366912701025`*^9, 
  3.6567367159021864`*^9}, {3.6567367530921097`*^9, 3.65673676869191*^9}, {
  3.656736939583024*^9, 3.6567369981602736`*^9}, {3.6568068662270484`*^9, 
  3.656806973998824*^9}, {3.657930782715831*^9, 3.657930863876946*^9}, {
  3.6581866033632936`*^9, 3.658186605017294*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.6567206972384605`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"krotor", "[", 
   RowBox[{"damp_", ",", "kr_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ti", ",", "kcv", ",", "kcgr", ",", "n", ",", "i", ",", "ta", ",", 
      "eft"}], "}"}], ",", 
    RowBox[{
     RowBox[{"ti", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0.5`", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "0.5`"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0.5`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
          RowBox[{"-", "0.5`"}], ",", "0"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "damp", "]"}]}], ";", 
     RowBox[{"ta", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", "n", ",", "n"}], "]"}]}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        FractionBox["n", "6"]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"eft", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"6", " ", "i"}], "-", "5"}], ",", 
           RowBox[{
            RowBox[{"6", " ", "i"}], "-", "4"}], ",", 
           RowBox[{
            RowBox[{"6", " ", "i"}], "-", "3"}], ",", 
           RowBox[{
            RowBox[{"6", " ", "i"}], "-", "2"}], ",", 
           RowBox[{
            RowBox[{"6", " ", "i"}], "-", "1"}], ",", 
           RowBox[{"6", " ", "i"}]}], "}"}]}], ";", 
        RowBox[{
         RowBox[{"ta", "\[LeftDoubleBracket]", 
          RowBox[{"eft", ",", "eft"}], "\[RightDoubleBracket]"}], "+=", 
         "ti"}], ";"}]}], "]"}], ";", 
     RowBox[{"kcv", "=", 
      RowBox[{
       RowBox[{"damp", ".", "ta"}], "+", 
       RowBox[{"ta", ".", "damp"}]}]}], ";", 
     RowBox[{"kcgr", "=", 
      RowBox[{
       RowBox[{"kr", ".", "ta"}], "+", 
       RowBox[{"ta", ".", "kr"}]}]}], ";", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"kcv", ",", "kcgr"}], "}"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6567191954720397`*^9, 3.6567193852616396`*^9}, {
   3.6567194482076397`*^9, 3.6567194753828397`*^9}, {3.656719760072059*^9, 
   3.6567198698721514`*^9}, {3.656719932503742*^9, 3.656719941644991*^9}, {
   3.656719977383216*^9, 3.656719988801977*^9}, {3.656720025803754*^9, 
   3.6567200644434676`*^9}, {3.6567202249789505`*^9, 3.656720308515344*^9}, {
   3.6567212941238985`*^9, 3.6567212943110957`*^9}, {3.6567213459620333`*^9, 
   3.6567213473036165`*^9}, 3.6568115611243086`*^9, {3.6568162835532637`*^9, 
   3.6568163002486024`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RotorModeC", "[", 
   RowBox[{
   "nodcoor_", ",", "Aa_", ",", "elenod_", ",", "eledes_", ",", "elemat_", 
    ",", "elemi_", ",", "nodtag_", ",", "nodsp_", ",", "nodconm_", ",", 
    "ksbeam_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mm", ",", "kk", ",", "al", ",", "kmod", ",", "ww", ",", "ei1", ",", 
      "ei2", ",", "\[Lambda]", ",", "cla", ",", "nnn", ",", "bbb", ",", "bb", 
      ",", "rgm", ",", "kcv", ",", "kcgr", ",", "ei2r", ",", "ei2i", ",", 
      "ei2d", ",", "np"}], "}"}], ",", 
    RowBox[{
     RowBox[{"mm", "=", 
      RowBox[{"SpaceTrassMasterMass", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "eledes", ",", "elemi", ",", 
        "elemat", ",", "ksbeam"}], "]"}]}], ";", 
     RowBox[{"np", "=", 
      RowBox[{"Length", "[", "mm", "]"}]}], ";", 
     RowBox[{"mm", "=", 
      RowBox[{"ApplyConMasstoMasterM", "[", 
       RowBox[{"nodconm", ",", "mm"}], "]"}]}], ";", 
     RowBox[{"kk", "=", 
      RowBox[{"SpaceTrassMasterStiffness", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "elemat", ",", "elemi", ",", 
        "ksbeam"}], "]"}]}], ";", 
     RowBox[{"mm", "=", 
      RowBox[{"SetPrecision", "[", 
       RowBox[{"mm", ",", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{"1.0", " ", "np"}], "]"}]}], "]"}]}], ";", 
     RowBox[{"kk", "=", 
      RowBox[{"SetPrecision", "[", 
       RowBox[{"kk", ",", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{"1.0", " ", "np"}], "]"}]}], "]"}]}], ";", 
     RowBox[{"nnn", "=", 
      RowBox[{"6", " ", 
       RowBox[{"Length", "[", "nodcoor", "]"}]}]}], ";", 
     RowBox[{"bb", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", "nnn", ",", "nnn"}], "]"}]}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Rotor Critical Speed&Log Decreasement\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "15"}], ",", 
            RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"VectorQ", "[", "nodsp", "]"}], ",", "Null", ",", 
       RowBox[{"kk", "=", 
        RowBox[{"ApplySpringToMaster", "[", 
         RowBox[{"nodsp", ",", "kk"}], "]"}]}]}], "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"VectorQ", "[", "nodsp", "]"}], ",", "Null", ",", 
       RowBox[{"bbb", "=", 
        RowBox[{"ApplySpringToMasterB", "[", 
         RowBox[{"nodsp", ",", "bb"}], "]"}]}]}], "]"}], ";", 
     RowBox[{"rgm", "=", 
      RowBox[{"RotorGyroscopic", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "eledes", ",", "elemi"}], 
       "]"}]}], ";", 
     RowBox[{"rgm", "=", 
      RowBox[{"ApplyConMasstoRGM", "[", 
       RowBox[{"nodconm", ",", "rgm"}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kcv", ",", "kcgr"}], "}"}], "=", 
      RowBox[{"krotor", "[", 
       RowBox[{"bbb", ",", "kk"}], "]"}]}], ";", 
     RowBox[{"kk", "=", 
      RowBox[{"ApplyDofToMaster", "[", 
       RowBox[{"nodtag", ",", "kk"}], "]"}]}], ";", 
     RowBox[{"mm", "=", 
      RowBox[{"ApplyDofToMaster", "[", 
       RowBox[{"nodtag", ",", "mm"}], "]"}]}], ";", 
     RowBox[{"mm", "=", 
      RowBox[{"SetPrecision", "[", 
       RowBox[{"mm", ",", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{"1.0", " ", "np"}], "]"}]}], "]"}]}], ";", 
     RowBox[{"kk", "=", 
      RowBox[{"SetPrecision", "[", 
       RowBox[{"kk", ",", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{"1.0", " ", "np"}], "]"}]}], "]"}]}], ";", 
     RowBox[{"rgm", "=", 
      RowBox[{"SetPrecision", "[", 
       RowBox[{"rgm", ",", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{"1.0", " ", "np"}], "]"}]}], "]"}]}], ";", 
     RowBox[{"bbb", "=", 
      RowBox[{"SetPrecision", "[", 
       RowBox[{"bbb", ",", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{"1.0", " ", "np"}], "]"}]}], "]"}]}], ";", 
     RowBox[{"kcv", "=", 
      RowBox[{"SetPrecision", "[", 
       RowBox[{"kcv", ",", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{"1.0", " ", "np"}], "]"}]}], "]"}]}], ";", 
     RowBox[{"cla", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mm", "-", 
          RowBox[{"rgm", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"bbb", "-", 
          RowBox[{"kcv", " ", "\[ImaginaryI]"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"cla", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"cla", ",", 
        RowBox[{"{", "kk", "}"}]}], "]"}]}], ";", 
     RowBox[{"ei2", "=", 
      RowBox[{"PolynomialEigenvalues", "[", "cla", "]"}]}], ";", 
     RowBox[{"ei2", "=", 
      RowBox[{"saa", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"N", "[", 
         RowBox[{"ei2", ",", "8"}], "]"}], "]"}]}]}], ";", 
     RowBox[{"ei2", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"ei2", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"Im", "[", "#1", "]"}], "]"}], "<", 
          RowBox[{"Abs", "[", 
           RowBox[{"Im", "[", "#2", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
     RowBox[{"ei2", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"ei2", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "#1", "]"}], ">", "1"}], "&"}], ",", "4"}], 
       "]"}]}], ";", 
     RowBox[{"ei2r", "=", 
      RowBox[{"Re", "[", "ei2", "]"}]}], ";", 
     RowBox[{"ei2i", "=", 
      RowBox[{"Im", "[", "ei2", "]"}]}], ";", 
     RowBox[{"ei2d", "=", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "ei2r"}], 
        RowBox[{"Abs", "[", "ei2i", "]"}]]}]}], ";", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"ei2i", ",", "ei2d"}], "}"}], "]"}], ";", 
     RowBox[{
     "Print", "[", "\"\<Log Decrement for the First Four Critical Speed:\>\"",
       "]"}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             FractionBox[
              RowBox[{"60", " ", "ei2i"}], 
              RowBox[{"2", " ", "\[Pi]"}]], ",", "ei2d"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Critical Speed(cpm)\>\"", ",", "\"\<Log Decrement\>\""}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}], ",", 
        RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6567204573367343`*^9, 3.656720458881115*^9}, {
   3.656720500485781*^9, 3.656720593613639*^9}, {3.6567206494896154`*^9, 
   3.6567206780671663`*^9}, {3.6567207265647683`*^9, 
   3.6567208120634356`*^9}, {3.6567209833465357`*^9, 3.656720985062492*^9}, {
   3.656731935990576*^9, 3.6567319642886133`*^9}, {3.656732637404383*^9, 
   3.6567326380907745`*^9}, 3.6567358599331503`*^9, {3.6567360329737387`*^9, 
   3.6567360689000783`*^9}, {3.656737105658495*^9, 3.6567371117424173`*^9}, {
   3.6568115109303083`*^9, 3.6568115301433086`*^9}, {3.6568118506943083`*^9, 
   3.6568118539633083`*^9}, {3.656811894821308*^9, 3.6568118974663086`*^9}, 
   3.6568163815405025`*^9, {3.6568167490752525`*^9, 3.6568167523055754`*^9}, {
   3.6568182546341395`*^9, 3.6568182655381393`*^9}, {3.657341610428893*^9, 
   3.65734162401952*^9}, {3.6573417287774677`*^9, 3.657341770608832*^9}, {
   3.6575890743319135`*^9, 3.657589113798805*^9}, {3.6575892112240753`*^9, 
   3.6575892615401063`*^9}, {3.6575898600158596`*^9, 
   3.6575899181598597`*^9}, {3.6575899789828596`*^9, 3.65758997986886*^9}, {
   3.65759005361186*^9, 3.6575900642248597`*^9}, {3.6575900990768595`*^9, 
   3.6575901003428597`*^9}, {3.6575901375468597`*^9, 
   3.6575901615888596`*^9}, {3.65759054706586*^9, 3.65759055137286*^9}, {
   3.6575911141528597`*^9, 3.6575912326848598`*^9}, {3.6575912906198597`*^9, 
   3.65759129617686*^9}, {3.65759133404986*^9, 3.65759133431486*^9}, {
   3.65759137733286*^9, 3.65759138433486*^9}, {3.6575914256808596`*^9, 
   3.65759146877586*^9}, {3.65759153674386*^9, 3.6575915588718596`*^9}, {
   3.65759160654986*^9, 3.65759163146486*^9}, {3.65759170303786*^9, 
   3.65759171805886*^9}, {3.6575918343558598`*^9, 3.6575918380088596`*^9}, {
   3.65759206633286*^9, 3.65759215968386*^9}, {3.65759220694386*^9, 
   3.6575922511478596`*^9}, {3.65792984492533*^9, 3.6579298866783304`*^9}, {
   3.6580262477997046`*^9, 3.6580262565354247`*^9}, 3.658188231772294*^9, {
   3.658188305807294*^9, 3.6581883367892942`*^9}, {3.658188419204294*^9, 
   3.658188425273294*^9}, {3.658188504564644*^9, 3.658188507810969*^9}, {
   3.6581885890690937`*^9, 3.6581885917883654`*^9}, {3.6581890220493875`*^9, 
   3.658189032705453*^9}, {3.6581949366842837`*^9, 3.6581949871182837`*^9}, {
   3.6581950519472837`*^9, 3.658195057891284*^9}, {3.6581950972512836`*^9, 
   3.6581951003502836`*^9}, {3.658527342970009*^9, 3.6585273465330086`*^9}, {
   3.658531665707245*^9, 3.6585316702652445`*^9}, {3.6586166709344254`*^9, 
   3.658616695759425*^9}, {3.6586167721654253`*^9, 3.6586167789284253`*^9}, {
   3.658617184265425*^9, 3.6586171984394255`*^9}, {3.658617292362425*^9, 
   3.6586174085144253`*^9}, {3.658617461423425*^9, 3.658617467155425*^9}, {
   3.658617505723425*^9, 3.6586175090194254`*^9}, {3.6586175940264254`*^9, 
   3.6586176293564253`*^9}, {3.658617697318425*^9, 3.658617767635425*^9}, {
   3.6586178987154255`*^9, 3.658617916265425*^9}, {3.658618082391425*^9, 
   3.658618099470425*^9}, {3.6586181886818004`*^9, 3.658618188953828*^9}, {
   3.6586371270114017`*^9, 3.6586371906564016`*^9}, {3.6586377570924454`*^9, 
   3.658637765529133*^9}, {3.658637847152454*^9, 3.6586378539578147`*^9}, {
   3.6586378866403503`*^9, 3.6586378887287674`*^9}, {3.6586383034410496`*^9, 
   3.6586383176604714`*^9}, {3.6599102783608694`*^9, 3.6599102810408697`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6568226030082827`*^9, 3.6568226393419156`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SpaceTrussDFR", "[", 
    RowBox[{
    "nodcoor_", ",", "elenod_", ",", "elemat_", ",", "Aa_", ",", "nodtag_", 
     ",", "nodval_", ",", "nodsp_", ",", "elemi_", ",", "ww_", ",", 
     "nodconm_", ",", "eledes_", ",", "ksbeam_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "K", ",", "Kmod", ",", "f", ",", "fmod", ",", "u", ",", "noddis", ",", 
       "nodfor", ",", "elefor", ",", "elesig", ",", "He", ",", "nodcoorc", 
       ",", "noddisc", ",", "comb", ",", "Title", ",", "mm", ",", "nnn", ",", 
       "kk", ",", "bbb", ",", "bb", ",", "sft", ",", "comb1", ",", "comb2", 
       ",", "ww0", ",", "wwe", ",", "wwp", ",", "noddisall", ",", "Kmodl", 
       ",", "wwn", ",", "wwall", ",", "i", ",", "fmodrd", ",", "nodsp1"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"K", "=", 
       RowBox[{"SpaceTrassMasterStiffness", "[", 
        RowBox[{
        "nodcoor", ",", " ", "elenod", ",", " ", "Aa", ",", " ", "elemat", 
         ",", " ", "elemi", ",", "ksbeam"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"noddisall", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wwall", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ww0", ",", "wwe", ",", "wwp"}], "}"}], "=", 
       RowBox[{"ww", "*", "2", "*", "Pi"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mm", "=", 
       RowBox[{"SpaceTrassMasterMass", "[", 
        RowBox[{
        "nodcoor", ",", "elenod", ",", "Aa", ",", "eledes", ",", "elemi", ",",
          "elemat", ",", "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mm", "=", 
       RowBox[{"ApplyConMasstoMasterM", "[", 
        RowBox[{"nodconm", ",", "mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nnn", "=", 
       RowBox[{"6", "*", 
        RowBox[{"Length", "[", "nodcoor", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mm", "=", 
       RowBox[{"ApplyDofToMaster", "[", 
        RowBox[{"nodtag", ",", "mm"}], "]"}]}], ";", 
      RowBox[{"f", "=", 
       RowBox[{"FlatNodePartVector", "[", "nodval", "]"}]}], ";", 
      RowBox[{"fmod", "=", 
       RowBox[{"ApplyLoad", "[", 
        RowBox[{"nodtag", ",", "nodval", ",", "K", ",", "f"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"wwn", "=", "ww0"}], ",", 
        RowBox[{"wwn", "\[LessEqual]", "wwe"}], ",", 
        RowBox[{"wwn", "+=", "wwp"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nodsp1", "=", "nodsp"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Kmod", "=", "K"}], ";", "\[IndentingNewLine]", 
         RowBox[{"bb", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", "nnn", ",", "nnn"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"VectorQ", "[", "nodsp1", "]"}], ",", "Null", ",", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", 
              RowBox[{"Length", "[", "nodsp1", "]"}]}], ",", 
             RowBox[{"i", "++"}], ",", 
             RowBox[{
              RowBox[{"Quiet", "[", 
               RowBox[{
                RowBox[{"nodsp1", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3"}], "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"Interpolation", "[", 
                  RowBox[{
                   RowBox[{"nodsp1", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
                   RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                 "[", 
                 RowBox[{"wwn", "*", 
                  RowBox[{"60", "/", 
                   RowBox[{"(", 
                    RowBox[{"2", "*", "Pi"}], ")"}]}]}], "]"}]}], "]"}], ";", 
              RowBox[{"Quiet", "[", 
               RowBox[{
                RowBox[{"nodsp1", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "4"}], "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"Interpolation", "[", 
                  RowBox[{
                   RowBox[{"nodsp1", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "4"}], "]"}], "]"}], ",", 
                   RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                 "[", 
                 RowBox[{"wwn", "*", 
                  RowBox[{"60", "/", 
                   RowBox[{"(", 
                    RowBox[{"2", "*", "Pi"}], ")"}]}]}], "]"}]}], "]"}]}]}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"VectorQ", "[", "nodsp1", "]"}], ",", "Null", ",", 
           RowBox[{"bb", "=", 
            RowBox[{"ApplySpringToMasterB", "[", 
             RowBox[{"nodsp1", ",", "bb"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"VectorQ", "[", "nodsp1", "]"}], ",", "Null", ",", 
           RowBox[{"Kmod", "=", 
            RowBox[{"ApplySpringToMaster", "[", 
             RowBox[{"nodsp1", ",", "K"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Kmod", "=", 
          RowBox[{"ApplyDofToMaster", "[", 
           RowBox[{"nodtag", ",", "Kmod"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Kmodl", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", 
              RowBox[{"wwn", "^", "2"}]}], ")"}], "*", "mm"}], "+", 
           RowBox[{"wwn", "*", "bb", "*", "I"}], "+", "Kmod"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fmodrd", "=", "fmod"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"wwn", "/", 
             RowBox[{"(", 
              RowBox[{"2", "*", "Pi"}], ")"}]}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", 
              RowBox[{"Length", "[", "nodum", "]"}]}], ",", 
             RowBox[{"i", "++"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nodum", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[NotEqual]", "0"}],
                ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"fmodrd", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"6", "*", "i"}], "-", "4"}], "]"}], "]"}], "+=", 
                 RowBox[{"1", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "*", 
                    RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
                    RowBox[{"wwn", "^", "2"}], "*", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}]}], "+", 
                    RowBox[{"I", "*", 
                    RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
                    RowBox[{"wwn", "^", "2"}], "*", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}]}]}], 
                   ")"}]}]}], ";", 
                RowBox[{
                 RowBox[{"fmodrd", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"6", "*", "i"}], "-", "3"}], "]"}], "]"}], "+=", 
                 RowBox[{"1", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "*", 
                    RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
                    RowBox[{"wwn", "^", "2"}], "*", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}]}], "-", 
                    RowBox[{"I", "*", 
                    RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
                    RowBox[{"wwn", "^", "2"}], "*", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}]}]}], 
                   ")"}]}]}]}], ",", "Null"}], "]"}]}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"u", "=", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{"Kmodl", ",", "fmodrd"}], "]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"u", "=", 
            RowBox[{"Chop", "[", "u", "]"}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"He", "=", "0.5"}], ";", "\[IndentingNewLine]", 
         RowBox[{"f", "=", 
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{"K", ".", "u"}], ",", 
            FractionBox["1", 
             SuperscriptBox["10.", "8"]]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nodfor", "=", 
          RowBox[{"NodePartFlatVector", "[", 
           RowBox[{"6", ",", "f"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"noddis", "=", 
          RowBox[{"NodePartFlatVector", "[", 
           RowBox[{"6", ",", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"noddisall", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"noddisall", ",", "noddis"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sft", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"SpanFromAbove", ",", 
            RowBox[{"Length", "[", "nodcoor", "]"}], ",", "3"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"comb1", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"nodcoor", ",", 
            RowBox[{"Re", "[", "noddis", "]"}], ",", "2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"comb2", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"sft", ",", 
            RowBox[{"Im", "[", "noddis", "]"}], ",", "2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"comb", "=", 
          RowBox[{"Riffle", "[", 
           RowBox[{"comb1", ",", "comb2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Title", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Text", "[", "\"\<Node Coordinate\>\"", "]"}], ",", 
            "SpanFromLeft", ",", "SpanFromLeft", ",", 
            RowBox[{
            "Text", "[", "\"\<Node Displacement(Real/Imag)\>\"", "]"}], ",", 
            "SpanFromLeft", ",", "SpanFromLeft", ",", "SpanFromLeft", ",", 
            "SpanFromLeft", ",", "SpanFromLeft"}], "}"}]}], ";", 
         RowBox[{"comb", "=", 
          RowBox[{"Prepend", "[", 
           RowBox[{"comb", ",", "Title"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Node Displacement Result:\>\"", ",", 
             RowBox[{
              RowBox[{"ScientificForm", "[", 
               RowBox[{
                RowBox[{"Grid", "[", 
                 RowBox[{"comb", ",", 
                  RowBox[{"Frame", "\[Rule]", "All"}], ",", 
                  RowBox[{"ItemSize", "\[Rule]", "All"}], ",", 
                  RowBox[{"ItemStyle", "\[Rule]", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"FontSize", "\[Rule]", "8"}], "]"}]}]}], "]"}], 
                ",", "5"}], "]"}], "//", "MatrixForm"}]}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"wwall", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"wwall", ",", 
            RowBox[{"wwn", "/", 
             RowBox[{"(", 
              RowBox[{"2", "*", "Pi"}], ")"}]}]}], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"elefor", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{"SpaceTrussIntForces", "[", 
           RowBox[{
           "nodcoor", ",", "elenod", ",", "elemat", ",", "Aa", ",", "noddis", 
            ",", "He"}], "]"}], "]"}]}], ";", 
        RowBox[{"elesig", "=", 
         RowBox[{"SpaceTrussStresses", "[", 
          RowBox[{"Aa", ",", "elefor", ",", "elenod"}], "]"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"noddisall", "=", 
       RowBox[{"Flatten", "[", "noddisall", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"noddisall", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{"noddisall", ",", "nnn"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", "\"\<Input Plot Freedom(eg.Node6,Ux->6*6-5=31):\>\"", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"InputField", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "DFRNode", "]"}], ",", 
         RowBox[{"FieldSize", "\[Rule]", "Tiny"}]}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DFRNode", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Manipulate", "[", 
        RowBox[{
         RowBox[{"STDFRPlot", "[", 
          RowBox[{"wwall", ",", "noddisall", ",", "DFRNode"}], "]"}], ",", 
         RowBox[{"Text", "[", "\"\<Bode Plot\>\"", "]"}]}], "]"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6568226707150526`*^9, 3.656822672600241*^9}, {
   3.656824256632064*^9, 3.656824258139064*^9}, {3.6568242921810637`*^9, 
   3.656824314012064*^9}, {3.656824344544064*^9, 3.656824346974064*^9}, {
   3.656824446189064*^9, 3.656824480118064*^9}, {3.656824539143064*^9, 
   3.656824632315064*^9}, {3.656891418623028*^9, 3.6568914197419157`*^9}, {
   3.656891844882636*^9, 3.6568918452306366`*^9}, {3.656893795163456*^9, 
   3.6568939074856315`*^9}, {3.6568939397296314`*^9, 3.6568939477646313`*^9}, 
   3.6568940467946315`*^9, {3.6568940927616315`*^9, 3.6568940983206315`*^9}, {
   3.656898244825778*^9, 3.656898330279087*^9}, {3.656898544430087*^9, 
   3.656898594235087*^9}, {3.6568986265580873`*^9, 3.656898631588087*^9}, {
   3.656898860194087*^9, 3.656898918805087*^9}, {3.656899017359087*^9, 
   3.656899058622087*^9}, {3.656899092779087*^9, 3.656899096894087*^9}, {
   3.656899177536087*^9, 3.656899229208087*^9}, {3.656899417957087*^9, 
   3.656899441643087*^9}, {3.656899527463087*^9, 3.656899579509087*^9}, {
   3.6568997134810867`*^9, 3.656899733273087*^9}, {3.656900062476087*^9, 
   3.656900197839087*^9}, {3.656900258894087*^9, 3.656900267029087*^9}, {
   3.656900570784087*^9, 3.6569006477560873`*^9}, 3.657231019655635*^9, {
   3.6572310863996353`*^9, 3.6572312873266354`*^9}, {3.6572315848220406`*^9, 
   3.6572316906398726`*^9}, {3.6572318043120546`*^9, 
   3.6572318915690546`*^9}, {3.6572351305264225`*^9, 
   3.6572351355924225`*^9}, {3.657235166221422*^9, 3.6572351761844225`*^9}, {
   3.6572354107064223`*^9, 3.6572354138384223`*^9}, {3.6572355388104224`*^9, 
   3.6572355861994224`*^9}, {3.6572356636124225`*^9, 
   3.6572356727954226`*^9}, {3.6572357947274227`*^9, 
   3.6572357949174223`*^9}, {3.6572358251874228`*^9, 
   3.6572358445274224`*^9}, {3.6572359019794226`*^9, 
   3.6572359123904223`*^9}, {3.6572359520004225`*^9, 
   3.6572359523234224`*^9}, {3.6572368280189495`*^9, 3.657236834898325*^9}, {
   3.6572369548298635`*^9, 3.6572369648888693`*^9}, {3.657236997849165*^9, 
   3.657237003366717*^9}, {3.6572372080311813`*^9, 3.657237214568835*^9}, {
   3.6572375093863993`*^9, 3.6572375868096952`*^9}, {3.657237728755005*^9, 
   3.6572377400494776`*^9}, {3.657237799501272*^9, 3.657237799719672*^9}, {
   3.6572444834045763`*^9, 3.657244491546889*^9}, {3.6572445280625095`*^9, 
   3.657244528483663*^9}, {3.657248731004216*^9, 3.657248762968207*^9}, {
   3.6572490286952*^9, 3.65724904819495*^9}, {3.6572492324129877`*^9, 
   3.6572492413672733`*^9}, {3.6572493073388276`*^9, 
   3.6572493120811667`*^9}, {3.657252596254155*^9, 3.657252600388076*^9}, {
   3.657252751394752*^9, 3.6572527585082607`*^9}, {3.657252875335163*^9, 
   3.6572528826826687`*^9}, {3.6572529240689383`*^9, 
   3.6572529242093363`*^9}, {3.65725382908554*^9, 3.657253830458322*^9}, {
   3.657254716020794*^9, 3.657254728063839*^9}, {3.65725477088529*^9, 
   3.6572548010553036`*^9}, {3.657315239761221*^9, 3.6573152456052237`*^9}, {
   3.65731553594989*^9, 3.657315557342476*^9}, {3.657316240537221*^9, 
   3.6573162450398693`*^9}, {3.65731732241969*^9, 3.6573173249834337`*^9}, {
   3.6573235358148565`*^9, 3.6573235676730423`*^9}, {3.6573237005813313`*^9, 
   3.6573237383681097`*^9}, {3.6573240245967293`*^9, 
   3.6573240307363434`*^9}, {3.6573240845777273`*^9, 3.657324097395009*^9}, {
   3.657324132729542*^9, 3.657324139661235*^9}, {3.657324221931349*^9, 
   3.657324222186323*^9}, {3.6573243373558054`*^9, 3.6573243696645737`*^9}, 
   3.6573245666029067`*^9, {3.6573246329319067`*^9, 3.657324659356907*^9}, {
   3.6573253286886387`*^9, 3.6573253350969977`*^9}, {3.657325397848722*^9, 
   3.6573254309894075`*^9}, {3.6573255656079082`*^9, 
   3.6573255943799086`*^9}, {3.6573256317469087`*^9, 3.6573257320969086`*^9}, 
   3.6573259286559086`*^9, {3.6573260210419083`*^9, 3.6573260266089087`*^9}, 
   3.6573326267209015`*^9, {3.657332668110902*^9, 3.657332880028902*^9}, {
   3.657332933450902*^9, 3.657332949759902*^9}, {3.657333107867902*^9, 
   3.657333108587902*^9}, {3.657333191188902*^9, 3.657333224576902*^9}, {
   3.6573332673629017`*^9, 3.657333277226902*^9}, {3.6573333084119015`*^9, 
   3.657333350264902*^9}, {3.6573333899219017`*^9, 3.657333405532902*^9}, {
   3.657333459013002*^9, 3.6573334668257833`*^9}, {3.6573335208741875`*^9, 
   3.657333525265627*^9}, {3.657333559172017*^9, 3.65733356340344*^9}, {
   3.657334105502898*^9, 3.6573341212688985`*^9}, {3.6573368784688983`*^9, 
   3.6573368787968984`*^9}, 3.6573374479118986`*^9, {3.6578404252502117`*^9, 
   3.6578404961842117`*^9}, {3.657847880368203*^9, 3.657847882611203*^9}, {
   3.6578488359122*^9, 3.6578488476152*^9}, {3.658026263945187*^9, 
   3.658026271401748*^9}, {3.6585273556760087`*^9, 3.6585273589810085`*^9}, {
   3.6586128776736393`*^9, 3.6586128880706396`*^9}, 3.658613212048913*^9, 
   3.6586133486135683`*^9, {3.658613420078714*^9, 3.6586134281055164`*^9}, {
   3.658614240441742*^9, 3.6586142542171197`*^9}, {3.6586147689365864`*^9, 
   3.6586147692036133`*^9}}],

Cell[BoxData[""], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656901572765087*^9, 3.656901911038087*^9}, {
   3.656901966751087*^9, 3.656901989743087*^9}, {3.6569030915154495`*^9, 
   3.65690313858245*^9}, {3.6569032199874496`*^9, 3.65690322288445*^9}, {
   3.6569047605194497`*^9, 3.65690479554245*^9}, {3.6569051793054495`*^9, 
   3.65690518101045*^9}, {3.6569052359214497`*^9, 3.65690529737545*^9}, {
   3.6569053632434497`*^9, 3.65690538929245*^9}, {3.6569054554664497`*^9, 
   3.6569055201804495`*^9}, {3.65690563378645*^9, 3.6569056550274496`*^9}, {
   3.65690571917545*^9, 3.65690573865545*^9}, {3.65690577885145*^9, 
   3.65690578280145*^9}, {3.65690587058045*^9, 3.6569058766974497`*^9}, {
   3.65690591406845*^9, 3.65690591909945*^9}, {3.65690597466145*^9, 
   3.6569059771264496`*^9}, {3.6569917408514156`*^9, 3.65699177579591*^9}, {
   3.6569918110184317`*^9, 3.6569918112424536`*^9}, {3.656991860359365*^9, 
   3.656991863979727*^9}, {3.656991895051834*^9, 3.656991926655994*^9}, {
   3.656992766588873*^9, 3.656992870668873*^9}, {3.6569929588518724`*^9, 
   3.656992959200873*^9}, {3.656993846720873*^9, 3.6569938996568727`*^9}, {
   3.6569942012818727`*^9, 3.6569942027698727`*^9}, {3.6569945545076904`*^9, 
   3.6569945631145515`*^9}, {3.6569967961074214`*^9, 
   3.6569969251554213`*^9}, {3.6572289375666113`*^9, 
   3.6572289600328965`*^9}, {3.6573168009250975`*^9, 
   3.6573168303370976`*^9}, {3.6573174859580994`*^9, 
   3.6573174894130993`*^9}, {3.6573188363710976`*^9, 
   3.6573188399280977`*^9}, {3.6573213203661404`*^9, 
   3.6573213298410883`*^9}, {3.6573226960150943`*^9, 3.657322799385094*^9}, {
   3.6573228626700945`*^9, 3.6573228694480944`*^9}, {3.657322905957094*^9, 
   3.6573229064340944`*^9}, {3.657322939194094*^9, 3.657322939619094*^9}, {
   3.657323064841094*^9, 3.657323065063094*^9}, {3.657340650000893*^9, 
   3.657340652763893*^9}, {3.657340882367893*^9, 3.657340919130893*^9}, 
   3.65750578360466*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nodcoor", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"200", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"300", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elenod", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{"{", 
    RowBox[{"628.3", ",", "628.3", ",", "628.3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eledes", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}], ",", 
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}], ",", 
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elemi", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7854", ",", "7854"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7854", ",", "7854"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7854", ",", "7854"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elemat", "=", 
   RowBox[{"{", 
    RowBox[{"210000", ",", "210000", ",", "210000"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodtag", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodspp", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"300", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"300", ",", "0", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "100"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "10"}], "}"}]}], "}"}], ",", "4"}], "}"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conmall", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"3", ",", 
      RowBox[{"{", 
       RowBox[{
       "100", ",", "100", ",", "100", ",", "100", ",", "100", ",", "100", ",",
         "100"}], "}"}]}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodval", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "111", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodum", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ww", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "200", ",", "20"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"std1", ",", "std2"}], "}"}], "=", 
    RowBox[{"SpaceTrussDFR", "[", 
     RowBox[{
     "nodcoor", ",", "elenod", ",", "elemat", ",", "aa", ",", "nodtag", ",", 
      "nodval", ",", "nodspp", ",", "elemi", ",", "ww", ",", "conmall", ",", 
      "eledes"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.656891428906999*^9, 3.6568915272946367`*^9}, {
   3.656891559349636*^9, 3.6568916030606365`*^9}, {3.6568917342896366`*^9, 
   3.656891738500636*^9}, {3.656899238217087*^9, 3.656899258213087*^9}, {
   3.656899762982087*^9, 3.656899764423087*^9}, 3.656899799741087*^9, {
   3.656900274869087*^9, 3.656900283269087*^9}, {3.656900654880087*^9, 
   3.6569006607190866`*^9}, {3.656901918114087*^9, 3.6569019469150867`*^9}, {
   3.65690361984445*^9, 3.6569036424664497`*^9}, {3.65690441503745*^9, 
   3.65690442726845*^9}, 3.6569943199538727`*^9, {3.6569943649228725`*^9, 
   3.6569943801838727`*^9}, {3.6572353710464225`*^9, 3.657235401412422*^9}, {
   3.657235556098422*^9, 3.657235557681422*^9}, {3.6572360275734224`*^9, 
   3.6572360714504223`*^9}, 3.657237301051482*^9, {3.6572377181937375`*^9, 
   3.6572377203933516`*^9}, {3.6572377883316727`*^9, 3.657237791779272*^9}, {
   3.6572436768745813`*^9, 3.6572437375578036`*^9}, {3.6572437801608577`*^9, 
   3.657243780332455*^9}, {3.6572439202314615`*^9, 3.6572439244434075`*^9}, {
   3.6572440762750664`*^9, 3.657244076399865*^9}, {3.6572442036374397`*^9, 
   3.6572442082237806`*^9}, 3.6572442819272385`*^9, {3.657245274795761*^9, 
   3.657245302640333*^9}, {3.6572454139562244`*^9, 3.6572454140966167`*^9}, 
   3.6572456637107725`*^9, {3.657248629090723*^9, 3.6572486372806177`*^9}, {
   3.657248668573817*^9, 3.657248674735738*^9}, {3.6572512928102508`*^9, 
   3.657251297629755*^9}, 3.6572539955884237`*^9, {3.6572555463586087`*^9, 
   3.6572555823737583`*^9}, {3.657255654456275*^9, 3.6572556768562956`*^9}, {
   3.6572562835001354`*^9, 3.6572562927507577`*^9}, 3.6572568359097385`*^9, {
   3.6573155041297417`*^9, 3.657315507582286*^9}, 3.6573155945450044`*^9, {
   3.6573157820697303`*^9, 3.657315798675747*^9}, {3.657324109969266*^9, 
   3.6573241133106003`*^9}, {3.65732423111843*^9, 3.657324261806361*^9}, {
   3.6573242919973416`*^9, 3.6573242966608753`*^9}, {3.657324345767964*^9, 
   3.657324348448696*^9}, {3.6573244619353456`*^9, 3.6573244783497047`*^9}, {
   3.6573245137379065`*^9, 3.6573245434929066`*^9}, 3.657324574104907*^9, {
   3.6573260338789086`*^9, 3.6573260380489087`*^9}, {3.657333657471846*^9, 
   3.6573336868057795`*^9}, {3.6573341696578984`*^9, 3.657334185721898*^9}, {
   3.6573351091698985`*^9, 3.6573351134288983`*^9}, 3.657337482509898*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RotorDFR", "[", 
   RowBox[{
   "nodcoor_", ",", "elenod_", ",", "elemat_", ",", "Aa_", ",", "nodtag_", 
    ",", "nodval_", ",", "nodsp_", ",", "elemi_", ",", "ww_", ",", "nodconm_",
     ",", "eledes_", ",", "nodum_", ",", "RDFRNode_", ",", "ksbeam_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "K", ",", "Kmod", ",", "f", ",", "fmod", ",", "u", ",", "noddis", ",", 
      "nodfor", ",", "elefor", ",", "elesig", ",", "He", ",", "nodcoorc", ",",
       "noddisc", ",", "comb", ",", "Title", ",", "mm", ",", "nnn", ",", "kk",
       ",", "bbb", ",", "bb", ",", "sft", ",", "comb1", ",", "comb2", ",", 
      "ww0", ",", "wwe", ",", "wwp", ",", "noddisall", ",", "Kmodl", ",", 
      "wwn", ",", "wwall", ",", "i", ",", "fmodrd", ",", "rgm", ",", "nodsp1",
       ",", "kcv", ",", "kcgr"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"K", "=", 
      RowBox[{"SpaceTrassMasterStiffness", "[", 
       RowBox[{
       "nodcoor", ",", " ", "elenod", ",", " ", "Aa", ",", " ", "elemat", ",",
         " ", "elemi", ",", "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"noddisall", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"wwall", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ww0", ",", "wwe", ",", "wwp"}], "}"}], "=", 
      RowBox[{"ww", "*", "2", "*", "Pi"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Rotor Direct Frequency Response\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "15"}], ",", 
            RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mm", "=", 
      RowBox[{"SpaceTrassMasterMass", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "eledes", ",", "elemi", ",", 
        "elemat", ",", "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mm", "=", 
      RowBox[{"ApplyConMasstoMasterM", "[", 
       RowBox[{"nodconm", ",", "mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nnn", "=", 
      RowBox[{"6", "*", 
       RowBox[{"Length", "[", "nodcoor", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rgm", "=", 
      RowBox[{"RotorGyroscopic", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "eledes", ",", "elemi"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rgm", "=", 
      RowBox[{"ApplyConMasstoRGM", "[", 
       RowBox[{"nodconm", ",", "rgm"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mm", "=", 
      RowBox[{"mm", "-", 
       RowBox[{"I", "*", "rgm"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mm", "=", 
      RowBox[{"ApplyDofToMaster", "[", 
       RowBox[{"nodtag", ",", "mm"}], "]"}]}], ";", 
     RowBox[{"f", "=", 
      RowBox[{"FlatNodePartVector", "[", "nodval", "]"}]}], ";", 
     RowBox[{"fmod", "=", 
      RowBox[{"ApplyLoad", "[", 
       RowBox[{"nodtag", ",", "nodval", ",", "K", ",", "f"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"wwn", "=", "ww0"}], ",", 
       RowBox[{"wwn", "\[LessEqual]", "wwe"}], ",", 
       RowBox[{"wwn", "+=", "wwp"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nodsp1", "=", "nodsp"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Kmod", "=", "K"}], ";", "\[IndentingNewLine]", 
        RowBox[{"bb", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", "nnn", ",", "nnn"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VectorQ", "[", "nodsp1", "]"}], ",", "Null", ",", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "\[LessEqual]", 
             RowBox[{"Length", "[", "nodsp1", "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", 
            RowBox[{
             RowBox[{"Quiet", "[", 
              RowBox[{
               RowBox[{"nodsp1", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{"nodsp1", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                "[", 
                RowBox[{"wwn", "*", 
                 RowBox[{"60", "/", 
                  RowBox[{"(", 
                   RowBox[{"2", "*", "Pi"}], ")"}]}]}], "]"}]}], "]"}], ";", 
             RowBox[{"Quiet", "[", 
              RowBox[{
               RowBox[{"nodsp1", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "4"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{"nodsp1", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "4"}], "]"}], "]"}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                "[", 
                RowBox[{"wwn", "*", 
                 RowBox[{"60", "/", 
                  RowBox[{"(", 
                   RowBox[{"2", "*", "Pi"}], ")"}]}]}], "]"}]}], "]"}]}]}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VectorQ", "[", "nodsp1", "]"}], ",", "Null", ",", 
          RowBox[{"bb", "=", 
           RowBox[{"ApplySpringToMasterB", "[", 
            RowBox[{"nodsp1", ",", "bb"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VectorQ", "[", "nodsp1", "]"}], ",", "Null", ",", 
          RowBox[{"Kmod", "=", 
           RowBox[{"ApplySpringToMaster", "[", 
            RowBox[{"nodsp1", ",", "K"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"kcv", ",", "kcgr"}], "}"}], "=", 
         RowBox[{"krotor", "[", 
          RowBox[{"bb", ",", "Kmod"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bb", "=", 
         RowBox[{"bb", "-", 
          RowBox[{"kcv", "*", "I"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Kmod", "=", 
         RowBox[{"ApplyDofToMaster", "[", 
          RowBox[{"nodtag", ",", "Kmod"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Kmodl", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"wwn", "^", "2"}]}], ")"}], "*", "mm"}], "+", 
          RowBox[{"wwn", "*", "bb", "*", "I"}], "+", "Kmod"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fmodrd", "=", "fmod"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "nodum", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"nodum", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[NotEqual]", "0"}], 
            ",", 
            RowBox[{
             RowBox[{
              RowBox[{"fmodrd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"6", "*", "i"}], "-", "4"}], "]"}], "]"}], "+=", 
              RowBox[{
               RowBox[{"-", "1"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "1"}], "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
                  RowBox[{"wwn", "^", "2"}], "*", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}]}], "-", 
                 RowBox[{"I", "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
                  RowBox[{"wwn", "^", "2"}], "*", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}]}]}], 
                ")"}]}]}], ";", 
             RowBox[{
              RowBox[{"fmodrd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"6", "*", "i"}], "-", "3"}], "]"}], "]"}], "+=", 
              RowBox[{
               RowBox[{"-", "1"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "1"}], "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
                  RowBox[{"wwn", "^", "2"}], "*", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}]}], "+", 
                 RowBox[{"I", "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
                  RowBox[{"wwn", "^", "2"}], "*", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}]}]}], 
                ")"}]}]}]}], ",", "Null"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u", "=", 
         RowBox[{"Quiet", "[", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{"Kmodl", ",", "fmodrd"}], "]"}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"u", "=", 
           RowBox[{"Chop", "[", "u", "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"He", "=", "0.5"}], ";", "\[IndentingNewLine]", 
        RowBox[{"f", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"K", ".", "u"}], ",", 
           FractionBox["1", 
            SuperscriptBox["10.", "8"]]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nodfor", "=", 
         RowBox[{"NodePartFlatVector", "[", 
          RowBox[{"6", ",", "f"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"noddis", "=", 
         RowBox[{"NodePartFlatVector", "[", 
          RowBox[{"6", ",", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"noddisall", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"noddisall", ",", "noddis"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sft", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"SpanFromAbove", ",", 
           RowBox[{"Length", "[", "nodcoor", "]"}], ",", "3"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"comb1", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"nodcoor", ",", 
           RowBox[{"Re", "[", "noddis", "]"}], ",", "2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"comb2", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"sft", ",", 
           RowBox[{"Im", "[", "noddis", "]"}], ",", "2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"comb", "=", 
         RowBox[{"Riffle", "[", 
          RowBox[{"comb1", ",", "comb2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Title", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Text", "[", "\"\<Node Coordinate\>\"", "]"}], ",", 
           "SpanFromLeft", ",", "SpanFromLeft", ",", 
           RowBox[{"Text", "[", "\"\<Node Displacement(Real/Imag)\>\"", "]"}],
            ",", "SpanFromLeft", ",", "SpanFromLeft", ",", "SpanFromLeft", 
           ",", "SpanFromLeft", ",", "SpanFromLeft"}], "}"}]}], ";", 
        RowBox[{"comb", "=", 
         RowBox[{"Prepend", "[", 
          RowBox[{"comb", ",", "Title"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Node Displacement Result:\>\"", ",", 
            RowBox[{
             RowBox[{"ScientificForm", "[", 
              RowBox[{
               RowBox[{"Grid", "[", 
                RowBox[{"comb", ",", 
                 RowBox[{"Frame", "\[Rule]", "All"}], ",", 
                 RowBox[{"ItemSize", "\[Rule]", "All"}], ",", 
                 RowBox[{"ItemStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"FontSize", "\[Rule]", "8"}], "]"}]}]}], "]"}], 
               ",", "5"}], "]"}], "//", "MatrixForm"}]}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"wwall", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"wwall", ",", 
           RowBox[{"wwn", "/", 
            RowBox[{"(", 
             RowBox[{"2", "*", "Pi"}], ")"}]}]}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"elefor", "=", 
        RowBox[{"Chop", "[", 
         RowBox[{"SpaceTrussIntForces", "[", 
          RowBox[{
          "nodcoor", ",", "elenod", ",", "elemat", ",", "Aa", ",", "noddis", 
           ",", "He"}], "]"}], "]"}]}], ";", 
       RowBox[{"elesig", "=", 
        RowBox[{"SpaceTrussStresses", "[", 
         RowBox[{"Aa", ",", "elefor", ",", "elenod"}], "]"}]}], ";"}], "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"noddisall", "=", 
      RowBox[{"Flatten", "[", "noddisall", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"noddisall", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"noddisall", ",", "nnn"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"RSTDFRPlot", "[", 
         RowBox[{"wwall", ",", "noddisall", ",", 
          RowBox[{"RDFRNode", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "RDFRNode", "]"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.65731933210211*^9, 3.657319387488096*^9}, {
   3.657319489210096*^9, 3.657319492104096*^9}, {3.6573203279230957`*^9, 
   3.6573203365740957`*^9}, {3.657320648543096*^9, 3.657320659525096*^9}, {
   3.6573207950740957`*^9, 3.657320797722096*^9}, {3.6573208770000963`*^9, 
   3.657320878078096*^9}, {3.657321112470096*^9, 3.6573211166140957`*^9}, {
   3.6573211469778037`*^9, 3.6573211472888346`*^9}, {3.6573211850216074`*^9, 
   3.6573211852886343`*^9}, {3.657321809154094*^9, 3.657321812409094*^9}, {
   3.657323080319094*^9, 3.657323083459094*^9}, {3.6573258407169085`*^9, 
   3.6573258600709085`*^9}, 3.6573259195449085`*^9, {3.6573260484569087`*^9, 
   3.6573260529189086`*^9}, {3.6573351666638985`*^9, 
   3.6573352050508986`*^9}, {3.657335248608898*^9, 3.6573352697758985`*^9}, {
   3.6573368562658987`*^9, 3.6573368565938983`*^9}, 3.657337425004898*^9, {
   3.657507061589901*^9, 3.657507063100052*^9}, 3.6575071009948406`*^9, 
   3.65750724399814*^9, 3.6575073131730566`*^9, 3.6575074161833563`*^9, {
   3.6575077103207674`*^9, 3.657507710718807*^9}, 3.6575100980878725`*^9, 
   3.657512864993622*^9, 3.6575776621955175`*^9, 3.6575791773405175`*^9, {
   3.6575833231398697`*^9, 3.65758332775387*^9}, {3.657839151664615*^9, 
   3.657839229283615*^9}, {3.6578395417676153`*^9, 3.6578395435626154`*^9}, 
   3.657839579592615*^9, {3.657924634286134*^9, 3.657924638221134*^9}, {
   3.657926660261134*^9, 3.657926684570134*^9}, {3.6579296966203303`*^9, 
   3.6579297154783306`*^9}, {3.658026293568638*^9, 3.6580263021171637`*^9}, {
   3.6580336291050563`*^9, 3.6580336353136578`*^9}, 3.6580337040450544`*^9, {
   3.65810387303827*^9, 3.65810388603227*^9}, {3.6581068517762685`*^9, 
   3.6581068520262685`*^9}, {3.658106983373928*^9, 3.658107008784009*^9}, {
   3.658107180165279*^9, 3.6581072150872617`*^9}, {3.6581097110662613`*^9, 
   3.6581098052182617`*^9}, {3.6581101199612617`*^9, 3.658110129183262*^9}, {
   3.6581102095882616`*^9, 3.6581102142512617`*^9}, {3.6581104563752613`*^9, 
   3.6581104710282617`*^9}, {3.658111817591258*^9, 3.658111825000258*^9}, {
   3.6581844413636*^9, 3.658184461577642*^9}, {3.658184662804879*^9, 
   3.6581846721387453`*^9}, {3.6581853130201235`*^9, 
   3.6581853172465467`*^9}, {3.6581855529044714`*^9, 
   3.6581855531894426`*^9}, {3.658188024052294*^9, 3.658188024215294*^9}, {
   3.6581894775692906`*^9, 3.6581894820704193`*^9}, {3.658189535909803*^9, 
   3.6581895373919506`*^9}, {3.6585273666890087`*^9, 
   3.6585273703340087`*^9}, {3.6586147823109236`*^9, 
   3.6586147944391365`*^9}, {3.65861560404874*^9, 3.658615604235721*^9}, {
   3.6599156255089355`*^9, 3.6599156279264083`*^9}, {3.6599159511145983`*^9, 
   3.6599159610507793`*^9}, {3.6599167465825195`*^9, 3.6599167653195634`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"STDFRPlot", "[", 
   RowBox[{"wwall_", ",", "noddisall_", ",", "nodnum_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ndd", ",", "nddm", ",", "nddp", ",", "nodl", ",", "ndph", ",", "i"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ndd", "=", 
      RowBox[{"noddisall", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "nodnum"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nddm", "=", 
      RowBox[{"Riffle", "[", 
       RowBox[{"wwall", ",", 
        RowBox[{"Abs", "[", "ndd", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ndph", "=", 
      RowBox[{"Arg", "[", "ndd", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "ndph", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ndph", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "<", "0"}], ",", 
         RowBox[{
          RowBox[{"ndph", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+=", 
          RowBox[{"2", "*", "Pi"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nddp", "=", 
      RowBox[{"Riffle", "[", 
       RowBox[{"wwall", ",", 
        RowBox[{"ndph", "*", 
         RowBox[{"360", "/", 
          RowBox[{"(", 
           RowBox[{"2", "*", "Pi"}], ")"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nddm", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"nddm", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nddp", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"nddp", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"GraphicsGrid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"nddp", ",", 
            RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", "Phase"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"nddm", ",", 
            RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", "Magnitude"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "}"}]}], "}"}], 
       ",", 
       RowBox[{"Alignment", "\[Rule]", "Right"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6575747118381715`*^9, 3.6575747147717037`*^9}, {
  3.657574768664744*^9, 3.657574770028062*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RSTDFRPlot", "[", 
   RowBox[{"wwall_", ",", "noddisall_", ",", "nodnum_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "nddy", ",", "nddz", ",", "nddmy", ",", "nddmz", ",", "nddpy", ",", 
      "nddpz", ",", "nodl", ",", "ndphy", ",", "ndphz", ",", "i", ",", "rsmy",
       ",", "rsmz", ",", "rsmyp", ",", "rsmzp", ",", "ampy", ",", "ampz", ",",
       "sy", ",", "symax", ",", "symin", ",", "sz", ",", "szmax", ",", 
      "szmin", ",", "dist", ",", "rsmypn", ",", "rsmzpn"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nddy", "=", 
      RowBox[{"noddisall", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"nodnum", "*", "6"}], "-", "4"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nddz", "=", 
      RowBox[{"noddisall", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"nodnum", "*", "6"}], "-", "3"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nddmy", "=", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"wwall", "*", "60"}], ",", 
        RowBox[{"Abs", "[", "nddy", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ndphy", "=", 
      RowBox[{"Arg", "[", "nddy", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nddmz", "=", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"wwall", "*", "60"}], ",", 
        RowBox[{"Abs", "[", "nddz", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ndphz", "=", 
      RowBox[{"Arg", "[", "nddz", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "ndphy", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ndphy", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "<", "0"}], ",", 
         RowBox[{
          RowBox[{"ndphy", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+=", 
          RowBox[{"2", "*", "Pi"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "ndphz", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ndphz", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "<", "0"}], ",", 
         RowBox[{
          RowBox[{"ndphz", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+=", 
          RowBox[{"2", "*", "Pi"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nddpy", "=", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"wwall", "*", "60"}], ",", 
        RowBox[{"ndphy", "*", 
         RowBox[{"360", "/", 
          RowBox[{"(", 
           RowBox[{"2", "*", "Pi"}], ")"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nddmy", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"nddmy", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nddpy", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"nddpy", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nddpz", "=", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"wwall", "*", "60"}], ",", 
        RowBox[{"ndphz", "*", 
         RowBox[{"360", "/", 
          RowBox[{"(", 
           RowBox[{"2", "*", "Pi"}], ")"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nddmz", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"nddmz", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nddpz", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"nddpz", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rsmy", "=", 
      RowBox[{"TimeSeriesResample", "[", 
       RowBox[{"TimeSeries", "[", "nddmy", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rsmyp", "=", 
      RowBox[{"FindPeaks", "[", "rsmy", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rsmz", "=", 
      RowBox[{"TimeSeriesResample", "[", 
       RowBox[{"TimeSeries", "[", "nddmz", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rsmzp", "=", 
      RowBox[{"FindPeaks", "[", "rsmz", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ampy", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ampz", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dist", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u_", ",", "v_"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_"}], "}"}]}], "]"}], " ", ":=", " ", 
      RowBox[{"Abs", "[", 
       RowBox[{"v", "-", "y"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rsmypn", "=", 
      RowBox[{"Normal", "[", "rsmyp", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rsmzpn", "=", 
      RowBox[{"Normal", "[", "rsmzp", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sy", "=", 
         RowBox[{"Nearest", "[", 
          RowBox[{
           RowBox[{"Normal", "[", "rsmy", "]"}], ",", " ", 
           RowBox[{"rsmypn", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Infinity", ",", 
             RowBox[{"0.707", "*", 
              RowBox[{"rsmypn", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"DistanceFunction", "\[Rule]", "dist"}]}], "]"}]}], ";", 
        RowBox[{"symax", "=", 
         RowBox[{"MaximalBy", "[", 
          RowBox[{"sy", ",", "First"}], "]"}]}], ";", 
        RowBox[{"symin", "=", 
         RowBox[{"MinimalBy", "[", 
          RowBox[{"sy", ",", "First"}], "]"}]}], ";", 
        RowBox[{"ampy", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"ampy", ",", 
           RowBox[{"Quiet", "[", 
            RowBox[{
             RowBox[{"rsmypn", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"symax", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
               RowBox[{"symin", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ")"}]}], "]"}]}], 
          "]"}]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "rsmypn", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sz", "=", 
         RowBox[{"Nearest", "[", 
          RowBox[{
           RowBox[{"Normal", "[", "rsmz", "]"}], ",", " ", 
           RowBox[{"rsmzpn", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Infinity", ",", 
             RowBox[{"0.707", "*", 
              RowBox[{"rsmzpn", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"DistanceFunction", "\[Rule]", "dist"}]}], "]"}]}], ";", 
        RowBox[{"szmax", "=", 
         RowBox[{"MaximalBy", "[", 
          RowBox[{"sz", ",", "First"}], "]"}]}], ";", 
        RowBox[{"szmin", "=", 
         RowBox[{"MinimalBy", "[", 
          RowBox[{"sz", ",", "First"}], "]"}]}], ";", 
        RowBox[{"ampz", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"ampz", ",", 
           RowBox[{"Quiet", "[", 
            RowBox[{
             RowBox[{"rsmzpn", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"szmax", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
               RowBox[{"szmin", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ")"}]}], "]"}]}], 
          "]"}]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "rsmzpn", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ampy", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"N", "[", "ampy", "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ampz", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"N", "[", "ampz", "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\"\<Node Number is:\>\"", ",", "nodnum"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ListLinePlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"nddpy", ",", "nddpz"}], "}"}], ",", 
             RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", "\"\<Phase\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}], ",", 
                "Below"}], "]"}]}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Blue", ",", "Dashed"}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ros", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Dashed", ",", "Thick", ",", "Blue"}], "]"}]}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ros", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Dashed", ",", "Thick", ",", "Blue"}], "]"}]}], 
                   "}"}]}], "}"}], ",", 
                RowBox[{"{", "}"}]}], "}"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<Speed(cpm)\>\"", ",", "\"\<Phase Angle\>\""}], 
               "}"}]}]}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"nddmy", ",", "nddmz", ",", "rsmyp", ",", "rsmzp"}], 
              "}"}], ",", 
             RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", "\"\<Magnitude\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}], ",", 
                "Below"}], "]"}]}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Blue", ",", "Dashed"}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
             RowBox[{"GridLines", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ros", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"Dashed", ",", "Thick", ",", "Blue"}], "]"}]}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ros", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"Dashed", ",", "Thick", ",", "Blue"}], "]"}]}], 
                  "}"}]}], "}"}], "}"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"True", ",", "True", ",", "False", ",", "False"}], 
               "}"}]}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<Speed(cpm)\>\"", ",", "\"\<Displacement\>\""}], 
               "}"}]}]}], "]"}], "}"}]}], "}"}], ",", 
        RowBox[{"Alignment", "\[Rule]", "Axis"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Y Maximize\>\"", ",", "\"\<Z Maximize\>\""}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Grid", "[", 
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "rsmyp", "]"}], ",", "ampy", ",", 
                 "2"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<cpm\>\"", ",", "\"\<Max\>\"", ",", "\"\<Amp.F\>\""}], 
                "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"Grid", "[", 
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "rsmzp", "]"}], ",", "ampz", ",", 
                 "2"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<cpm\>\"", ",", "\"\<Max\>\"", ",", "\"\<Amp.F\>\""}], 
                "}"}]}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<cpm\>\"", ",", "\"\<Y Disp.\>\"", ",", "\"\<Z Disp.\>\""}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ros", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"rsmy", "[", 
             RowBox[{"ros", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"rsmz", "[", 
             RowBox[{"ros", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ros", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"rsmy", "[", 
             RowBox[{"ros", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
            RowBox[{"rsmz", "[", 
             RowBox[{"ros", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6575058182136602`*^9, 3.65750586038666*^9}, {
   3.6575058992076597`*^9, 3.65750592586766*^9}, {3.6575059963726597`*^9, 
   3.65750608343966*^9}, {3.65750611497466*^9, 3.65750618285966*^9}, {
   3.65750636515266*^9, 3.65750647558566*^9}, {3.6575065062811003`*^9, 
   3.657506552436329*^9}, {3.6575067620412416`*^9, 3.657506820426787*^9}, 
   3.6575068801207557`*^9, {3.657506919249668*^9, 3.657506928027546*^9}, {
   3.6575071455262938`*^9, 3.6575072246022005`*^9}, {3.657507275922332*^9, 
   3.6575072763323727`*^9}, 3.6575073991836567`*^9, {3.6575074936140985`*^9, 
   3.6575075175384912`*^9}, {3.6575088687978725`*^9, 
   3.6575088944258723`*^9}, {3.6575089253568726`*^9, 
   3.6575089586068726`*^9}, {3.6575093415648727`*^9, 
   3.6575093464988728`*^9}, {3.6575094071568727`*^9, 
   3.6575094130898724`*^9}, {3.6575094490818725`*^9, 
   3.6575094663458724`*^9}, {3.6575094970158725`*^9, 
   3.6575095036438723`*^9}, {3.6575095783758726`*^9, 
   3.6575095837458725`*^9}, {3.6575096240568724`*^9, 
   3.6575096769208727`*^9}, {3.6575100298318725`*^9, 3.657510069598872*^9}, {
   3.6575102702878723`*^9, 3.6575102726748724`*^9}, {3.6575108169778724`*^9, 
   3.6575108426218724`*^9}, {3.6575108939558725`*^9, 3.657510930888872*^9}, {
   3.6575109803918724`*^9, 3.6575109828078723`*^9}, {3.6575110552818727`*^9, 
   3.657511082178872*^9}, {3.6575114338538723`*^9, 3.6575114420698724`*^9}, {
   3.6575115273648725`*^9, 3.6575115439298725`*^9}, 3.6575116080028725`*^9, {
   3.657511724119872*^9, 3.6575117979568725`*^9}, {3.6575118632418723`*^9, 
   3.6575118649038725`*^9}, 3.6575119029278727`*^9, {3.657511987671872*^9, 
   3.6575119916808724`*^9}, {3.6575121674308724`*^9, 
   3.6575122279388723`*^9}, {3.6575124063828726`*^9, 
   3.6575124368308725`*^9}, {3.6575125588148727`*^9, 
   3.6575125782508726`*^9}, {3.657512637793904*^9, 3.6575126386699915`*^9}, {
   3.657512718004924*^9, 3.657512723572481*^9}, {3.657512951598281*^9, 
   3.6575129557867002`*^9}, {3.6575130093170524`*^9, 
   3.6575130253986607`*^9}, {3.657574609386423*^9, 3.657574637903157*^9}, {
   3.657574778076036*^9, 3.6575747810915275`*^9}, {3.657575520425475*^9, 
   3.657575521918624*^9}, {3.6575769418345175`*^9, 3.6575770784075174`*^9}, {
   3.6575771565235176`*^9, 3.6575771620155177`*^9}, {3.6575771968835173`*^9, 
   3.6575772355985174`*^9}, {3.6575781950295177`*^9, 
   3.6575782003145175`*^9}, {3.657578303979518*^9, 3.657578307571518*^9}, {
   3.6575784698535175`*^9, 3.657578513408518*^9}, {3.657578595019518*^9, 
   3.6575787531715174`*^9}, {3.6575787919145174`*^9, 
   3.6575787925495176`*^9}, {3.6575788253185177`*^9, 3.657578940078518*^9}, 
   3.6575791542275176`*^9, {3.65758345213487*^9, 3.65758347500187*^9}, {
   3.65758355597687*^9, 3.65758360233187*^9}, {3.65758364949487*^9, 
   3.65758371363387*^9}, {3.657583909853775*^9, 3.6575839222545347`*^9}, {
   3.6575992792278547`*^9, 3.657599383395855*^9}, {3.657599444518855*^9, 
   3.657599448683855*^9}, {3.657599964791855*^9, 3.657599966172855*^9}, {
   3.6576019518847556`*^9, 3.657601960798647*^9}, 3.6578349433276052`*^9, {
   3.657835132464864*^9, 3.6578352885108023`*^9}, {3.657835355904199*^9, 
   3.657835453814432*^9}, {3.6578355389204073`*^9, 3.657835601457897*^9}, {
   3.657835701108963*^9, 3.657835757795386*^9}, {3.657836637938386*^9, 
   3.657836645893386*^9}, {3.6578366846723857`*^9, 3.657836776518386*^9}, {
   3.657836815440386*^9, 3.657836830594386*^9}, 3.657836915387386*^9, {
   3.657837037453386*^9, 3.657837038696386*^9}, 3.657837105740386*^9, {
   3.657837141452386*^9, 3.6578372339856167`*^9}, {3.657837264716617*^9, 
   3.657837265783617*^9}, {3.6578374457286167`*^9, 3.657837449502617*^9}, {
   3.657837481080617*^9, 3.657837484874617*^9}, 3.657837628933617*^9, {
   3.657838054892617*^9, 3.6578380780296173`*^9}, {3.657838153851617*^9, 
   3.657838156910617*^9}, {3.6578382340626173`*^9, 3.657838246814617*^9}, {
   3.657838511348142*^9, 3.657838535201527*^9}, {3.6578385771757245`*^9, 
   3.657838621965203*^9}, 3.6578386665456605`*^9, {3.6578388210376153`*^9, 
   3.6578388586266155`*^9}, {3.657838914091615*^9, 3.657838919297615*^9}, {
   3.657838977179615*^9, 3.657839004216615*^9}, {3.6578393794726152`*^9, 
   3.657839423881615*^9}, {3.657839458716615*^9, 3.657839469122615*^9}, {
   3.657839619059615*^9, 3.657839631862615*^9}, {3.6578398600941267`*^9, 
   3.657839883557473*^9}, 3.6579370985938225`*^9, {3.658118900292253*^9, 
   3.658118902141253*^9}, {3.658119025814253*^9, 3.658119062504253*^9}, {
   3.658119218475253*^9, 3.6581193468631363`*^9}, {3.6581194259498553`*^9, 
   3.6581194281405125`*^9}, {3.658119574053257*^9, 3.6581195782576776`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.6573195497970963`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nodcoor", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"200", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"300", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elenod", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{"{", 
    RowBox[{"628.3", ",", "628.3", ",", "628.3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eledes", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}], ",", 
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}], ",", 
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elemi", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7854", ",", "7854"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7854", ",", "7854"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7854", ",", "7854"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elemat", "=", 
   RowBox[{"{", 
    RowBox[{"210000", ",", "210000", ",", "210000"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodtag", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodspp", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"300", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"300", ",", "0", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "100"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "10"}], "}"}]}], "}"}], ",", "4"}], "}"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conmall", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"3", ",", 
      RowBox[{"{", 
       RowBox[{
       "100", ",", "100", ",", "100", ",", "100", ",", "100", ",", "100", ",",
         "100"}], "}"}]}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodval", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodum", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.2", ",", 
       RowBox[{"Pi", "/", "6"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ww", "=", 
   RowBox[{"{", 
    RowBox[{"10", ",", "12", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ros", "=", 
   RowBox[{"{", 
    RowBox[{"650", ",", "670"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RDFRNode", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ksbeam", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RotorDFR", "[", 
   RowBox[{
   "nodcoor", ",", "elenod", ",", "elemat", ",", "aa", ",", "nodtag", ",", 
    "nodval", ",", "nodspp", ",", "elemi", ",", "ww", ",", "conmall", ",", 
    "eledes", ",", "nodum", ",", "RDFRNode", ",", "ksbeam"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.657319675722096*^9, 3.657319707596096*^9}, {
   3.657319938135096*^9, 3.657319940818096*^9}, {3.657321124791585*^9, 
   3.6573211541755233`*^9}, {3.657321212039309*^9, 3.65732124035314*^9}, {
   3.6573213540315065`*^9, 3.657321460359094*^9}, {3.657321515575094*^9, 
   3.6573215259130945`*^9}, {3.657321599138094*^9, 3.657321605266094*^9}, {
   3.657321638261094*^9, 3.6573216476180944`*^9}, 3.657321733612094*^9, {
   3.6573230911580944`*^9, 3.657323184811117*^9}, 3.6573234066566515`*^9, {
   3.6573234410909786`*^9, 3.6573234725775332`*^9}, 3.6573258704929085`*^9, {
   3.6573260567689085`*^9, 3.6573260614009085`*^9}, 3.657335366181898*^9, {
   3.65750348676202*^9, 3.6575034876571093`*^9}, {3.657503521017445*^9, 
   3.657503521338477*^9}, 3.657507546640401*^9, 3.657507653591095*^9, {
   3.657511820867872*^9, 3.6575118318258724`*^9}, {3.6575122975518723`*^9, 
   3.6575122999498725`*^9}, {3.657577353349518*^9, 3.6575773596905174`*^9}, {
   3.6575774657865176`*^9, 3.6575775008445177`*^9}, {3.6575775500235176`*^9, 
   3.657577571915518*^9}, {3.657577675205518*^9, 3.6575777686995173`*^9}, {
   3.6575778158395176`*^9, 3.657577841592518*^9}, {3.657578256783518*^9, 
   3.657578256955518*^9}, 3.6575789953795176`*^9, {3.657839251891615*^9, 
   3.6578392776196156`*^9}, {3.6580283558185644`*^9, 3.658028378328643*^9}, {
   3.6581068811592684`*^9, 3.6581068812722683`*^9}, {3.658109002667393*^9, 
   3.6581090041362467`*^9}, {3.6581194495129223`*^9, 3.658119455110601*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6575160473198657`*^9, 3.657516096415866*^9}, {
   3.657574479849847*^9, 3.6575744842017455`*^9}, 3.6575805417635174`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RotorDFR2", "[", 
   RowBox[{
   "nodcoor_", ",", "elenod_", ",", "elemat_", ",", "Aa_", ",", "nodtag_", 
    ",", "nodval_", ",", "nodsp_", ",", "elemi_", ",", "ww_", ",", "nodconm_",
     ",", "eledes_", ",", "nodum_", ",", "ksbeam_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "K", ",", "Kmod", ",", "f", ",", "fmod", ",", "u", ",", "noddis", ",", 
      "nodfor", ",", "elefor", ",", "elesig", ",", "He", ",", "nodcoorc", ",",
       "noddisc", ",", "comb", ",", "Title", ",", "mm", ",", "nnn", ",", "kk",
       ",", "k", ",", "bbb", ",", "bb", ",", "sft", ",", "comb1", ",", 
      "comb2", ",", "wwn", ",", "noddisall", ",", "Kmodl", ",", "wwc", ",", 
      "wwall", ",", "i", ",", "j", ",", "t", ",", "fmodrd", ",", "rgm", ",", 
      "nodsp1", ",", "ss", ",", "sss", ",", "ssf", ",", "faa", ",", "fy", ",",
       "fz", ",", "coo", ",", "kcv", ",", "kcgr"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"K", "=", 
      RowBox[{"SpaceTrassMasterStiffness", "[", 
       RowBox[{
       "nodcoor", ",", " ", "elenod", ",", " ", "Aa", ",", " ", "elemat", ",",
         " ", "elemi", ",", "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"noddisall", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"wwall", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Rotor 3D Displacement Plot\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "15"}], ",", 
            RowBox[{"FontWeight", "\[Rule]", "Bold"}]}], "]"}], "}"}], "}"}], 
        ",", 
        RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wwc", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ww", "/", "60"}], ")"}], "*", "2", "*", "Pi"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mm", "=", 
      RowBox[{"SpaceTrassMasterMass", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "eledes", ",", "elemi", ",", 
        "elemat", ",", "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mm", "=", 
      RowBox[{"ApplyConMasstoMasterM", "[", 
       RowBox[{"nodconm", ",", "mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nnn", "=", 
      RowBox[{"6", "*", 
       RowBox[{"Length", "[", "nodcoor", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rgm", "=", 
      RowBox[{"RotorGyroscopic", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "eledes", ",", "elemi"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rgm", "=", 
      RowBox[{"ApplyConMasstoRGM", "[", 
       RowBox[{"nodconm", ",", "rgm"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mm", "=", 
      RowBox[{"mm", "-", 
       RowBox[{"I", "*", "rgm"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mm", "=", 
      RowBox[{"ApplyDofToMaster", "[", 
       RowBox[{"nodtag", ",", "mm"}], "]"}]}], ";", 
     RowBox[{"f", "=", 
      RowBox[{"FlatNodePartVector", "[", "nodval", "]"}]}], ";", 
     RowBox[{"fmod", "=", 
      RowBox[{"ApplyLoad", "[", 
       RowBox[{"nodtag", ",", "nodval", ",", "K", ",", "f"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", 
        RowBox[{"Length", "[", "wwc", "]"}]}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"wwn", "=", 
         RowBox[{"wwc", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nodsp1", "=", "nodsp"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Kmod", "=", "K"}], ";", "\[IndentingNewLine]", 
        RowBox[{"bb", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", "nnn", ",", "nnn"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VectorQ", "[", "nodsp1", "]"}], ",", "Null", ",", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "\[LessEqual]", 
             RowBox[{"Length", "[", "nodsp1", "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", 
            RowBox[{
             RowBox[{"Quiet", "[", 
              RowBox[{
               RowBox[{"nodsp1", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{"nodsp1", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                "[", 
                RowBox[{"wwn", "*", 
                 RowBox[{"60", "/", 
                  RowBox[{"(", 
                   RowBox[{"2", "*", "Pi"}], ")"}]}]}], "]"}]}], "]"}], ";", 
             RowBox[{"Quiet", "[", 
              RowBox[{
               RowBox[{"nodsp1", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "4"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{"nodsp1", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "4"}], "]"}], "]"}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                "[", 
                RowBox[{"wwn", "*", 
                 RowBox[{"60", "/", 
                  RowBox[{"(", 
                   RowBox[{"2", "*", "Pi"}], ")"}]}]}], "]"}]}], "]"}]}]}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VectorQ", "[", "nodsp1", "]"}], ",", "Null", ",", 
          RowBox[{"bb", "=", 
           RowBox[{"ApplySpringToMasterB", "[", 
            RowBox[{"nodsp1", ",", "bb"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VectorQ", "[", "nodsp1", "]"}], ",", "Null", ",", 
          RowBox[{"Kmod", "=", 
           RowBox[{"ApplySpringToMaster", "[", 
            RowBox[{"nodsp1", ",", "K"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"kcv", ",", "kcgr"}], "}"}], "=", 
         RowBox[{"krotor", "[", 
          RowBox[{"bb", ",", "Kmod"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bb", "=", 
         RowBox[{"bb", "-", 
          RowBox[{"kcv", "*", "I"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Kmod", "=", 
         RowBox[{"ApplyDofToMaster", "[", 
          RowBox[{"nodtag", ",", "Kmod"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Kmodl", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"wwn", "^", "2"}]}], ")"}], "*", "mm"}], "+", 
          RowBox[{"wwn", "*", "bb", "*", "I"}], "+", "Kmod"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fmodrd", "=", "fmod"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "nodum", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"nodum", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[NotEqual]", "0"}], 
            ",", 
            RowBox[{
             RowBox[{
              RowBox[{"fmodrd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"6", "*", "i"}], "-", "4"}], "]"}], "]"}], "+=", 
              RowBox[{
               RowBox[{"-", "1"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "1"}], "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
                  RowBox[{"wwn", "^", "2"}], "*", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}]}], "-", 
                 RowBox[{"I", "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
                  RowBox[{"wwn", "^", "2"}], "*", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}]}]}], 
                ")"}]}]}], ";", 
             RowBox[{
              RowBox[{"fmodrd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"6", "*", "i"}], "-", "3"}], "]"}], "]"}], "+=", 
              RowBox[{
               RowBox[{"-", "1"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "1"}], "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
                  RowBox[{"wwn", "^", "2"}], "*", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}]}], "+", 
                 RowBox[{"I", "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
                  RowBox[{"nodum", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
                  RowBox[{"wwn", "^", "2"}], "*", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"nodum", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}]}]}], 
                ")"}]}]}]}], ",", "Null"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u", "=", 
         RowBox[{"Quiet", "[", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{"Kmodl", ",", "fmodrd"}], "]"}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"u", "=", 
           RowBox[{"Chop", "[", "u", "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"He", "=", "0.5"}], ";", "\[IndentingNewLine]", 
        RowBox[{"f", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"K", ".", "u"}], ",", 
           FractionBox["1", 
            SuperscriptBox["10.", "8"]]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nodfor", "=", 
         RowBox[{"NodePartFlatVector", "[", 
          RowBox[{"6", ",", "f"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"noddis", "=", 
         RowBox[{"NodePartFlatVector", "[", 
          RowBox[{"6", ",", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"noddisall", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"noddisall", ",", "noddis"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"wwall", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"wwall", ",", 
           RowBox[{"wwn", "/", 
            RowBox[{"(", 
             RowBox[{"2", "*", "Pi"}], ")"}]}]}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"elefor", "=", 
        RowBox[{"Chop", "[", 
         RowBox[{"SpaceTrussIntForces", "[", 
          RowBox[{
          "nodcoor", ",", "elenod", ",", "elemat", ",", "Aa", ",", "noddis", 
           ",", "He"}], "]"}], "]"}]}], ";", 
       RowBox[{"elesig", "=", 
        RowBox[{"SpaceTrussStresses", "[", 
         RowBox[{"Aa", ",", "elefor", ",", "elenod"}], "]"}]}], ";"}], "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"noddisall", "=", 
      RowBox[{"Flatten", "[", "noddisall", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"noddisall", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"noddisall", ",", "nnn"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sss", "=", 
         RowBox[{"noddisall", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ss", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{"sss", ",", "6"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ssf", "=", 
         RowBox[{"ss", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"faa", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"fy", "=", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"ssf", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"t", "+", 
               RowBox[{"Arg", "[", 
                RowBox[{"ssf", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"fz", "=", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"ssf", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"t", "+", 
               RowBox[{"Arg", "[", 
                RowBox[{"ssf", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}]}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"faa", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"faa", ",", 
              RowBox[{"{", 
               RowBox[{"fy", ",", "fz"}], "}"}]}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "ssf", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coo", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"nodcoor", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"faa", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"coo", ",", "faa", ",", "2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"npp", "=", 
         RowBox[{"faa", "/.", 
          RowBox[{"t", "\[Rule]", 
           RowBox[{"0.0001", "Pi"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Speed:\>\"", ",", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"wwall", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "*", "60"}], "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"ParametricPlot3D", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"faa", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", "nodcoor", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], 
                RowBox[{"t", "/", 
                 RowBox[{"(", 
                  RowBox[{"2", "Pi"}], ")"}]}]}], ",", 
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{"npp", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "]"}], 
                "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Last", "[", "nodcoor", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], 
                 RowBox[{"t", "/", 
                  RowBox[{"(", 
                   RowBox[{"2", "Pi"}], ")"}]}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{"npp", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}], 
                "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Last", "[", "nodcoor", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], 
                 RowBox[{"t", "/", 
                  RowBox[{"(", 
                   RowBox[{"2", "Pi"}], ")"}]}]}], "]"}]}], "}"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", 
             RowBox[{"2", "Pi"}]}], "}"}], ",", 
           RowBox[{"BoxRatios", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"3", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
             "}"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Dashed", ",", 
              RowBox[{"Thickness", "[", "0.003", "]"}]}], "]"}]}], ",", 
           RowBox[{"Mesh", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"0.0001", "Pi"}], ",", 
                 RowBox[{"PointSize", "[", "Medium", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.2", "Pi"}], "}"}]}], "}"}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", "wwall", "]"}]}], "}"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.65731933210211*^9, 3.657319387488096*^9}, {
   3.657319489210096*^9, 3.657319492104096*^9}, {3.6573203279230957`*^9, 
   3.6573203365740957`*^9}, {3.657320648543096*^9, 3.657320659525096*^9}, {
   3.6573207950740957`*^9, 3.657320797722096*^9}, {3.6573208770000963`*^9, 
   3.657320878078096*^9}, {3.657321112470096*^9, 3.6573211166140957`*^9}, {
   3.6573211469778037`*^9, 3.6573211472888346`*^9}, {3.6573211850216074`*^9, 
   3.6573211852886343`*^9}, {3.657321809154094*^9, 3.657321812409094*^9}, {
   3.657323080319094*^9, 3.657323083459094*^9}, {3.6573258407169085`*^9, 
   3.6573258600709085`*^9}, 3.6573259195449085`*^9, {3.6573260484569087`*^9, 
   3.6573260529189086`*^9}, {3.6573351666638985`*^9, 
   3.6573352050508986`*^9}, {3.657335248608898*^9, 3.6573352697758985`*^9}, {
   3.6573368562658987`*^9, 3.6573368565938983`*^9}, 3.657337425004898*^9, {
   3.657507061589901*^9, 3.657507063100052*^9}, 3.6575071009948406`*^9, 
   3.65750724399814*^9, 3.6575073131730566`*^9, 3.6575074161833563`*^9, {
   3.6575077103207674`*^9, 3.657507710718807*^9}, 3.6575100980878725`*^9, 
   3.657512864993622*^9, 3.6575776621955175`*^9, 3.6575791773405175`*^9, 
   3.657579762085518*^9, {3.6575800384905176`*^9, 3.6575801049235177`*^9}, {
   3.6575802195695176`*^9, 3.657580220736518*^9}, {3.6575802812145176`*^9, 
   3.6575802815775175`*^9}, {3.657580402408518*^9, 3.6575804500815177`*^9}, {
   3.6575806848490458`*^9, 3.6575807496720076`*^9}, {3.657580847113492*^9, 
   3.6575808723455377`*^9}, {3.657580922287524*^9, 3.657580943717809*^9}, {
   3.6575809991087*^9, 3.657581001846974*^9}, {3.657581148550643*^9, 
   3.657581151814969*^9}, {3.657581216171404*^9, 3.657581231393926*^9}, {
   3.6575817633313713`*^9, 3.6575818248640623`*^9}, {3.657581857304573*^9, 
   3.6575818676405053`*^9}, {3.657582098005872*^9, 3.6575820992048717`*^9}, {
   3.6575821644158716`*^9, 3.6575821695688715`*^9}, {3.6575822717258716`*^9, 
   3.6575822727778716`*^9}, {3.657582306970872*^9, 3.657582308286872*^9}, {
   3.6575824309688716`*^9, 3.6575824634298716`*^9}, {3.6575825623578715`*^9, 
   3.6575825919178715`*^9}, {3.6575826248368716`*^9, 3.657582636208872*^9}, {
   3.657582666621872*^9, 3.6575826835868716`*^9}, 3.6575827519745483`*^9, {
   3.65758327181887*^9, 3.6575832769668703`*^9}, {3.65784831634239*^9, 
   3.65784832074283*^9}, {3.6578486314611998`*^9, 3.6578486348512*^9}, {
   3.6578487027392*^9, 3.6578487313162003`*^9}, {3.657926241552134*^9, 
   3.657926245515134*^9}, {3.6579297906003304`*^9, 3.6579298166813307`*^9}, {
   3.6580263165311017`*^9, 3.6580263256880083`*^9}, {3.658095095261282*^9, 
   3.658095193553282*^9}, {3.6580953575012817`*^9, 3.6580953998822823`*^9}, {
   3.6580968978444834`*^9, 3.6580969036359043`*^9}, 3.658096940692198*^9, {
   3.6580972189532785`*^9, 3.6580972240662785`*^9}, {3.6580972586642785`*^9, 
   3.6580972628952785`*^9}, 3.6580973029952784`*^9, {3.6580974054682784`*^9, 
   3.6580974279562783`*^9}, 3.6580997309462733`*^9, {3.6585273799310083`*^9, 
   3.6585273847700086`*^9}, {3.6586209984764204`*^9, 3.65862106525542*^9}, {
   3.65862116709542*^9, 3.6586212033114204`*^9}, {3.658621345848873*^9, 
   3.658621397107999*^9}, {3.6599151536431913`*^9, 3.6599151561235437`*^9}, {
   3.6599163991947327`*^9, 3.6599164091626854`*^9}, 3.6599167733225174`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpaceLinearTransient", "[", 
   RowBox[{
   "nodcoor_", ",", "elenod_", ",", "elemat_", ",", "Aa_", ",", "nodtag_", 
    ",", "nodsp_", ",", "elemi_", ",", "nodconm_", ",", "eledes_", ",", 
    "ksbeam_", ",", "dt_", ",", "in_", ",", "pta_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "u", ",", "u0", ",", "v0", ",", "nnn", ",", "mm", ",", "kk", ",", "dd", 
      ",", "bb", ",", "p", ",", "a0", ",", "A1", ",", "A2", ",", "A3", ",", 
      "A4", ",", "un1", ",", "pp", ",", "pt", ",", "ii", ",", "ia", ",", 
      "tt"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nnn", "=", 
      RowBox[{"6", "*", 
       RowBox[{"Length", "[", "nodcoor", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"kk", "=", 
      RowBox[{"SpaceTrassMasterStiffness", "[", 
       RowBox[{
       "nodcoor", ",", " ", "elenod", ",", " ", "Aa", ",", " ", "elemat", ",",
         " ", "elemi", ",", "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mm", "=", 
      RowBox[{"SpaceTrassMasterMass", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "eledes", ",", "elemi", ",", 
        "elemat", ",", "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mm", "=", 
      RowBox[{"ApplyConMasstoMasterM", "[", 
       RowBox[{"nodconm", ",", "mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mm", "=", 
      RowBox[{"ApplyDofToMaster", "[", 
       RowBox[{"nodtag", ",", "mm"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bb", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", "nnn", ",", "nnn"}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"VectorQ", "[", "nodsp", "]"}], ",", "Null", ",", 
       RowBox[{"bb", "=", 
        RowBox[{"ApplySpringToMasterB", "[", 
         RowBox[{"nodsp", ",", "bb"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"VectorQ", "[", "nodsp", "]"}], ",", "Null", ",", 
       RowBox[{"kk", "=", 
        RowBox[{"ApplySpringToMaster", "[", 
         RowBox[{"nodsp", ",", "kk"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kk", "=", 
      RowBox[{"ApplyDofToMaster", "[", 
       RowBox[{"nodtag", ",", "kk"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"u0", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", "nnn"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v0", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", "nnn"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pt", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"pta", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatrixQ", "[", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Quiet", "[", 
          RowBox[{
           RowBox[{"pt", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"Interpolation", "[", 
             RowBox[{
              RowBox[{"pt", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
            RowBox[{"ia", "*", "dt"}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "pt", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pp", "[", "ii_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{
         RowBox[{"ia", "=", "ii"}], ";", "pt", ";", 
         RowBox[{"Return", "[", "pt", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"a0", "=", 
      RowBox[{
       RowBox[{"Inverse", "[", "mm", "]"}], ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pp", "[", "0", "]"}], "-", 
         RowBox[{"kk", ".", "u0"}], "-", 
         RowBox[{"bb", ".", "v0"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"un1", "=", 
      RowBox[{"u0", "-", 
       RowBox[{"dt", "*", "v0"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dt", "^", "2"}], "/", "2"}], ")"}], "*", "a0"}]}]}], ";", 
     RowBox[{"A1", "=", 
      RowBox[{
       RowBox[{"mm", "/", 
        RowBox[{"dt", "^", "2"}]}], "+", 
       RowBox[{"bb", "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", "dt"}], ")"}]}], "+", 
       RowBox[{"kk", "/", "3"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A2", "[", "ii_", "]"}], "=", 
      RowBox[{
       RowBox[{"1", "/", "3"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pp", "[", 
          RowBox[{"ii", "+", "1"}], "]"}], "+", 
         RowBox[{"pp", "[", "ii", "]"}], "+", 
         RowBox[{"pp", "[", 
          RowBox[{"ii", "-", "1"}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A3", "=", 
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{"mm", "/", 
         RowBox[{"dt", "^", "2"}]}]}], "-", 
       RowBox[{"kk", "/", "3"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A4", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "mm"}], "/", 
        RowBox[{"dt", "^", "2"}]}], "+", 
       RowBox[{"bb", "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", "dt"}], ")"}]}], "-", 
       RowBox[{"kk", "/", "3"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"Quiet", "[", 
       RowBox[{"Append", "[", 
        RowBox[{"u", ",", 
         RowBox[{"LinearSolve", "[", 
          RowBox[{"A1", ",", 
           RowBox[{
            RowBox[{"A2", "[", "0", "]"}], "+", 
            RowBox[{"A3", ".", "u0"}], "+", 
            RowBox[{"A4", ".", "un1"}]}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"u", ",", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{"A1", ",", 
          RowBox[{
           RowBox[{"A2", "[", "1", "]"}], "+", 
           RowBox[{"A3", ".", 
            RowBox[{"u", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "+", 
           RowBox[{"A4", ".", "u0"}]}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"u", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"u", ",", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{"A1", ",", 
            RowBox[{
             RowBox[{"A2", "[", "i", "]"}], "+", 
             RowBox[{"A3", ".", 
              RowBox[{"u", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "+", 
             RowBox[{"A4", ".", 
              RowBox[{"u", "[", 
               RowBox[{"[", 
                RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}]}], "]"}]}], "]"}]}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"in", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tt", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dt", "*", 
          RowBox[{"(", 
           RowBox[{"nn", "-", "1"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nn", ",", 
          RowBox[{"in", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"Prepend", "[", 
       RowBox[{"u", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", "nnn"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"tt", ",", "u", ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"N", "[", "u", "]"}], "//", "MatrixForm"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6591331662996044`*^9, 3.6591331930232763`*^9}, 
   3.6591333006130342`*^9, {3.65913368591805*^9, 3.6591336893930497`*^9}, {
   3.6591337406330495`*^9, 3.6591337628320494`*^9}, {3.65913389741105*^9, 
   3.65913393635705*^9}, {3.65913401657605*^9, 3.6591340188800497`*^9}, {
   3.6591341888070498`*^9, 3.6591341933170495`*^9}, {3.6591342494420495`*^9, 
   3.6591342812850494`*^9}, {3.6591343695200496`*^9, 3.65913438281205*^9}, {
   3.6591344229850492`*^9, 3.6591344569450493`*^9}, {3.6591345494280496`*^9, 
   3.6591345548080497`*^9}, 3.6591345857510495`*^9, {3.6591347150540495`*^9, 
   3.65913471520805*^9}, {3.65913477745605*^9, 3.6591347775930495`*^9}, {
   3.6591348533300495`*^9, 3.6591349460600495`*^9}, {3.6591349779020495`*^9, 
   3.6591350009860497`*^9}, 3.6591351391120496`*^9, {3.6591352653470497`*^9, 
   3.6591352707090497`*^9}, {3.65913543647705*^9, 3.6591354403890495`*^9}, {
   3.65913555449605*^9, 3.65913555791805*^9}, {3.659135592953496*^9, 
   3.659135595647765*^9}, {3.659135682271427*^9, 3.6591356897161713`*^9}, {
   3.659135759292128*^9, 3.659135760025201*^9}, {3.6591358048996887`*^9, 
   3.6591358102152195`*^9}, {3.6591358685780478`*^9, 3.659135885439048*^9}, {
   3.6591359857950478`*^9, 3.659135986307048*^9}, {3.659136025357048*^9, 
   3.659136054267048*^9}, {3.659136127885048*^9, 3.659136164620048*^9}, 
   3.659136244708048*^9, {3.6591366659079647`*^9, 3.6591366964160147`*^9}, {
   3.659136762751648*^9, 3.6591367666690397`*^9}, {3.6591368261069827`*^9, 
   3.659136978523223*^9}, {3.659137022339604*^9, 3.659137058010171*^9}, {
   3.6591370982321925`*^9, 3.659137102656635*^9}, {3.659137135525922*^9, 
   3.6591371447078395`*^9}, {3.659137197570125*^9, 3.6591372424740443`*^9}, {
   3.6591372860440445`*^9, 3.6591372874000444`*^9}, 3.6591373370910444`*^9, {
   3.6591373784920444`*^9, 3.6591373977470446`*^9}, {3.6591375854390445`*^9, 
   3.6591375885870447`*^9}, {3.659137697680044*^9, 3.6591377635060444`*^9}, {
   3.6591378561240444`*^9, 3.659137893550044*^9}, {3.659139393062044*^9, 
   3.6591394575320444`*^9}, {3.6591395963510447`*^9, 3.65913968117537*^9}, {
   3.659139716687471*^9, 3.659139740947322*^9}, {3.6591397855042315`*^9, 
   3.6591397856322575`*^9}, {3.6591398283838053`*^9, 3.659139857841696*^9}, {
   3.659147065876853*^9, 3.659147072461853*^9}, {3.6591471127488527`*^9, 
   3.659147154581853*^9}, {3.6591477352242527`*^9, 3.6591478591661353`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Test", " ", "Data"}], "-", 
    RowBox[{"All", " ", "Pass"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nodcoor", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"200", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"300", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"elenod", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aa", "=", 
     RowBox[{"{", 
      RowBox[{"628.3", ",", "628.3", ",", "628.3"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eledes", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"7.85", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "9"}]}]}], ",", 
       RowBox[{"7.85", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "9"}]}]}], ",", 
       RowBox[{"7.85", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "9"}]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"elemi", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"7854", ",", "7854"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7854", ",", "7854"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7854", ",", "7854"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"elemat", "=", 
     RowBox[{"{", 
      RowBox[{"210000", ",", "210000", ",", "210000"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nodtag", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nodspp", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"300", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"300", ",", "0", ",", "10"}], "}"}], ",", "100", ",", "10", 
        ",", "4"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nodconm", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}]}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pta", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "100"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"100", ",", "10000"}], "}"}]}], "}"}], ",", "0", ",", "0",
          ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ksbeam", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dt", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"in", "=", "20"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nua", "=", 
     RowBox[{"{", 
      RowBox[{"0.3", ",", "0.3", ",", "0.3"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"SpaceLinearTransient", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "elemat", ",", "aa", ",", "nodtag", ",",
         "nodspp", ",", "elemi", ",", "nodconm", ",", "eledes", ",", "ksbeam",
         ",", "dt", ",", "in", ",", "pta"}], "]"}], "--"}], "Pass"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.659133243444318*^9, 3.6591334381810493`*^9}, {
   3.6591334718150496`*^9, 3.6591334719460497`*^9}, {3.65913354182605*^9, 
   3.65913354385205*^9}, {3.6591336308530493`*^9, 3.65913364148905*^9}, 
   3.65913390979805*^9, 3.6591343600130496`*^9, {3.6591379429050446`*^9, 
   3.6591379478270445`*^9}, {3.6591380055300446`*^9, 
   3.6591380538960447`*^9}, {3.6591462220266085`*^9, 3.659146225513957*^9}, {
   3.659146968701853*^9, 3.659146973961853*^9}, {3.6599074298026276`*^9, 
   3.6599074568080587`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.657319675722096*^9, 3.657319707596096*^9}, {
   3.657319938135096*^9, 3.657319940818096*^9}, {3.657321124791585*^9, 
   3.6573211541755233`*^9}, {3.657321212039309*^9, 3.65732124035314*^9}, {
   3.6573213540315065`*^9, 3.657321460359094*^9}, {3.657321515575094*^9, 
   3.6573215259130945`*^9}, {3.657321599138094*^9, 3.657321605266094*^9}, {
   3.657321638261094*^9, 3.6573216476180944`*^9}, 3.657321733612094*^9, {
   3.6573230911580944`*^9, 3.657323184811117*^9}, 3.6573234066566515`*^9, {
   3.6573234410909786`*^9, 3.6573234725775332`*^9}, 3.6573258704929085`*^9, {
   3.6573260567689085`*^9, 3.6573260614009085`*^9}, 3.657335366181898*^9, {
   3.65750348676202*^9, 3.6575034876571093`*^9}, {3.657503521017445*^9, 
   3.657503521338477*^9}, 3.657507546640401*^9, 3.657507653591095*^9, {
   3.657511820867872*^9, 3.6575118318258724`*^9}, {3.6575122975518723`*^9, 
   3.6575122999498725`*^9}, {3.657577353349518*^9, 3.6575773596905174`*^9}, {
   3.6575774657865176`*^9, 3.6575775008445177`*^9}, {3.6575775500235176`*^9, 
   3.657577571915518*^9}, {3.657577675205518*^9, 3.6575777686995173`*^9}, {
   3.6575778158395176`*^9, 3.657577841592518*^9}, {3.657578256783518*^9, 
   3.657578256955518*^9}, 3.6575789953795176`*^9, {3.657580318486518*^9, 
   3.6575803295015173`*^9}, {3.6575803807845173`*^9, 3.657580382139518*^9}, {
   3.658095046429282*^9, 3.658095079296282*^9}, 3.65871812985192*^9, {
   3.6599073674792533`*^9, 3.659907378342933*^9}, 3.6599074266323905`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nodcoor", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"50", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"100", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"150", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"200", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"300", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"350", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"350", ",", "0", ",", "100"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"380", ",", "120", ",", "180"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Aa", "=", 
   RowBox[{"{", 
    RowBox[{
    "5026", ",", "5026", ",", "20110", ",", "20110", ",", "5026", ",", "5026",
      ",", "5026", ",", "5026"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elenod", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "9"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eledes", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}], ",", 
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}], ",", 
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}], ",", 
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}], ",", 
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}], ",", 
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}], ",", 
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}], ",", 
     RowBox[{"7.85", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elemat", "=", 
   RowBox[{"{", 
    RowBox[{
    "210000", ",", "210000", ",", "210000", ",", "210000", ",", "210000", ",",
      "210000", ",", "210000", ",", "210000"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elemi", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2000000", ",", "2000000"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2000000", ",", "2000000"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"33000000", ",", "33000000"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"33000000", ",", "33000000"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2000000", ",", "2000000"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2000000", ",", "2000000"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2000000", ",", "2000000"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2000000", ",", "2000000"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodconm", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodtag", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kkp", "=", 
   RowBox[{"{", 
    RowBox[{"10000", ",", "200000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{"{", 
    RowBox[{"85000", ",", "120000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ebeam", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bsp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "5"}], ",", 
       RowBox[{"-", "5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", 
       RowBox[{"-", "5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RDFRNode", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodum", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.01", ",", "0.2", ",", 
       RowBox[{"Pi", "/", "6"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ww", "=", 
   RowBox[{"{", 
    RowBox[{"100", ",", "350", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ww2", "=", 
   RowBox[{"{", 
    RowBox[{"100", ",", "8400"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ros", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"200", "*", "60"}], ",", 
     RowBox[{"220", "*", "60"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodval", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1000", ",", 
       RowBox[{"-", "1000"}], ",", "2000", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ksbeam", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodsp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "10"}], "}"}], ",", "10000", ",", "0", 
       ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "10", ",", "0"}], "}"}], ",", "10000", ",", "0", 
       ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"350", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"350", ",", "10", ",", "0"}], "}"}], ",", "10000", ",", "0", 
       ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"350", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"350", ",", "0", ",", "10"}], "}"}], ",", "10000", ",", "0", 
       ",", "7"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodsp1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "0", ",", "10"}], "}"}], ",", "10000", ",", "100", 
       ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10", ",", "0"}], "}"}], ",", "10000", ",", "100", 
       ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"300", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"300", ",", "0", ",", "10"}], "}"}], ",", "10000", ",", "100",
        ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"300", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"300", ",", "10", ",", "0"}], "}"}], ",", "10000", ",", "100",
        ",", "6"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodsppd", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "0", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "10000"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "10000"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "100"}], "}"}]}], "}"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "10", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "10000"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "10000"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "100"}], "}"}]}], "}"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"300", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"300", ",", "0", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "10000"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "10000"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "100"}], "}"}]}], "}"}], ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"300", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"300", ",", "10", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "10000"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "10000"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "100"}], "}"}]}], "}"}], ",", "6"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nua", "=", 
    RowBox[{"{", 
     RowBox[{
     "0.3", ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", ",", "0.3", ",", 
      "0.3", ",", "0.3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"SpaceTrussSolution", "[", 
      RowBox[{
      "nodcoor", ",", "elenod", ",", "elemat", ",", "Aa", ",", "nodtag", ",", 
       "nodval", ",", "nodsp", ",", "elemi", ",", "ebeam", ",", "bsp", ",", 
       "ksbeam"}], "]"}], "--"}], "Pass"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"SpaceTrussMode", "[", 
      RowBox[{
      "nodcoor", ",", "Aa", ",", "elenod", ",", "eledes", ",", "elemat", ",", 
       "elemi", ",", "nodtag", ",", "nodsp", ",", "nodconm", ",", "ksbeam"}], 
      "]"}], "--"}], "Pass"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"RotorMode", "[", 
     RowBox[{
     "nodcoor", ",", "Aa", ",", "elenod", ",", "eledes", ",", "elemat", ",", 
      "elemi", ",", "nodtag", ",", "nodsppd", ",", "nodconm", ",", "ops", ",",
       "kkp", ",", "ksbeam"}], "]"}], ";", 
    RowBox[{"--", "Pass"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"SpaceTrussDFR", "[", 
      RowBox[{
      "nodcoor", ",", "elenod", ",", "elemat", ",", "Aa", ",", "nodtag", ",", 
       "nodval", ",", "nodsppd", ",", "elemi", ",", "ww", ",", "nodconm", ",",
        "eledes", ",", "ksbeam"}], "]"}], "--"}], "Pass"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"RotorDFR", "[", 
     RowBox[{
     "nodcoor", ",", "elenod", ",", "elemat", ",", "Aa", ",", "nodtag", ",", 
      "nodval", ",", "nodsppd", ",", "elemi", ",", "ww", ",", "nodconm", ",", 
      "eledes", ",", "nodum", ",", "RDFRNode", ",", "ksbeam"}], "]"}], ";", 
    RowBox[{"--", "Pass"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"RotorDFR2", "[", 
     RowBox[{
     "nodcoor", ",", "elenod", ",", "elemat", ",", "Aa", ",", "nodtag", ",", 
      "nodval", ",", "nodsppd", ",", "elemi", ",", "ww2", ",", "nodconm", ",",
       "eledes", ",", "nodum", ",", "ksbeam"}], "]"}], ";", 
    RowBox[{"--", "Pass"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"RotorModeC", "[", 
     RowBox[{
     "nodcoor", ",", "Aa", ",", "elenod", ",", "eledes", ",", "elemat", ",", 
      "elemi", ",", "nodtag", ",", "nodsp1", ",", "nodconm", ",", "ksbeam"}], 
     "]"}], ";", 
    RowBox[{"--", "Pass"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"SpaceTrussModeC", "[", 
      RowBox[{
      "nodcoor", ",", "Aa", ",", "elenod", ",", "eledes", ",", "elemat", ",", 
       "elemi", ",", "nodtag", ",", "nodsp1", ",", "nodconm", ",", "ksbeam"}],
       "]"}], "--"}], "Pass"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.658013403646412*^9, 3.6580134185756116`*^9}, {
   3.658026350616009*^9, 3.658026386042474*^9}, {3.658027798056239*^9, 
   3.6580278340286865`*^9}, {3.65802788631821*^9, 3.6580279066911573`*^9}, 
   3.65802800083414*^9, {3.658028100874936*^9, 3.658028271377471*^9}, {
   3.6580286649070573`*^9, 3.658028672379218*^9}, {3.658028954891173*^9, 
   3.65802896091258*^9}, {3.658029001252887*^9, 3.6580290027660384`*^9}, {
   3.658029109856606*^9, 3.658029112664516*^9}, {3.6580292049667573`*^9, 
   3.658029232687069*^9}, {3.6580292780972137`*^9, 3.6580292808739243`*^9}, {
   3.658029338826067*^9, 3.6580293454246554`*^9}, 3.6580294460258307`*^9, {
   3.6580295093130026`*^9, 3.6580295106233606`*^9}, {3.658029897620159*^9, 
   3.658029911597311*^9}, {3.658033487445997*^9, 3.658033487757987*^9}, {
   3.658033558080533*^9, 3.6580335814953823`*^9}, {3.6580959236516075`*^9, 
   3.658095972171459*^9}, {3.6580960767819195`*^9, 3.6580961027745185`*^9}, {
   3.658096269033142*^9, 3.658096313330572*^9}, {3.658096477757013*^9, 
   3.658096478057043*^9}, {3.6580999887362733`*^9, 3.6581000260772734`*^9}, {
   3.6581001097162733`*^9, 3.658100112713273*^9}, {3.6581001619442735`*^9, 
   3.6581001810132732`*^9}, {3.6581002272612734`*^9, 
   3.6581002310922737`*^9}, {3.6581002658742733`*^9, 
   3.6581002866652737`*^9}, {3.6581019921030455`*^9, 
   3.6581019934571805`*^9}, {3.65810904729193*^9, 3.658109054666193*^9}, {
   3.658110714612262*^9, 3.658110728789262*^9}, {3.658111839446258*^9, 
   3.658111878606258*^9}, {3.6581119134032583`*^9, 3.658111918387258*^9}, {
   3.6581121740542583`*^9, 3.658112175640258*^9}, {3.658112889670258*^9, 
   3.658112896971258*^9}, {3.658112927580258*^9, 3.658112936864258*^9}, {
   3.658112967424258*^9, 3.658112967546258*^9}, {3.658113039674258*^9, 
   3.658113048657258*^9}, {3.658113170433258*^9, 3.6581131973842583`*^9}, {
   3.658113227821258*^9, 3.658113284915258*^9}, {3.658113345123258*^9, 
   3.658113356704258*^9}, {3.658114958184258*^9, 3.658115017863258*^9}, {
   3.658115739530253*^9, 3.658115744432253*^9}, {3.6581196453793893`*^9, 
   3.6581196635792093`*^9}, {3.658120558182243*^9, 3.658120561407243*^9}, {
   3.6581207178522425`*^9, 3.658120807611243*^9}, {3.658181641181345*^9, 
   3.658181655636345*^9}, {3.6581817218053455`*^9, 3.658181731119345*^9}, {
   3.658181789027345*^9, 3.658181791290345*^9}, {3.658181852482345*^9, 
   3.658181855870345*^9}, {3.6581820906353455`*^9, 3.6581821129333453`*^9}, {
   3.6581822173853455`*^9, 3.6581822661573453`*^9}, {3.6581824528923454`*^9, 
   3.6581824602863455`*^9}, {3.658182736291345*^9, 3.6581827402013454`*^9}, {
   3.658186468667294*^9, 3.658186515395294*^9}, {3.6581865604262943`*^9, 
   3.658186563721294*^9}, {3.6581866306692944`*^9, 3.6581867410182943`*^9}, {
   3.658186790429294*^9, 3.658186809879294*^9}, {3.658187881444294*^9, 
   3.658187899392294*^9}, {3.6581879479882936`*^9, 3.658187985636294*^9}, {
   3.6581884419412937`*^9, 3.6581884452892942`*^9}, {3.658188620973284*^9, 
   3.658188634273614*^9}, {3.6581891843472905`*^9, 3.6581891922542906`*^9}, 
   3.6584555287384086`*^9, {3.6584576344284067`*^9, 3.658457646424407*^9}, {
   3.658458596802407*^9, 3.658458642919407*^9}, {3.6584586799684067`*^9, 
   3.6584586899484067`*^9}, {3.658458760920407*^9, 3.658458779122407*^9}, {
   3.658460379598407*^9, 3.6584604057674065`*^9}, {3.658460461273407*^9, 
   3.658460489149407*^9}, {3.658460595940407*^9, 3.6584606030764065`*^9}, {
   3.6584607083316774`*^9, 3.6584607244699044`*^9}, {3.6584609924759502`*^9, 
   3.658461054330135*^9}, {3.6584610958402853`*^9, 3.6584611347861795`*^9}, {
   3.6584614341861167`*^9, 3.658461436932391*^9}, {3.6584616232984*^9, 
   3.6584616284354*^9}, {3.6584620414884*^9, 3.6584620497834*^9}, {
   3.658531975392245*^9, 3.6585320494542446`*^9}, {3.6585320955816374`*^9, 
   3.6585321984209204`*^9}, {3.658532654483655*^9, 3.6585326709070125`*^9}, 
   3.658532874909792*^9, {3.6585333988517923`*^9, 3.6585334344187922`*^9}, {
   3.6585336040407925`*^9, 3.6585336102697926`*^9}, {3.658534847887792*^9, 
   3.6585348510897923`*^9}, {3.6585357186423182`*^9, 3.658535726782132*^9}, {
   3.6585389831888714`*^9, 3.658539002180871*^9}, {3.658539570355871*^9, 
   3.658539577704871*^9}, {3.658540203503871*^9, 3.658540215062871*^9}, {
   3.6586116791178217`*^9, 3.6586116956451693`*^9}, {3.6586119034256396`*^9, 
   3.6586119289236393`*^9}, {3.6586121406636395`*^9, 
   3.6586121410376396`*^9}, {3.6586122779496393`*^9, 
   3.6586123010156393`*^9}, {3.65861242527864*^9, 3.6586124659256396`*^9}, {
   3.6586126779446397`*^9, 3.6586127215696397`*^9}, {3.6586128172936397`*^9, 
   3.6586128188716393`*^9}, {3.6586133810118074`*^9, 3.658613384277134*^9}, {
   3.658613471628868*^9, 3.6586135283835435`*^9}, {3.6586145295336485`*^9, 
   3.658614539368632*^9}, {3.6586146859022837`*^9, 3.658614720380731*^9}, {
   3.658615228347207*^9, 3.6586152364025955`*^9}, {3.6586154780333424`*^9, 
   3.6586154878523607`*^9}, {3.658615569572188*^9, 3.6586155785842867`*^9}, {
   3.658615621874957*^9, 3.6586156264385004`*^9}, {3.658615870016425*^9, 
   3.658615871135425*^9}, {3.658616011706425*^9, 3.6586160370124254`*^9}, {
   3.658616069107425*^9, 3.6586160879284253`*^9}, {3.6586165913594255`*^9, 
   3.658616605412425*^9}, {3.658618024768425*^9, 3.658618031331425*^9}, {
   3.658618133447425*^9, 3.658618137298425*^9}, {3.65861821177711*^9, 
   3.6586182191648483`*^9}, {3.658618266770609*^9, 3.6586183130382347`*^9}, {
   3.65861962953442*^9, 3.6586196331274204`*^9}, {3.65861969780942*^9, 
   3.6586197463134203`*^9}, {3.65861981019642*^9, 3.6586198263044205`*^9}, {
   3.6586199538394203`*^9, 3.65861995440642*^9}, {3.6586212178864202`*^9, 
   3.6586212182854204`*^9}, 3.6586213815624447`*^9, {3.6586214204503326`*^9, 
   3.658621421415429*^9}, {3.6586270276614113`*^9, 3.6586270279014115`*^9}, {
   3.6586270628284116`*^9, 3.6586270637254114`*^9}, {3.658701659531071*^9, 
   3.658701679129071*^9}, {3.658714477452861*^9, 3.658714478014468*^9}, {
   3.6587147643144474`*^9, 3.6587147647512474`*^9}, {3.658715194945265*^9, 
   3.658715195382059*^9}, {3.658715317076099*^9, 3.6587153699126215`*^9}, {
   3.658715622793193*^9, 3.658715623401585*^9}, {3.6587157217259274`*^9, 
   3.6587157240502977`*^9}, {3.6587157643913803`*^9, 3.658715772144481*^9}, {
   3.658715815870721*^9, 3.6587158263381863`*^9}, 3.6587158630445156`*^9, {
   3.6587158979256687`*^9, 3.658715898222065*^9}, {3.6587164317730207`*^9, 
   3.658716455278905*^9}, {3.6587165420253873`*^9, 3.658716546018757*^9}, {
   3.6587169283248014`*^9, 3.6587169292763653`*^9}, {3.6587859571799765`*^9, 
   3.6587859836749763`*^9}, {3.6587860277919765`*^9, 3.658786046834976*^9}, {
   3.658787715015973*^9, 3.658787732920973*^9}, {3.6587990975249543`*^9, 
   3.658799164930954*^9}, {3.6588016689629545`*^9, 3.658801671486954*^9}, {
   3.6588108024620085`*^9, 3.658810812102809*^9}, {3.659044730669041*^9, 
   3.659044742994343*^9}, 3.659044783334237*^9, {3.659045109193819*^9, 
   3.6590453198566785`*^9}, {3.659674282556713*^9, 3.659674287188102*^9}, 
   3.659675040546271*^9, {3.659907361933584*^9, 3.6599073630139613`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Nonlinear", " ", "Start"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6599224470345488`*^9, 3.6599224592488794`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpaceNLStiffness", "[", 
   RowBox[{
   "nodcoor_", ",", "elenod_", ",", "Aa_", ",", "elemat_", ",", "elemi_", ",",
     "nodsp_", ",", "nodtag_", ",", "ksbeam_", ",", "u_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Km", ",", "Kg", ",", "Ka", ",", "numnod", ",", "numele", ",", "noddis", 
      ",", "e", ",", "ni", ",", "nj", ",", "ncoor", ",", "ue", ",", "Em", ",",
       "A", ",", "Iyy", ",", "Izz", ",", "ksy", ",", "ksz", ",", "x21", ",", 
      "y21", ",", "z21", ",", "LL", ",", "x1", ",", "y1", ",", "z1", ",", 
      "x2", ",", "y2", ",", "z2"}], "}"}], ",", 
    RowBox[{
     RowBox[{"numnod", "=", 
      RowBox[{"Length", "[", "nodcoor", "]"}]}], ";", 
     RowBox[{"numele", "=", 
      RowBox[{"Length", "[", "elenod", "]"}]}], ";", 
     RowBox[{"noddis", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{"u", ",", "6"}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}], "}"}], "=", 
      "nodcoor"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x21", ",", "y21", ",", "z21"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x2", "-", "x1"}], ",", 
        RowBox[{"y2", "-", "y1"}], ",", 
        RowBox[{"z2", "-", "z1"}]}], "}"}]}], ";", 
     RowBox[{"LL", "=", 
      RowBox[{
       SuperscriptBox["x21", "2"], "+", 
       SuperscriptBox["y21", "2"], "+", 
       SuperscriptBox["z21", "2"]}]}], ";", 
     RowBox[{"pafa", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"e", "=", "1"}], ",", 
       RowBox[{"e", "\[LessEqual]", "numele"}], ",", 
       RowBox[{"e", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ni", ",", "nj"}], "}"}], "=", 
         RowBox[{"elenod", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ncoor", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"nodcoor", "[", 
            RowBox[{"[", "ni", "]"}], "]"}], ",", 
           RowBox[{"nodcoor", "[", 
            RowBox[{"[", "nj", "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ue", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"noddis", "[", 
             RowBox[{"[", "ni", "]"}], "]"}], ",", 
            RowBox[{"noddis", "[", 
             RowBox[{"[", "nj", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Em", "=", 
         RowBox[{"elemat", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", 
        RowBox[{"A", "=", 
         RowBox[{"Aa", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Iyy", ",", "Izz"}], "}"}], "=", 
         RowBox[{"elemi", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ksy", ",", "ksz"}], "}"}], "=", 
         RowBox[{"ksbeam", "[", 
          RowBox[{"[", "e", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"paf", "=", 
         RowBox[{
          FractionBox["1", "LL"], "Em", "*", "A", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x21", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "ue", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
               "-", 
               RowBox[{
               "ue", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
               ")"}]}], "+", 
            RowBox[{"y21", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "ue", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}], 
               "-", 
               RowBox[{
               "ue", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
               ")"}]}], "+", 
            RowBox[{"z21", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "ue", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], 
               "-", 
               RowBox[{
               "ue", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
               ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pafa", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"pafa", ",", "paf"}], "]"}]}]}]}], "]"}], ";", 
     RowBox[{"Km", "=", 
      RowBox[{"SpaceTrassMasterStiffness", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "elemat", ",", "elemi", ",", 
        "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Kg", "=", 
      RowBox[{"SpaceTrassMasterDiffStiffness", "[", 
       RowBox[{
       "nodcoor", ",", "elenod", ",", "Aa", ",", "elemat", ",", "elemi", ",", 
        "ksbeam"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"VectorQ", "[", "nodsp", "]"}], ",", "Null", ",", 
       RowBox[{"Km", "=", 
        RowBox[{"ApplySpringToMaster", "[", 
         RowBox[{"nodsp", ",", "Km"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Km", "=", 
      RowBox[{"ApplyDofToMaster", "[", 
       RowBox[{"nodtag", ",", "Km"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Kg", "=", 
      RowBox[{"ApplyDofToMaster", "[", 
       RowBox[{"nodtag", ",", "Kg"}], "]"}]}], ";", 
     RowBox[{"Ka", "=", 
      RowBox[{"Km", "+", "Kg"}]}], ";", 
     RowBox[{"Return", "[", "Ka", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.659922481150437*^9, 3.6599225417541056`*^9}, {
   3.6599225806591034`*^9, 3.659922582718237*^9}, {3.6599226334634104`*^9, 
   3.659922651699226*^9}, {3.659922731943054*^9, 3.6599228388776264`*^9}, 
   3.6599228835233955`*^9, {3.659922959539759*^9, 3.659922964001216*^9}, {
   3.659927085024189*^9, 3.659927177826209*^9}, {3.6599273583447804`*^9, 
   3.659927360201133*^9}, {3.6599274178260555`*^9, 3.659927423582308*^9}, {
   3.6599938019272656`*^9, 3.659993822240104*^9}, 3.659994269539072*^9, {
   3.659994336091072*^9, 3.659994353362072*^9}, {3.6599946874445705`*^9, 
   3.659994687875528*^9}, {3.659997184380458*^9, 3.659997188885909*^9}, {
   3.6600081054054184`*^9, 3.660008107551774*^9}, 3.660008151632546*^9, {
   3.6600085047095175`*^9, 3.660008505739414*^9}, 3.6600085386849737`*^9, {
   3.660010717562974*^9, 3.6600107179999743`*^9}, 3.660010757929974*^9, {
   3.6600114657829742`*^9, 3.660011466186974*^9}, 3.660011496866974*^9, {
   3.660011829635974*^9, 3.660011855082974*^9}, {3.6600132838866787`*^9, 
   3.6600132847997704`*^9}, {3.660013338929182*^9, 3.6600133817234616`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNRMethod", "[", 
   RowBox[{
   "nodcoori_", ",", "elenod_", ",", "Aa_", ",", "elemat_", ",", "elemi_", 
    ",", "nodsp_", ",", "nodtag_", ",", "nodval_", ",", "ksbeam_", ",", 
    "step_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "kk", ",", "qq", ",", "vv", ",", "du", ",", "u", ",", "l", ",", "kkn", 
      ",", "qqn", ",", "uk", ",", "rk", ",", "duk", ",", "kkk", ",", 
      "nodcoor", ",", "dl", ",", "ppa", ",", "nodcoork"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ppa", "=", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"u", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"6", "*", 
         RowBox[{"Length", "[", "nodcoori", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dl", "=", 
      RowBox[{"1", "/", "step"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"kkn", "=", 
      RowBox[{"SpaceNLStiffness", "[", 
       RowBox[{
       "nodcoori", ",", "elenod", ",", "Aa", ",", "elemat", ",", "elemi", ",",
         "nodsp", ",", "nodtag", ",", "ksbeam", ",", "u"}], "]"}]}], ";", 
     RowBox[{"qq", "=", 
      RowBox[{"FlatNodePartVector", "[", "nodval", "]"}]}], ";", 
     RowBox[{"qqn", "=", 
      RowBox[{"ApplyLoad", "[", 
       RowBox[{"nodtag", ",", "nodval", ",", "kkn", ",", "qq"}], "]"}]}], ";", 
     RowBox[{"nodcoor", "=", "nodcoori"}], ";", 
     RowBox[{"l", "=", "0"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"kkn", "=", 
         RowBox[{"SpaceNLStiffness", "[", 
          RowBox[{
          "nodcoor", ",", "elenod", ",", "Aa", ",", "elemat", ",", "elemi", 
           ",", "nodsp", ",", "nodtag", ",", "ksbeam", ",", "u"}], "]"}]}], 
        ";", 
        RowBox[{"vv", "=", 
         RowBox[{
          RowBox[{"Inverse", "[", "kkn", "]"}], ".", "qqn"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"du", "=", 
         RowBox[{"duk", "=", 
          RowBox[{"vv", "*", "dl"}]}]}], ";", 
        RowBox[{"Print", "[", "du", "]"}], ";", 
        RowBox[{"u", "=", 
         RowBox[{"uk", "=", 
          RowBox[{"u", "+", "du"}]}]}], ";", 
        RowBox[{"Print", "[", "u", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nodcoor", "=", 
         RowBox[{"nodcoork", "=", 
          RowBox[{"nodcoori", "+", 
           RowBox[{
            RowBox[{"Partition", "[", 
             RowBox[{"u", ",", "6"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}]}]}]}],
         ";", 
        RowBox[{"Print", "[", "nodcoor", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"l", "=", 
         RowBox[{"l", "+", "dl"}]}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"kkk", "=", 
            RowBox[{"SpaceNLStiffness", "[", 
             RowBox[{
             "nodcoork", ",", "elenod", ",", "Aa", ",", "elemat", ",", 
              "elemi", ",", "nodsp", ",", "nodtag", ",", "ksbeam", ",", 
              "uk"}], "]"}]}], ";", 
           RowBox[{"rk", "=", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kkk", ".", "uk"}], "-", 
              RowBox[{"l", "*", "qqn"}]}], ")"}]}], ";", 
           RowBox[{"Print", "[", "\"\<reee\>\"", "]"}], ";", 
           RowBox[{"Print", "[", "rk", "]"}], ";", 
           RowBox[{"duk", "=", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"Inverse", "[", "kkk", "]"}], ".", "rk"}]}]}], ";", 
           RowBox[{"Print", "[", "duk", "]"}], ";", 
           RowBox[{"uk", "=", 
            RowBox[{"uk", "+", "duk"}]}], ";", 
           RowBox[{"nodcoork", "=", 
            RowBox[{"nodcoori", "+", 
             RowBox[{
              RowBox[{"Partition", "[", 
               RowBox[{"uk", ",", "6"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], 
              "]"}]}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "10"}], "}"}]}], "]"}], ";", 
        RowBox[{"nodcoor", "=", "nodcoork"}], ";", 
        RowBox[{"u", "=", "uk"}], ";", 
        RowBox[{"Print", "[", "\"\<sss21\>\"", "]"}], ";", 
        RowBox[{"Print", "[", "u", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ppa", "=", 
         RowBox[{"ssq", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"ppa", ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "l"}], "}"}]}], "]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "step"}], "}"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.659922991768326*^9, 3.659923008709383*^9}, {
   3.6599230480981207`*^9, 3.6599230539791317`*^9}, {3.659923113132436*^9, 
   3.6599231975413303`*^9}, {3.6599232659139395`*^9, 3.659923293447057*^9}, {
   3.6599235356407585`*^9, 3.659923561183688*^9}, {3.6599236174343057`*^9, 
   3.659923646222763*^9}, {3.659923761777214*^9, 3.6599238386745434`*^9}, {
   3.6599240260737553`*^9, 3.659924032938035*^9}, 3.6599243804941225`*^9, 
   3.659924476995104*^9, {3.6599245102072906`*^9, 3.6599245206748238`*^9}, {
   3.65992455713179*^9, 3.6599245636057487`*^9}, {3.659924772860978*^9, 
   3.6599247840615625`*^9}, {3.659924821984433*^9, 3.659924831781045*^9}, {
   3.6599250555279417`*^9, 3.659925123261839*^9}, {3.659925274812925*^9, 
   3.6599252961533146`*^9}, {3.6599264867973857`*^9, 3.659926491960787*^9}, {
   3.65992720276997*^9, 3.6599272845118732`*^9}, {3.6599275862268906`*^9, 
   3.659927586585656*^9}, 3.659928473378891*^9, {3.659931381483079*^9, 
   3.659931405568861*^9}, {3.659931592108878*^9, 3.6599316086132545`*^9}, {
   3.6599317981427517`*^9, 3.659931802401306*^9}, {3.659934792716203*^9, 
   3.6599347963353105`*^9}, {3.6599348496235437`*^9, 3.659934855083404*^9}, {
   3.6599940973992357`*^9, 3.6599941153146515`*^9}, {3.659995198287074*^9, 
   3.6599952035310736`*^9}, {3.659995284125074*^9, 3.6599952888910737`*^9}, {
   3.6599961469180737`*^9, 3.659996153862074*^9}, {3.659996211909074*^9, 
   3.659996228034074*^9}, {3.659996786939369*^9, 3.6599968004860783`*^9}, {
   3.65999719839886*^9, 3.6599972149065104`*^9}, {3.6599975005460715`*^9, 
   3.659997500710088*^9}, {3.659997800019029*^9, 3.6599978038966413`*^9}, {
   3.6599978911429157`*^9, 3.659997897686261*^9}, {3.659998120409025*^9, 
   3.6599981261640253`*^9}, {3.660000385850025*^9, 3.6600003870910254`*^9}, {
   3.6600013706794386`*^9, 3.6600013952298937`*^9}, {3.660001438827253*^9, 
   3.660001446567027*^9}, 3.660008611913974*^9, 3.660010070227974*^9, {
   3.660010304239974*^9, 3.660010313392974*^9}, 3.660010364863974*^9, {
   3.660010502708974*^9, 3.660010503595974*^9}, 3.660011280936974*^9, 
   3.660012159575172*^9, {3.6600141103419585`*^9, 3.6600141217699585`*^9}, {
   3.6600142174519587`*^9, 3.6600142581489587`*^9}, 3.6600144130649586`*^9, {
   3.6600160800739584`*^9, 3.660016108869959*^9}, {3.6600162385423374`*^9, 
   3.6600162595152397`*^9}, {3.6600197732909603`*^9, 3.6600197769569607`*^9}, 
   3.6600198670939603`*^9, {3.6600204821097608`*^9, 3.660020482292779*^9}, 
   3.660020589204469*^9, {3.660252731607153*^9, 3.660252738544427*^9}, {
   3.6602552963845267`*^9, 3.660255300145527*^9}, 3.660255858958132*^9, 
   3.6602560031725516`*^9, 3.660256126338867*^9, 3.660256707473525*^9, {
   3.6602571864245253`*^9, 3.6602571868895254`*^9}, 3.660257264202525*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nodcoori", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"100", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elenod", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Aa", "=", 
   RowBox[{"{", "200", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elemat", "=", 
   RowBox[{"{", "210000", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elemi", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"10000", ",", "10000"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodsp", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "10"}], "}"}], ",", "0", ",", "0", ",", 
      "1"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodtag", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodval", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "2000", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ksbeam", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"step", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nua", "=", 
   RowBox[{"{", "0.3", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FNRMethod", "[", 
  RowBox[{
  "nodcoori", ",", "elenod", ",", "Aa", ",", "elemat", ",", "elemi", ",", 
   "nodsp", ",", "nodtag", ",", "nodval", ",", "ksbeam", ",", "step"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6599281119091682`*^9, 3.6599283700166597`*^9}, {
   3.6599284206211133`*^9, 3.6599284337871065`*^9}, {3.65992854555824*^9, 
   3.6599285513300924`*^9}, 3.6599317471804924`*^9, 3.6599939761954813`*^9, 
   3.659994107190277*^9, {3.659995869501074*^9, 3.659995870586074*^9}, {
   3.6599991936890254`*^9, 3.6599991938400254`*^9}, 3.6599992935320253`*^9, {
   3.6600002663490257`*^9, 3.6600002699460254`*^9}, 3.6600003317470255`*^9, {
   3.6600019629156227`*^9, 3.660001986640877*^9}, {3.6600143293729587`*^9, 
   3.6600143425689583`*^9}, {3.6600143977009583`*^9, 3.6600143980909586`*^9}}]
},
PrintingStyleEnvironment->"PrintoutGray",
WindowSize->{1440, 858},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{595.1999999999999, 841.98}},
Magnification:>1.6 Inherited,
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 150, 3, 47, "Input",
 InitializationCell->True],
Cell[733, 27, 9897, 135, 47, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[10645, 165, 474, 8, 251, "Input",
 InitializationCell->True],
Cell[11122, 175, 149, 3, 47, "Input"],
Cell[11274, 180, 10565, 207, 1121, "Input",
 InitializationCell->True],
Cell[21842, 389, 68, 1, 47, "Input"],
Cell[21913, 392, 29199, 677, 2600, "Input",
 InitializationCell->True],
Cell[51115, 1071, 6425, 146, 1034, "Input",
 InitializationCell->True],
Cell[57543, 1219, 41346, 999, 4543, "Input",
 InitializationCell->True],
Cell[98892, 2220, 1946, 45, 367, "Input"],
Cell[100841, 2267, 25715, 560, 2502, "Input",
 InitializationCell->True],
Cell[126559, 2829, 20388, 516, 2470, "Input",
 InitializationCell->True],
Cell[146950, 3347, 2692, 63, 309, "Input"],
Cell[149645, 3412, 55278, 1307, 4460, "Input",
 InitializationCell->True],
Cell[204926, 4721, 1956, 49, 251, "Input"],
Cell[206885, 4772, 4660, 110, 483, "Input",
 InitializationCell->True],
Cell[211548, 4884, 4207, 105, 483, "Input",
 InitializationCell->True],
Cell[215758, 4991, 5763, 134, 483, "Input",
 InitializationCell->True],
Cell[221524, 5127, 3181, 95, 338, "Input"],
Cell[224708, 5224, 3420, 90, 425, "Input"],
Cell[228131, 5316, 3291, 90, 367, "Input",
 InitializationCell->True],
Cell[231425, 5408, 1679, 45, 135, "Input"],
Cell[233107, 5455, 4652, 122, 570, "Input",
 InitializationCell->True],
Cell[237762, 5579, 3450, 74, 309, "Input",
 InitializationCell->True],
Cell[241215, 5655, 2291, 59, 309, "Input",
 InitializationCell->True],
Cell[243509, 5716, 4918, 120, 338, "Input",
 InitializationCell->True],
Cell[248430, 5838, 2607, 70, 309, "Input"],
Cell[251040, 5910, 256, 7, 47, "Input",
 InitializationCell->True],
Cell[251299, 5919, 2325, 62, 280, "Input",
 InitializationCell->True],
Cell[253627, 5983, 173, 4, 47, "Input",
 InitializationCell->True],
Cell[253803, 5989, 340, 8, 77, "Input"],
Cell[254146, 5999, 22835, 535, 2407, "Input",
 InitializationCell->True],
Cell[276984, 6536, 1940, 59, 198, "Input"],
Cell[278927, 6597, 3108, 76, 164, "Input"],
Cell[282038, 6675, 4241, 96, 454, "Input",
 InitializationCell->True],
Cell[286282, 6773, 2423, 64, 135, "Input"],
Cell[288708, 6839, 1402, 37, 135, "Input",
 InitializationCell->True],
Cell[290113, 6878, 888, 27, 106, "Input"],
Cell[291004, 6907, 11335, 231, 1401, "Input",
 InitializationCell->True],
Cell[302342, 7140, 9667, 222, 991, "Input"],
Cell[312012, 7364, 229, 5, 47, "Input",
 InitializationCell->True],
Cell[312244, 7371, 8456, 179, 860, "Input",
 InitializationCell->True],
Cell[320703, 7552, 2933, 65, 396, "Input",
 InitializationCell->True],
Cell[323639, 7619, 33527, 785, 3474, "Input",
 InitializationCell->True],
Cell[357169, 8406, 14709, 315, 628, "Input"],
Cell[371881, 8723, 4690, 110, 628, "Input",
 InitializationCell->True],
Cell[376574, 8835, 161, 3, 47, "Input"],
Cell[376738, 8840, 6536, 187, 744, "Input",
 InitializationCell->True],
Cell[383277, 9029, 109, 2, 47, "Input"],
Cell[383389, 9033, 3995, 108, 396, "Input",
 InitializationCell->True],
Cell[387387, 9143, 5681, 140, 791, "Input",
 InitializationCell->True],
Cell[393071, 9285, 3298, 83, 309, "Input",
 InitializationCell->True],
Cell[396372, 9370, 124, 2, 47, "Input"],
Cell[396499, 9374, 3886, 109, 367, "Input"],
Cell[400388, 9485, 70, 1, 47, "Input"],
Cell[400461, 9488, 3152, 82, 397, "Input",
 InitializationCell->True],
Cell[403616, 9572, 10163, 228, 1330, "Input",
 InitializationCell->True],
Cell[413782, 9802, 96, 1, 47, "Input"],
Cell[413881, 9805, 19867, 419, 2021, "Input",
 InitializationCell->True],
Cell[433751, 10226, 1960, 29, 47, "Input",
 InitializationCell->True],
Cell[435714, 10257, 7002, 180, 483, "Input"],
Cell[442719, 10439, 17951, 401, 2077, "Input",
 InitializationCell->True],
Cell[460673, 10842, 2929, 76, 396, "Input",
 InitializationCell->True],
Cell[463605, 10920, 20405, 468, 1962, "Input",
 InitializationCell->True],
Cell[484013, 11390, 70, 1, 47, "Input"],
Cell[484086, 11393, 6637, 184, 541, "Input"],
Cell[490726, 11579, 170, 2, 47, "Input"],
Cell[490899, 11583, 22284, 509, 2367, "Input",
 InitializationCell->True],
Cell[513186, 12094, 10439, 249, 976, "Input",
 InitializationCell->True],
Cell[523628, 12345, 5560, 162, 570, "Input"],
Cell[529191, 12509, 1519, 20, 47, "Input"],
Cell[530713, 12531, 23186, 575, 1585, "Input"],
Cell[553902, 13108, 156, 3, 47, "Input"],
Cell[554061, 13113, 6909, 166, 800, "Input"],
Cell[560973, 13281, 7690, 159, 1034, "Input"],
Cell[568666, 13442, 2862, 79, 396, "Input"]
}
]
*)

(* End of internal cache information *)
